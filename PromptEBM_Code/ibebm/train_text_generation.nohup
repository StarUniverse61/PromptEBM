nohup: ignoring input
Namespace(aggressive=False, anneal=True, anneal_function='logistic', anneal_k=0.0025, anneal_warm_up_step=0, anneal_warm_up_value=0.0, anneal_x0=2500, attn_type='cat', avg_type='seq', backward_size=5, batch_size=30, beam_size=10, beta=0.2, bi_enc_cell=True, ckpt_step=2000, concat_decoder_input=True, data='ptb', debug=False, dec_cell_size=512, dim_target_kl=1.0, dropout=0.3, e_l_step_size=0.5, e_l_steps=40, e_l_with_noise=True, e_prior_sig=1.0, early_stop=True, ebm_data_dir='data/ptb', ebm_draw_points=False, ebm_fig_dir='figs', ebm_hidden=200, ebm_log_dir='logs/ptb/dgmvae', embed_size=512, enc_cell_size=512, fix_batch=False, forward_only=False, gen_type='greedy', gmm=True, gpu_idx=1, grad_clip=0.5, improve_threshold=0.996, init_lr=0.001, init_w=0.08, k=5, klw_for_ckl=1.0, klw_for_zkl=1.0, latent_size=40, load_sess='', lr_decay=True, lr_decay_rate=0.8, lr_hold=3, max_dec_len=40, max_epoch=60, max_kl_weight=0.5, max_utt_len=40, max_vocab_cnt=50260, model='GMVAE', model_file='ckpts/ptb/model_ckpt.pt', momentum=0.0, mult_k=20, mutual_weight=50.0, n_cycle=10, num_cls=20, num_layer_dec=1, num_layer_enc=1, op='adam', patient_increase=2.0, post_sample_num=1, pretrain_ae_step=0, preview_batch_num=1, print_step=100, prior_grad_clip=1, ratio_increase=0.25, ratio_zero=0.5, rnn_cell='gru', save_model=True, seed=300, sel_metric='elbo', step_size=1, tie_output_embed=True, use_attn=False, use_gpu=True, use_mutual=False, utt_type='rnn', word_dropout_rate=0.0)
Max utt len 84, mean utt len 23.10
Max utt len 76, mean utt len 22.89
Max utt len 79, mean utt len 22.92
Load corpus with train size 42068, valid size 3370, test size 3761 raw vocab size 10001 vocab size 10001 at cut_off 1 OOV rate 0.000000
Done loading corpus
Max len 40 and min len 3 and avg len 22.728844
Max len 40 and min len 3 and avg len 22.572404
Max len 40 and min len 3 and avg len 22.594257
GMVAE (
  (embedding): Embedding(50260, 512, padding_idx=0), parameters=25733120
  (dec_embedding): Embedding(50260, 512, padding_idx=0), parameters=25733120
  (x_encoder): EncoderRNN(
    (input_dropout): Dropout(p=0, inplace=False)
    (rnn): GRU(512, 512, batch_first=True, dropout=0.3, bidirectional=True)
  ), parameters=3151872
  (decoder): DecoderRNN(
    (input_dropout): Dropout(p=0.3, inplace=False)
    (rnn): GRU(552, 512, batch_first=True, dropout=0.3)
    (embedding): Embedding(50260, 512, padding_idx=0)
    (output_dropout): Dropout(p=0.3, inplace=False)
  ), parameters=27370496
  (q_y_mean): Linear(in_features=1024, out_features=40, bias=True), parameters=41000
  (q_y_logvar): Linear(in_features=1024, out_features=40, bias=True), parameters=41000
  (dec_init_connector): LinearConnector(
    (linear): Linear(in_features=40, out_features=512, bias=False)
  ), parameters=20480
  (nll_loss): NLLEntropy(
    (nll_loss): NLLLoss()
  ), parameters=0
  (ebm): Sequential (
    (0): Linear(in_features=40, out_features=200, bias=True), weights=((200, 40), (200,)), parameters=8200
    (1): GELU(), weights=(), parameters=0
    (2): Linear(in_features=200, out_features=200, bias=True), weights=((200, 200), (200,)), parameters=40200
    (3): GELU(), weights=(), parameters=0
    (4): Linear(in_features=200, out_features=20, bias=True), weights=((20, 200), (20,)), parameters=4020
  ) Total Parameters=52420, parameters=52420
) Total Parameters=82143508
**** Training Begins ****
**** Epoch 0/60 ****
Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     1 rec:  118.937 mi: 0.00053191 zkl:  114.860 cd:    0.010 pos_prob:    3.000 prob_neg:    2.990 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     1 rec:  154.750 mi: 0.00074720 zkl:  132.265 cd:   -0.002 pos_prob:    2.999 prob_neg:    3.001 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     1 rec:  128.200 mi: 0.00098109 zkl:  143.936 cd:    0.009 pos_prob:    3.003 prob_neg:    2.994 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     1 rec:  113.828 mi: 0.00117421 zkl:  153.782 cd:    0.006 pos_prob:    3.000 prob_neg:    2.994 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     1 rec:  129.338 mi: 0.00123477 zkl:  167.144 cd:    0.009 pos_prob:    3.002 prob_neg:    2.993 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.696
Langevin prior   6/ 40: energy= -89.698
Langevin prior  11/ 40: energy= -89.871
Langevin prior  16/ 40: energy= -89.808
Langevin prior  21/ 40: energy= -89.669
Langevin prior  26/ 40: energy= -89.807
Langevin prior  31/ 40: energy= -89.782
Langevin prior  36/ 40: energy= -89.794
Langevin prior  40/ 40: energy= -89.740
batch/max_batch/ep:   600/  1402/     1 rec:  104.910 mi: 0.00217319 zkl:  174.968 cd:    0.003 pos_prob:    2.998 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     1 rec:  124.981 mi: 0.00171781 zkl:  181.504 cd:    0.002 pos_prob:    2.997 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     1 rec:  115.235 mi: 0.00155401 zkl:  187.677 cd:    0.003 pos_prob:    2.997 prob_neg:    2.994 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     1 rec:  103.990 mi: 0.00202036 zkl:  194.414 cd:    0.004 pos_prob:    2.995 prob_neg:    2.991 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     1 rec:   95.547 mi: 0.00223684 zkl:  200.653 cd:    0.006 pos_prob:    2.998 prob_neg:    2.991 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.886
Langevin prior   6/ 40: energy= -89.875
Langevin prior  11/ 40: energy= -89.939
Langevin prior  16/ 40: energy= -89.936
Langevin prior  21/ 40: energy= -89.939
Langevin prior  26/ 40: energy= -89.903
Langevin prior  31/ 40: energy= -89.906
Langevin prior  36/ 40: energy= -89.901
Langevin prior  40/ 40: energy= -89.970
batch/max_batch/ep:  1100/  1402/     1 rec:   98.256 mi: 0.00232649 zkl:  202.880 cd:    0.005 pos_prob:    2.995 prob_neg:    2.991 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     1 rec:   89.707 mi: 0.00269699 zkl:  203.739 cd:    0.004 pos_prob:    2.999 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     1 rec:   91.626 mi: 0.00303936 zkl:  206.685 cd:   -0.002 pos_prob:    2.995 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     1 rec:   88.992 mi: 0.00246620 zkl:  208.002 cd:    0.010 pos_prob:    3.003 prob_neg:    2.993 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-001-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 7.96, 46.5/13.4/4.8/2.1 (BP=0.900, ratio=0.904, hyp_len=69805, ref_len=77177)
--- bleu: BLEU = 7.96, 46.5/13.4/4.8/2.1 (BP=0.900, ratio=0.904, hyp_len=69805, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     2 rec:   75.869 mi: 0.00364161 zkl:  216.052 cd:    0.007 pos_prob:    3.000 prob_neg:    2.993 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     2 rec:   85.736 mi: 0.00323558 zkl:  220.786 cd:    0.000 pos_prob:    2.993 prob_neg:    2.993 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     2 rec:   86.114 mi: 0.00294900 zkl:  219.110 cd:    0.005 pos_prob:    2.995 prob_neg:    2.990 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     2 rec:   88.073 mi: 0.00318336 zkl:  224.728 cd:    0.002 pos_prob:    2.997 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     2 rec:   94.465 mi: 0.00276518 zkl:  226.709 cd:   -0.000 pos_prob:    2.997 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.878
Langevin prior   6/ 40: energy= -89.824
Langevin prior  11/ 40: energy= -89.855
Langevin prior  16/ 40: energy= -89.894
Langevin prior  21/ 40: energy= -90.025
Langevin prior  26/ 40: energy= -90.068
Langevin prior  31/ 40: energy= -89.815
Langevin prior  36/ 40: energy= -89.690
Langevin prior  40/ 40: energy= -89.722
batch/max_batch/ep:   600/  1402/     2 rec:   67.610 mi: 0.00370264 zkl:  233.827 cd:    0.003 pos_prob:    2.999 prob_neg:    2.996 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     2 rec:  103.919 mi: 0.00310349 zkl:  232.063 cd:    0.001 pos_prob:    2.994 prob_neg:    2.993 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     2 rec:   65.765 mi: 0.00378203 zkl:  232.115 cd:   -0.004 pos_prob:    2.992 prob_neg:    2.996 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     2 rec:   71.199 mi: 0.00348115 zkl:  236.776 cd:    0.002 pos_prob:    2.994 prob_neg:    2.992 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     2 rec:   82.570 mi: 0.00337338 zkl:  238.478 cd:   -0.003 pos_prob:    2.992 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.875
Langevin prior   6/ 40: energy= -89.869
Langevin prior  11/ 40: energy= -89.786
Langevin prior  16/ 40: energy= -89.811
Langevin prior  21/ 40: energy= -89.885
Langevin prior  26/ 40: energy= -89.839
Langevin prior  31/ 40: energy= -89.779
Langevin prior  36/ 40: energy= -89.835
Langevin prior  40/ 40: energy= -89.816
batch/max_batch/ep:  1100/  1402/     2 rec:   85.587 mi: 0.00266385 zkl:  239.640 cd:    0.002 pos_prob:    2.999 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     2 rec:   76.139 mi: 0.00331020 zkl:  242.861 cd:   -0.003 pos_prob:    2.994 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     2 rec:   80.985 mi: 0.00250268 zkl:  245.342 cd:    0.005 pos_prob:    3.000 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     2 rec:   68.841 mi: 0.00365353 zkl:  246.146 cd:    0.004 pos_prob:    2.995 prob_neg:    2.992 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-002-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.61, 45.4/14.0/5.6/2.7 (BP=0.972, ratio=0.972, hyp_len=75010, ref_len=77177)
--- bleu: BLEU = 9.61, 45.4/14.0/5.6/2.7 (BP=0.972, ratio=0.972, hyp_len=75010, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     3 rec:   77.762 mi: 0.00327086 zkl:  249.667 cd:    0.009 pos_prob:    2.998 prob_neg:    2.990 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     3 rec:   66.482 mi: 0.00365520 zkl:  251.547 cd:   -0.006 pos_prob:    2.990 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     3 rec:   69.104 mi: 0.00399041 zkl:  253.827 cd:   -0.002 pos_prob:    2.996 prob_neg:    2.998 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     3 rec:   74.985 mi: 0.00366378 zkl:  258.086 cd:    0.003 pos_prob:    2.993 prob_neg:    2.990 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     3 rec:   70.820 mi: 0.00419712 zkl:  258.035 cd:    0.002 pos_prob:    2.996 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.814
Langevin prior   6/ 40: energy= -89.789
Langevin prior  11/ 40: energy= -89.659
Langevin prior  16/ 40: energy= -89.679
Langevin prior  21/ 40: energy= -89.814
Langevin prior  26/ 40: energy= -89.831
Langevin prior  31/ 40: energy= -89.835
Langevin prior  36/ 40: energy= -89.861
Langevin prior  40/ 40: energy= -89.771
batch/max_batch/ep:   600/  1402/     3 rec:   60.194 mi: 0.00448871 zkl:  258.874 cd:   -0.004 pos_prob:    2.992 prob_neg:    2.996 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     3 rec:   75.781 mi: 0.00405431 zkl:  260.701 cd:    0.001 pos_prob:    2.996 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     3 rec:   58.046 mi: 0.00353622 zkl:  260.066 cd:   -0.003 pos_prob:    2.995 prob_neg:    2.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     3 rec:   68.303 mi: 0.00366354 zkl:  261.823 cd:    0.003 pos_prob:    2.998 prob_neg:    2.996 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     3 rec:   77.458 mi: 0.00341439 zkl:  262.708 cd:   -0.007 pos_prob:    2.995 prob_neg:    3.002 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy= -89.763
Langevin prior   6/ 40: energy= -89.745
Langevin prior  11/ 40: energy= -89.819
Langevin prior  16/ 40: energy= -89.853
Langevin prior  21/ 40: energy= -89.970
Langevin prior  26/ 40: energy= -89.988
Langevin prior  31/ 40: energy= -89.864
Langevin prior  36/ 40: energy= -89.878
Langevin prior  40/ 40: energy= -89.872
batch/max_batch/ep:  1100/  1402/     3 rec:   74.651 mi: 0.00422645 zkl:  263.103 cd:    0.002 pos_prob:    2.994 prob_neg:    2.992 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     3 rec:   59.055 mi: 0.00441766 zkl:  268.758 cd:    0.008 pos_prob:    2.999 prob_neg:    2.992 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     3 rec:   64.865 mi: 0.00306654 zkl:  267.794 cd:    0.006 pos_prob:    3.001 prob_neg:    2.995 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     3 rec:   64.585 mi: 0.00378656 zkl:  267.036 cd:   -0.001 pos_prob:    2.996 prob_neg:    2.998 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-003-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.85, 47.0/14.7/6.0/3.1 (BP=0.924, ratio=0.927, hyp_len=71559, ref_len=77177)
--- bleu: BLEU = 9.85, 47.0/14.7/6.0/3.1 (BP=0.924, ratio=0.927, hyp_len=71559, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     4 rec:   69.112 mi: 0.57097530 zkl:  153.529 cd:    1.856 pos_prob:    4.851 prob_neg:    2.995 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/     4 rec:   67.736 mi: 0.77852333 zkl:  122.617 cd:    3.825 pos_prob:    6.857 prob_neg:    3.032 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/     4 rec:   63.485 mi: 0.99259424 zkl:  123.622 cd:    5.635 pos_prob:    8.760 prob_neg:    3.125 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/     4 rec:   86.003 mi: 1.38648129 zkl:  143.054 cd:   10.374 pos_prob:   13.551 prob_neg:    3.177 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/     4 rec:   78.971 mi: 1.73832488 zkl:  144.507 cd:   10.816 pos_prob:   14.283 prob_neg:    3.468 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy= -97.756
Langevin prior   6/ 40: energy=-102.702
Langevin prior  11/ 40: energy=-104.095
Langevin prior  16/ 40: energy= -98.918
Langevin prior  21/ 40: energy= -99.952
Langevin prior  26/ 40: energy=-103.510
Langevin prior  31/ 40: energy=-102.894
Langevin prior  36/ 40: energy=-100.727
Langevin prior  40/ 40: energy= -99.845
batch/max_batch/ep:   600/  1402/     4 rec:   80.166 mi: 1.91680074 zkl:  124.344 cd:   11.394 pos_prob:   14.925 prob_neg:    3.531 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/     4 rec:   77.767 mi: 2.04788709 zkl:  116.280 cd:   11.764 pos_prob:   15.703 prob_neg:    3.938 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/     4 rec:   64.514 mi: 1.94169545 zkl:   90.091 cd:   10.644 pos_prob:   14.738 prob_neg:    4.094 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/     4 rec:   61.273 mi: 1.96728349 zkl:   87.399 cd:   10.646 pos_prob:   15.187 prob_neg:    4.541 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/     4 rec:   87.165 mi: 1.86608195 zkl:   89.306 cd:   11.992 pos_prob:   17.130 prob_neg:    5.138 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-111.335
Langevin prior   6/ 40: energy=-137.834
Langevin prior  11/ 40: energy=-142.957
Langevin prior  16/ 40: energy=-135.104
Langevin prior  21/ 40: energy=-152.418
Langevin prior  26/ 40: energy=-157.659
Langevin prior  31/ 40: energy=-170.336
Langevin prior  36/ 40: energy=-165.034
Langevin prior  40/ 40: energy=-162.747
batch/max_batch/ep:  1100/  1402/     4 rec:   85.060 mi: 1.83179724 zkl:   81.623 cd:   11.165 pos_prob:   17.393 prob_neg:    6.228 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/     4 rec:   88.032 mi: 1.89923418 zkl:   86.023 cd:   13.814 pos_prob:   20.490 prob_neg:    6.677 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/     4 rec:   75.116 mi: 1.77887011 zkl:   81.068 cd:   13.059 pos_prob:   21.819 prob_neg:    8.760 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/     4 rec:   77.624 mi: 2.13091159 zkl:   66.677 cd:   10.330 pos_prob:   19.554 prob_neg:    9.224 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-004-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 8.52, 44.0/13.6/5.4/2.7 (BP=0.883, ratio=0.889, hyp_len=68627, ref_len=77177)
--- bleu: BLEU = 8.52, 44.0/13.6/5.4/2.7 (BP=0.883, ratio=0.889, hyp_len=68627, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     5 rec:   70.584 mi: 1.88866508 zkl:   72.713 cd:   11.701 pos_prob:   22.833 prob_neg:   11.132 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/     5 rec:   57.823 mi: 2.15959477 zkl:   62.532 cd:   10.815 pos_prob:   21.974 prob_neg:   11.159 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/     5 rec:   68.811 mi: 2.00730753 zkl:   61.518 cd:    9.037 pos_prob:   22.123 prob_neg:   13.086 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/     5 rec:   80.459 mi: 2.15992570 zkl:   66.533 cd:   10.197 pos_prob:   25.462 prob_neg:   15.265 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/     5 rec:   58.334 mi: 2.19691777 zkl:   53.663 cd:    7.143 pos_prob:   23.747 prob_neg:   16.604 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-147.419
Langevin prior   6/ 40: energy=-223.071
Langevin prior  11/ 40: energy=-332.823
Langevin prior  16/ 40: energy=-395.434
Langevin prior  21/ 40: energy=-434.042
Langevin prior  26/ 40: energy=-469.850
Langevin prior  31/ 40: energy=-472.107
Langevin prior  36/ 40: energy=-496.704
Langevin prior  40/ 40: energy=-496.684
batch/max_batch/ep:   600/  1402/     5 rec:   84.672 mi: 2.07831240 zkl:   58.650 cd:    8.816 pos_prob:   26.070 prob_neg:   17.254 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/     5 rec:   81.654 mi: 2.24564576 zkl:   51.258 cd:    9.397 pos_prob:   27.433 prob_neg:   18.036 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/     5 rec:   71.720 mi: 2.17221928 zkl:   59.506 cd:    7.550 pos_prob:   31.063 prob_neg:   23.513 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/     5 rec:   82.981 mi: 2.17866087 zkl:   59.304 cd:    8.163 pos_prob:   32.551 prob_neg:   24.389 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/     5 rec:   70.438 mi: 1.99638236 zkl:   49.262 cd:    5.482 pos_prob:   30.651 prob_neg:   25.169 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-172.950
Langevin prior   6/ 40: energy=-373.346
Langevin prior  11/ 40: energy=-544.510
Langevin prior  16/ 40: energy=-643.347
Langevin prior  21/ 40: energy=-696.204
Langevin prior  26/ 40: energy=-775.442
Langevin prior  31/ 40: energy=-735.208
Langevin prior  36/ 40: energy=-778.512
Langevin prior  40/ 40: energy=-747.793
batch/max_batch/ep:  1100/  1402/     5 rec:   80.375 mi: 2.24184704 zkl:   53.573 cd:    7.091 pos_prob:   34.421 prob_neg:   27.330 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/     5 rec:   80.780 mi: 2.01312828 zkl:   55.630 cd:    4.196 pos_prob:   34.008 prob_neg:   29.812 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/     5 rec:   72.742 mi: 2.21393919 zkl:   53.366 cd:    8.437 pos_prob:   36.137 prob_neg:   27.699 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/     5 rec:   95.745 mi: 1.98771179 zkl:   63.255 cd:    8.055 pos_prob:   40.667 prob_neg:   32.612 kl_weight:    0.500 do_ae_train: False
200 done. -80.02820874071287
400 done. -85.28335226283481
600 done. -86.23894637309678
800 done. -86.79538753595273
1000 done. -87.87159519230994
1200 done. -89.13679322183796
1400 done. -90.16840779570538
1600 done. -89.43469773786677
1800 done. -87.6052888532327
2000 done. -85.28970381038992
2200 done. -84.45742962782181
2400 done. -83.7495975761392
2600 done. -84.0323149764538
2800 done. -83.8555098110238
3000 done. -84.09211152341892
3200 done. -84.5352090420271
3400 done. -84.70888939700944
3600 done. -85.35259480310346
Negative Log-likehood -85.907528
log-likelihood:    -85.908
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-005-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-005-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 8.71, 43.7/13.6/5.5/2.7 (BP=0.895, ratio=0.900, hyp_len=69437, ref_len=77177)
--- bleu: BLEU = 8.71, 43.7/13.6/5.5/2.7 (BP=0.895, ratio=0.900, hyp_len=69437, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     6 rec:   73.532 mi: 2.06327891 zkl:   50.166 cd:    3.434 pos_prob:   35.376 prob_neg:   31.942 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/     6 rec:   77.754 mi: 2.17048550 zkl:   55.557 cd:    8.976 pos_prob:   40.921 prob_neg:   31.945 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/     6 rec:   59.699 mi: 1.87102902 zkl:   60.141 cd:    5.666 pos_prob:   43.560 prob_neg:   37.894 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/     6 rec:   66.268 mi: 2.12922907 zkl:   51.029 cd:   -0.989 pos_prob:   37.282 prob_neg:   38.271 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/     6 rec:   77.160 mi: 2.14624262 zkl:   49.974 cd:    0.359 pos_prob:   39.217 prob_neg:   38.858 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-221.593
Langevin prior   6/ 40: energy=-587.586
Langevin prior  11/ 40: energy=-874.775
Langevin prior  16/ 40: energy=-1028.169
Langevin prior  21/ 40: energy=-1061.873
Langevin prior  26/ 40: energy=-1029.726
Langevin prior  31/ 40: energy=-1091.646
Langevin prior  36/ 40: energy=-1096.325
Langevin prior  40/ 40: energy=-1122.819
batch/max_batch/ep:   600/  1402/     6 rec:   62.931 mi: 2.32648659 zkl:   48.715 cd:    0.938 pos_prob:   38.885 prob_neg:   37.947 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/     6 rec:   77.453 mi: 2.10355592 zkl:   53.633 cd:    1.099 pos_prob:   42.075 prob_neg:   40.976 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/     6 rec:   72.273 mi: 2.04264545 zkl:   51.868 cd:   -1.634 pos_prob:   39.036 prob_neg:   40.669 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/     6 rec:   84.269 mi: 2.01314235 zkl:   55.799 cd:    0.643 pos_prob:   43.309 prob_neg:   42.667 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/     6 rec:   71.501 mi: 2.16358805 zkl:   47.407 cd:   -5.488 pos_prob:   37.583 prob_neg:   43.071 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-242.627
Langevin prior   6/ 40: energy=-737.431
Langevin prior  11/ 40: energy=-1005.969
Langevin prior  16/ 40: energy=-1178.879
Langevin prior  21/ 40: energy=-1284.434
Langevin prior  26/ 40: energy=-1328.064
Langevin prior  31/ 40: energy=-1388.524
Langevin prior  36/ 40: energy=-1344.283
Langevin prior  40/ 40: energy=-1355.450
batch/max_batch/ep:  1100/  1402/     6 rec:   77.313 mi: 2.12139320 zkl:   52.104 cd:   -1.818 pos_prob:   43.638 prob_neg:   45.455 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/     6 rec:   93.754 mi: 2.06312966 zkl:   61.193 cd:    2.599 pos_prob:   49.332 prob_neg:   46.733 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/     6 rec:   69.948 mi: 2.23285294 zkl:   55.892 cd:   -0.474 pos_prob:   46.611 prob_neg:   47.085 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/     6 rec:   66.012 mi: 2.18344569 zkl:   52.517 cd:   -1.921 pos_prob:   45.898 prob_neg:   47.820 kl_weight:    0.500 do_ae_train: False
200 done. -79.11598827666892
400 done. -84.507378549679
600 done. -85.55691032030401
800 done. -86.02243984337383
1000 done. -86.97770760493242
1200 done. -88.17964636594884
1400 done. -89.20716040068844
1600 done. -88.45162066110198
1800 done. -86.64145790797106
2000 done. -84.33995194233654
2200 done. -83.55003968523108
2400 done. -82.81250824903378
2600 done. -83.08722592868692
2800 done. -82.88668926258103
3000 done. -83.14779008536286
3200 done. -83.61329112626078
3400 done. -83.80696810092799
3600 done. -84.43517667553633
Negative Log-likehood -85.003384
log-likelihood:    -85.003
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-006-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-006-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 8.43, 44.3/13.8/5.7/2.9 (BP=0.846, ratio=0.856, hyp_len=66086, ref_len=77177)
--- bleu: BLEU = 8.43, 44.3/13.8/5.7/2.9 (BP=0.846, ratio=0.856, hyp_len=66086, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     7 rec:   64.374 mi: 2.19029260 zkl:  142.203 cd:  -11.692 pos_prob:   37.219 prob_neg:   48.911 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     7 rec:   57.151 mi: 2.24805117 zkl:  146.200 cd:  -14.040 pos_prob:   35.001 prob_neg:   49.042 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     7 rec:   61.464 mi: 2.14166737 zkl:  146.996 cd:  -15.313 pos_prob:   31.599 prob_neg:   46.912 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     7 rec:   60.680 mi: 2.00061297 zkl:  148.745 cd:  -22.040 pos_prob:   26.392 prob_neg:   48.432 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     7 rec:   69.026 mi: 2.12924075 zkl:  154.158 cd:  -24.984 pos_prob:   24.020 prob_neg:   49.004 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-230.217
Langevin prior   6/ 40: energy=-761.069
Langevin prior  11/ 40: energy=-1080.205
Langevin prior  16/ 40: energy=-1321.066
Langevin prior  21/ 40: energy=-1502.902
Langevin prior  26/ 40: energy=-1437.996
Langevin prior  31/ 40: energy=-1384.902
Langevin prior  36/ 40: energy=-1383.005
Langevin prior  40/ 40: energy=-1364.614
batch/max_batch/ep:   600/  1402/     7 rec:   63.317 mi: 2.27895164 zkl:  157.312 cd:  -22.217 pos_prob:   24.620 prob_neg:   46.837 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     7 rec:   57.128 mi: 1.93406677 zkl:  157.873 cd:  -24.249 pos_prob:   20.841 prob_neg:   45.090 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     7 rec:   63.661 mi: 1.98143697 zkl:  160.631 cd:  -28.313 pos_prob:   19.786 prob_neg:   48.099 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     7 rec:   59.465 mi: 2.10786319 zkl:  164.469 cd:  -28.066 pos_prob:   21.215 prob_neg:   49.281 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     7 rec:   68.179 mi: 2.03287697 zkl:  165.914 cd:  -27.218 pos_prob:   20.056 prob_neg:   47.274 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-230.984
Langevin prior   6/ 40: energy=-723.365
Langevin prior  11/ 40: energy=-1035.229
Langevin prior  16/ 40: energy=-1213.921
Langevin prior  21/ 40: energy=-1283.850
Langevin prior  26/ 40: energy=-1378.470
Langevin prior  31/ 40: energy=-1423.853
Langevin prior  36/ 40: energy=-1464.734
Langevin prior  40/ 40: energy=-1463.617
batch/max_batch/ep:  1100/  1402/     7 rec:   59.523 mi: 1.89220858 zkl:  164.017 cd:  -28.818 pos_prob:   18.372 prob_neg:   47.190 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     7 rec:   53.415 mi: 1.78731322 zkl:  166.791 cd:  -31.527 pos_prob:   15.491 prob_neg:   47.018 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     7 rec:   62.404 mi: 1.91777349 zkl:  169.532 cd:  -23.941 pos_prob:   20.253 prob_neg:   44.194 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     7 rec:   55.788 mi: 2.00645638 zkl:  170.337 cd:  -27.861 pos_prob:   20.264 prob_neg:   48.124 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-007-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.41, 45.5/14.4/6.4/3.5 (BP=0.948, ratio=0.949, hyp_len=73240, ref_len=77177)
--- bleu: BLEU = 10.41, 45.5/14.4/6.4/3.5 (BP=0.948, ratio=0.949, hyp_len=73240, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     8 rec:   57.339 mi: 1.98472631 zkl:  175.426 cd:  -26.944 pos_prob:   18.638 prob_neg:   45.582 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     8 rec:   68.637 mi: 1.87032652 zkl:  175.382 cd:  -23.414 pos_prob:   20.066 prob_neg:   43.480 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     8 rec:   58.038 mi: 2.11187172 zkl:  178.520 cd:  -26.038 pos_prob:   19.783 prob_neg:   45.821 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     8 rec:   68.816 mi: 1.80431569 zkl:  179.231 cd:  -26.432 pos_prob:   19.065 prob_neg:   45.498 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     8 rec:   54.835 mi: 1.86248636 zkl:  179.600 cd:  -29.558 pos_prob:   18.166 prob_neg:   47.723 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-252.972
Langevin prior   6/ 40: energy=-728.384
Langevin prior  11/ 40: energy=-1107.412
Langevin prior  16/ 40: energy=-1244.617
Langevin prior  21/ 40: energy=-1346.288
Langevin prior  26/ 40: energy=-1407.359
Langevin prior  31/ 40: energy=-1451.011
Langevin prior  36/ 40: energy=-1436.938
Langevin prior  40/ 40: energy=-1415.857
batch/max_batch/ep:   600/  1402/     8 rec:   57.548 mi: 2.06056523 zkl:  176.133 cd:  -30.100 pos_prob:   18.575 prob_neg:   48.676 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     8 rec:   66.319 mi: 1.86797881 zkl:  179.054 cd:  -27.283 pos_prob:   19.534 prob_neg:   46.817 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     8 rec:   53.407 mi: 1.94410634 zkl:  179.549 cd:  -30.469 pos_prob:   17.472 prob_neg:   47.941 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     8 rec:   61.783 mi: 1.90915382 zkl:  181.053 cd:  -32.357 pos_prob:   17.531 prob_neg:   49.888 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     8 rec:   49.066 mi: 1.99327600 zkl:  181.572 cd:  -29.180 pos_prob:   17.133 prob_neg:   46.313 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-214.454
Langevin prior   6/ 40: energy=-622.343
Langevin prior  11/ 40: energy=-1049.574
Langevin prior  16/ 40: energy=-1270.463
Langevin prior  21/ 40: energy=-1324.732
Langevin prior  26/ 40: energy=-1368.707
Langevin prior  31/ 40: energy=-1369.163
Langevin prior  36/ 40: energy=-1320.457
Langevin prior  40/ 40: energy=-1352.757
batch/max_batch/ep:  1100/  1402/     8 rec:   44.515 mi: 1.95847213 zkl:  181.660 cd:  -28.778 pos_prob:   17.079 prob_neg:   45.857 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     8 rec:   52.376 mi: 2.03272295 zkl:  179.861 cd:  -27.283 pos_prob:   18.187 prob_neg:   45.471 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     8 rec:   59.597 mi: 2.01104307 zkl:  185.648 cd:  -30.287 pos_prob:   17.848 prob_neg:   48.136 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     8 rec:   53.329 mi: 1.97851336 zkl:  185.952 cd:  -28.214 pos_prob:   17.482 prob_neg:   45.697 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-008-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.85, 44.9/14.4/6.6/3.7 (BP=0.969, ratio=0.970, hyp_len=74834, ref_len=77177)
--- bleu: BLEU = 10.85, 44.9/14.4/6.6/3.7 (BP=0.969, ratio=0.970, hyp_len=74834, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/     9 rec:   53.675 mi: 1.92793179 zkl:  185.523 cd:  -30.854 pos_prob:   16.769 prob_neg:   47.623 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/     9 rec:   58.927 mi: 2.05095625 zkl:  189.774 cd:  -26.905 pos_prob:   19.407 prob_neg:   46.312 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/     9 rec:   65.763 mi: 1.97689867 zkl:  192.292 cd:  -26.777 pos_prob:   17.034 prob_neg:   43.811 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/     9 rec:   51.055 mi: 1.94541109 zkl:  192.925 cd:  -26.599 pos_prob:   19.855 prob_neg:   46.454 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/     9 rec:   79.081 mi: 1.89256001 zkl:  194.384 cd:  -30.370 pos_prob:   17.593 prob_neg:   47.963 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-224.841
Langevin prior   6/ 40: energy=-667.525
Langevin prior  11/ 40: energy=-1064.575
Langevin prior  16/ 40: energy=-1264.796
Langevin prior  21/ 40: energy=-1407.672
Langevin prior  26/ 40: energy=-1449.691
Langevin prior  31/ 40: energy=-1399.692
Langevin prior  36/ 40: energy=-1365.483
Langevin prior  40/ 40: energy=-1358.230
batch/max_batch/ep:   600/  1402/     9 rec:   54.173 mi: 1.89701009 zkl:  192.935 cd:  -30.565 pos_prob:   17.364 prob_neg:   47.929 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/     9 rec:   56.201 mi: 1.93679976 zkl:  195.747 cd:  -28.805 pos_prob:   16.867 prob_neg:   45.671 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/     9 rec:   59.839 mi: 1.96083736 zkl:  197.640 cd:  -29.253 pos_prob:   17.449 prob_neg:   46.702 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/     9 rec:   52.419 mi: 1.88442779 zkl:  196.337 cd:  -26.660 pos_prob:   21.074 prob_neg:   47.734 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/     9 rec:   70.517 mi: 2.02684665 zkl:  198.097 cd:  -28.787 pos_prob:   17.151 prob_neg:   45.938 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-207.455
Langevin prior   6/ 40: energy=-659.091
Langevin prior  11/ 40: energy=-1017.944
Langevin prior  16/ 40: energy=-1214.588
Langevin prior  21/ 40: energy=-1284.572
Langevin prior  26/ 40: energy=-1331.087
Langevin prior  31/ 40: energy=-1330.382
Langevin prior  36/ 40: energy=-1335.948
Langevin prior  40/ 40: energy=-1310.145
batch/max_batch/ep:  1100/  1402/     9 rec:   63.347 mi: 1.99450099 zkl:  199.436 cd:  -26.219 pos_prob:   19.873 prob_neg:   46.092 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/     9 rec:   54.377 mi: 1.97616887 zkl:  197.079 cd:  -30.507 pos_prob:   18.448 prob_neg:   48.955 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/     9 rec:   49.088 mi: 1.97174346 zkl:  195.073 cd:  -29.087 pos_prob:   18.150 prob_neg:   47.237 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/     9 rec:   53.716 mi: 1.91645002 zkl:  198.424 cd:  -30.838 pos_prob:   16.327 prob_neg:   47.165 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-009-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.68, 45.9/14.7/6.8/4.0 (BP=0.918, ratio=0.921, hyp_len=71098, ref_len=77177)
--- bleu: BLEU = 10.68, 45.9/14.7/6.8/4.0 (BP=0.918, ratio=0.921, hyp_len=71098, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    10 rec:   50.496 mi: 2.18483186 zkl:  156.327 cd:  -22.389 pos_prob:   32.290 prob_neg:   54.680 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    10 rec:   63.642 mi: 2.27499199 zkl:  129.250 cd:   -9.823 pos_prob:   47.250 prob_neg:   57.073 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    10 rec:   60.583 mi: 2.14086056 zkl:  124.176 cd:   -7.927 pos_prob:   51.197 prob_neg:   59.123 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    10 rec:   64.422 mi: 2.11919832 zkl:  112.926 cd:   -8.750 pos_prob:   51.392 prob_neg:   60.142 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    10 rec:   51.365 mi: 2.26791859 zkl:  113.732 cd:   -6.527 pos_prob:   55.389 prob_neg:   61.916 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-255.078
Langevin prior   6/ 40: energy=-923.066
Langevin prior  11/ 40: energy=-1409.680
Langevin prior  16/ 40: energy=-1618.096
Langevin prior  21/ 40: energy=-1770.288
Langevin prior  26/ 40: energy=-1739.510
Langevin prior  31/ 40: energy=-1795.498
Langevin prior  36/ 40: energy=-1797.889
Langevin prior  40/ 40: energy=-1793.570
batch/max_batch/ep:   600/  1402/    10 rec:   50.166 mi: 2.28922820 zkl:  110.518 cd:  -12.107 pos_prob:   49.819 prob_neg:   61.926 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    10 rec:   67.719 mi: 2.23282981 zkl:  101.275 cd:   -3.921 pos_prob:   58.244 prob_neg:   62.165 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    10 rec:   55.693 mi: 2.25101590 zkl:  100.438 cd:   -7.116 pos_prob:   55.606 prob_neg:   62.722 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    10 rec:   64.398 mi: 2.22596121 zkl:  100.258 cd:   -5.308 pos_prob:   58.005 prob_neg:   63.313 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    10 rec:   57.033 mi: 2.34539056 zkl:   97.143 cd:    2.476 pos_prob:   62.454 prob_neg:   59.978 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-230.445
Langevin prior   6/ 40: energy=-915.998
Langevin prior  11/ 40: energy=-1477.915
Langevin prior  16/ 40: energy=-1736.380
Langevin prior  21/ 40: energy=-1796.496
Langevin prior  26/ 40: energy=-1783.967
Langevin prior  31/ 40: energy=-1852.893
Langevin prior  36/ 40: energy=-1867.764
Langevin prior  40/ 40: energy=-1868.258
batch/max_batch/ep:  1100/  1402/    10 rec:   59.255 mi: 1.96272373 zkl:   84.470 cd:   -7.379 pos_prob:   55.584 prob_neg:   62.962 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    10 rec:   58.634 mi: 2.19384956 zkl:   81.122 cd:   -9.875 pos_prob:   51.593 prob_neg:   61.468 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    10 rec:   76.747 mi: 1.96918297 zkl:   94.431 cd:   -1.063 pos_prob:   61.491 prob_neg:   62.553 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    10 rec:   68.910 mi: 2.25232315 zkl:   77.975 cd:   -5.863 pos_prob:   53.273 prob_neg:   59.136 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-010-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.81, 43.4/13.6/5.9/3.3 (BP=0.948, ratio=0.949, hyp_len=73245, ref_len=77177)
--- bleu: BLEU = 9.81, 43.4/13.6/5.9/3.3 (BP=0.948, ratio=0.949, hyp_len=73245, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    11 rec:   64.031 mi: 2.03983188 zkl:   83.826 cd:   -5.575 pos_prob:   56.368 prob_neg:   61.943 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    11 rec:   65.255 mi: 2.14087772 zkl:   86.290 cd:   -4.052 pos_prob:   60.619 prob_neg:   64.671 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    11 rec:   53.399 mi: 2.23450971 zkl:   76.246 cd:   -6.397 pos_prob:   54.770 prob_neg:   61.167 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    11 rec:   59.937 mi: 2.32640314 zkl:   70.991 cd:   -2.095 pos_prob:   59.214 prob_neg:   61.310 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    11 rec:   56.515 mi: 2.24871755 zkl:   63.054 cd:  -10.382 pos_prob:   50.169 prob_neg:   60.551 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-264.598
Langevin prior   6/ 40: energy=-924.548
Langevin prior  11/ 40: energy=-1381.998
Langevin prior  16/ 40: energy=-1595.547
Langevin prior  21/ 40: energy=-1782.424
Langevin prior  26/ 40: energy=-1783.837
Langevin prior  31/ 40: energy=-1813.172
Langevin prior  36/ 40: energy=-1814.376
Langevin prior  40/ 40: energy=-1862.626
batch/max_batch/ep:   600/  1402/    11 rec:   66.476 mi: 2.27149034 zkl:   69.094 cd:   -5.702 pos_prob:   53.999 prob_neg:   59.701 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    11 rec:   63.230 mi: 2.31306005 zkl:   70.689 cd:   -0.483 pos_prob:   59.465 prob_neg:   59.948 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    11 rec:   59.538 mi: 2.11474991 zkl:   68.846 cd:   -6.015 pos_prob:   53.631 prob_neg:   59.647 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    11 rec:   58.184 mi: 1.97169662 zkl:   68.318 cd:   -0.618 pos_prob:   59.453 prob_neg:   60.070 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    11 rec:   67.270 mi: 2.25269651 zkl:   70.553 cd:    1.985 pos_prob:   61.037 prob_neg:   59.053 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-316.398
Langevin prior   6/ 40: energy=-976.496
Langevin prior  11/ 40: energy=-1416.385
Langevin prior  16/ 40: energy=-1649.683
Langevin prior  21/ 40: energy=-1735.720
Langevin prior  26/ 40: energy=-1707.735
Langevin prior  31/ 40: energy=-1751.347
Langevin prior  36/ 40: energy=-1745.667
Langevin prior  40/ 40: energy=-1791.119
batch/max_batch/ep:  1100/  1402/    11 rec:   64.861 mi: 2.32480788 zkl:   69.875 cd:   -2.800 pos_prob:   54.835 prob_neg:   57.634 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    11 rec:   61.961 mi: 2.19708991 zkl:   74.816 cd:   -1.078 pos_prob:   58.508 prob_neg:   59.586 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    11 rec:   72.922 mi: 2.28787136 zkl:   64.742 cd:   -3.306 pos_prob:   55.088 prob_neg:   58.394 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    11 rec:   81.816 mi: 2.28793216 zkl:   68.998 cd:   -1.871 pos_prob:   55.109 prob_neg:   56.980 kl_weight:    0.500 do_ae_train: False
200 done. -74.85893635694372
400 done. -80.2576934904496
600 done. -81.14258480148698
800 done. -81.37060914024991
1000 done. -82.60503820648339
1200 done. -83.79647121178617
1400 done. -84.83910191166873
1600 done. -84.1586772270258
1800 done. -82.48334714254895
2000 done. -80.13434677439321
2200 done. -79.30843978614571
2400 done. -78.53973088669139
2600 done. -78.79416621165171
2800 done. -78.7274432058584
3000 done. -78.97814798979395
3200 done. -79.37862525033599
3400 done. -79.60007426383557
3600 done. -80.24759849274717
Negative Log-likehood -80.787758
log-likelihood:    -80.788
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-011-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-011-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.29, 43.5/13.4/5.8/3.2 (BP=0.914, ratio=0.918, hyp_len=70832, ref_len=77177)
--- bleu: BLEU = 9.29, 43.5/13.4/5.8/3.2 (BP=0.914, ratio=0.918, hyp_len=70832, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    12 rec:   68.360 mi: 1.96862662 zkl:   68.258 cd:   -5.090 pos_prob:   50.617 prob_neg:   55.707 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    12 rec:   71.981 mi: 2.08014941 zkl:   67.083 cd:   -1.074 pos_prob:   56.116 prob_neg:   57.190 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    12 rec:   73.178 mi: 2.03354645 zkl:   72.782 cd:   -1.918 pos_prob:   57.160 prob_neg:   59.078 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    12 rec:   62.440 mi: 2.14217257 zkl:   66.618 cd:   -2.754 pos_prob:   55.916 prob_neg:   58.670 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    12 rec:   58.482 mi: 2.18834972 zkl:   61.396 cd:   -6.756 pos_prob:   51.898 prob_neg:   58.653 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-302.896
Langevin prior   6/ 40: energy=-962.401
Langevin prior  11/ 40: energy=-1360.718
Langevin prior  16/ 40: energy=-1539.348
Langevin prior  21/ 40: energy=-1684.646
Langevin prior  26/ 40: energy=-1742.649
Langevin prior  31/ 40: energy=-1740.003
Langevin prior  36/ 40: energy=-1705.452
Langevin prior  40/ 40: energy=-1739.943
batch/max_batch/ep:   600/  1402/    12 rec:   78.644 mi: 1.98681641 zkl:   69.066 cd:   -4.042 pos_prob:   53.201 prob_neg:   57.243 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    12 rec:   53.232 mi: 1.92719221 zkl:   60.144 cd:   -9.497 pos_prob:   49.913 prob_neg:   59.410 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    12 rec:   74.595 mi: 2.23362470 zkl:   65.828 cd:   -5.301 pos_prob:   53.835 prob_neg:   59.136 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    12 rec:   60.110 mi: 2.28311872 zkl:   60.616 cd:   -5.018 pos_prob:   51.737 prob_neg:   56.755 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    12 rec:   63.230 mi: 2.13069296 zkl:   67.544 cd:    0.098 pos_prob:   58.653 prob_neg:   58.555 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-257.204
Langevin prior   6/ 40: energy=-889.686
Langevin prior  11/ 40: energy=-1386.370
Langevin prior  16/ 40: energy=-1572.541
Langevin prior  21/ 40: energy=-1678.979
Langevin prior  26/ 40: energy=-1720.046
Langevin prior  31/ 40: energy=-1727.896
Langevin prior  36/ 40: energy=-1743.581
Langevin prior  40/ 40: energy=-1793.571
batch/max_batch/ep:  1100/  1402/    12 rec:   53.251 mi: 2.26000810 zkl:   59.235 cd:   -3.910 pos_prob:   53.742 prob_neg:   57.652 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    12 rec:   67.706 mi: 2.15941119 zkl:   60.270 cd:   -7.794 pos_prob:   51.572 prob_neg:   59.366 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    12 rec:   73.517 mi: 2.17707610 zkl:   64.500 cd:   -4.166 pos_prob:   53.247 prob_neg:   57.413 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    12 rec:   63.922 mi: 2.27599382 zkl:   64.738 cd:    1.124 pos_prob:   57.828 prob_neg:   56.704 kl_weight:    0.500 do_ae_train: False
200 done. -75.03980165275252
400 done. -80.60959927876162
600 done. -81.54979703963976
800 done. -81.82844659737445
1000 done. -83.09419693292142
1200 done. -84.20447809277375
1400 done. -85.26829651786373
1600 done. -84.618012034044
1800 done. -82.96112053939362
2000 done. -80.6096608111952
2200 done. -79.77814771095306
2400 done. -79.04691047049354
2600 done. -79.32543492878119
2800 done. -79.25973131288187
3000 done. -79.47790462649735
3200 done. -79.90420375798345
3400 done. -80.08891606202984
3600 done. -80.74075413079986
Negative Log-likehood -81.313019
log-likelihood:    -81.313
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-012-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-012-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.46, 42.9/13.3/5.7/3.1 (BP=0.941, ratio=0.943, hyp_len=72788, ref_len=77177)
--- bleu: BLEU = 9.46, 42.9/13.3/5.7/3.1 (BP=0.941, ratio=0.943, hyp_len=72788, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    13 rec:   60.134 mi: 2.30360651 zkl:  157.365 cd:   -6.834 pos_prob:   51.191 prob_neg:   58.025 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    13 rec:   65.836 mi: 2.27517033 zkl:  159.531 cd:  -19.000 pos_prob:   38.984 prob_neg:   57.984 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    13 rec:   62.417 mi: 2.32299852 zkl:  161.827 cd:  -19.464 pos_prob:   37.718 prob_neg:   57.183 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    13 rec:   52.339 mi: 2.19114184 zkl:  164.818 cd:  -24.867 pos_prob:   33.314 prob_neg:   58.182 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    13 rec:   66.220 mi: 2.14540815 zkl:  169.793 cd:  -24.269 pos_prob:   32.906 prob_neg:   57.175 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-255.944
Langevin prior   6/ 40: energy=-829.800
Langevin prior  11/ 40: energy=-1224.991
Langevin prior  16/ 40: energy=-1520.242
Langevin prior  21/ 40: energy=-1643.082
Langevin prior  26/ 40: energy=-1754.224
Langevin prior  31/ 40: energy=-1779.600
Langevin prior  36/ 40: energy=-1745.969
Langevin prior  40/ 40: energy=-1773.446
batch/max_batch/ep:   600/  1402/    13 rec:   68.028 mi: 2.12178588 zkl:  171.108 cd:  -28.713 pos_prob:   30.179 prob_neg:   58.891 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    13 rec:   63.930 mi: 1.97874653 zkl:  169.917 cd:  -30.785 pos_prob:   27.696 prob_neg:   58.481 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    13 rec:   41.914 mi: 2.19868970 zkl:  167.188 cd:  -29.561 pos_prob:   28.840 prob_neg:   58.401 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    13 rec:   50.611 mi: 2.28391218 zkl:  174.920 cd:  -29.654 pos_prob:   27.621 prob_neg:   57.275 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    13 rec:   41.682 mi: 2.22799730 zkl:  174.435 cd:  -29.329 pos_prob:   27.725 prob_neg:   57.054 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-269.845
Langevin prior   6/ 40: energy=-888.811
Langevin prior  11/ 40: energy=-1387.236
Langevin prior  16/ 40: energy=-1582.934
Langevin prior  21/ 40: energy=-1658.510
Langevin prior  26/ 40: energy=-1717.857
Langevin prior  31/ 40: energy=-1690.866
Langevin prior  36/ 40: energy=-1680.126
Langevin prior  40/ 40: energy=-1716.778
batch/max_batch/ep:  1100/  1402/    13 rec:   49.375 mi: 2.29686213 zkl:  173.455 cd:  -30.753 pos_prob:   27.960 prob_neg:   58.713 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    13 rec:   52.009 mi: 1.81880200 zkl:  177.606 cd:  -27.471 pos_prob:   27.185 prob_neg:   54.656 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    13 rec:   56.055 mi: 2.22842646 zkl:  180.569 cd:  -29.183 pos_prob:   25.388 prob_neg:   54.570 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    13 rec:   76.229 mi: 2.12999630 zkl:  180.194 cd:  -37.519 pos_prob:   22.143 prob_neg:   59.662 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-013-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.93, 44.2/14.3/6.6/3.8 (BP=0.971, ratio=0.971, hyp_len=74953, ref_len=77177)
--- bleu: BLEU = 10.93, 44.2/14.3/6.6/3.8 (BP=0.971, ratio=0.971, hyp_len=74953, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    14 rec:   49.507 mi: 2.10041809 zkl:  182.428 cd:  -33.770 pos_prob:   23.886 prob_neg:   57.657 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    14 rec:   47.085 mi: 2.09570265 zkl:  184.050 cd:  -28.743 pos_prob:   24.441 prob_neg:   53.183 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    14 rec:   42.786 mi: 2.10040736 zkl:  182.573 cd:  -33.811 pos_prob:   22.602 prob_neg:   56.412 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    14 rec:   48.937 mi: 2.04117298 zkl:  188.069 cd:  -35.325 pos_prob:   22.644 prob_neg:   57.969 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    14 rec:   53.199 mi: 1.89469421 zkl:  187.640 cd:  -37.273 pos_prob:   20.161 prob_neg:   57.434 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-227.675
Langevin prior   6/ 40: energy=-772.280
Langevin prior  11/ 40: energy=-1305.153
Langevin prior  16/ 40: energy=-1402.798
Langevin prior  21/ 40: energy=-1570.938
Langevin prior  26/ 40: energy=-1665.301
Langevin prior  31/ 40: energy=-1668.097
Langevin prior  36/ 40: energy=-1639.607
Langevin prior  40/ 40: energy=-1710.765
batch/max_batch/ep:   600/  1402/    14 rec:   60.500 mi: 2.00675821 zkl:  187.621 cd:  -35.085 pos_prob:   23.499 prob_neg:   58.584 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    14 rec:   43.066 mi: 2.28485966 zkl:  188.376 cd:  -34.307 pos_prob:   23.463 prob_neg:   57.770 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    14 rec:   55.303 mi: 2.09667420 zkl:  189.894 cd:  -36.350 pos_prob:   22.242 prob_neg:   58.591 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    14 rec:   47.750 mi: 2.16922188 zkl:  191.168 cd:  -35.760 pos_prob:   21.122 prob_neg:   56.883 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    14 rec:   33.815 mi: 2.00956678 zkl:  191.873 cd:  -39.607 pos_prob:   19.705 prob_neg:   59.313 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-229.453
Langevin prior   6/ 40: energy=-946.838
Langevin prior  11/ 40: energy=-1371.723
Langevin prior  16/ 40: energy=-1557.086
Langevin prior  21/ 40: energy=-1606.782
Langevin prior  26/ 40: energy=-1719.617
Langevin prior  31/ 40: energy=-1721.911
Langevin prior  36/ 40: energy=-1747.530
Langevin prior  40/ 40: energy=-1738.726
batch/max_batch/ep:  1100/  1402/    14 rec:   61.902 mi: 2.11478329 zkl:  190.207 cd:  -38.477 pos_prob:   20.420 prob_neg:   58.898 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    14 rec:   69.387 mi: 1.93708527 zkl:  194.229 cd:  -38.199 pos_prob:   21.236 prob_neg:   59.436 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    14 rec:   58.159 mi: 2.19489384 zkl:  192.473 cd:  -37.242 pos_prob:   21.364 prob_neg:   58.606 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    14 rec:   38.759 mi: 2.11110973 zkl:  194.825 cd:  -35.134 pos_prob:   21.240 prob_neg:   56.374 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-014-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.19, 43.9/14.3/6.7/3.9 (BP=0.988, ratio=0.988, hyp_len=76243, ref_len=77177)
--- bleu: BLEU = 11.19, 43.9/14.3/6.7/3.9 (BP=0.988, ratio=0.988, hyp_len=76243, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    15 rec:   50.427 mi: 2.08825541 zkl:  195.853 cd:  -36.517 pos_prob:   21.068 prob_neg:   57.586 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    15 rec:   42.315 mi: 2.09470057 zkl:  193.525 cd:  -36.269 pos_prob:   22.677 prob_neg:   58.946 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    15 rec:   40.089 mi: 2.12715387 zkl:  195.575 cd:  -33.017 pos_prob:   21.676 prob_neg:   54.693 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    15 rec:   48.357 mi: 2.09707475 zkl:  199.901 cd:  -35.533 pos_prob:   22.533 prob_neg:   58.066 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    15 rec:   47.220 mi: 2.10380363 zkl:  199.951 cd:  -35.578 pos_prob:   20.514 prob_neg:   56.092 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-237.098
Langevin prior   6/ 40: energy=-900.011
Langevin prior  11/ 40: energy=-1313.438
Langevin prior  16/ 40: energy=-1464.460
Langevin prior  21/ 40: energy=-1646.957
Langevin prior  26/ 40: energy=-1743.983
Langevin prior  31/ 40: energy=-1737.794
Langevin prior  36/ 40: energy=-1748.110
Langevin prior  40/ 40: energy=-1794.566
batch/max_batch/ep:   600/  1402/    15 rec:   35.730 mi: 2.22823024 zkl:  198.647 cd:  -37.649 pos_prob:   21.960 prob_neg:   59.609 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    15 rec:   49.696 mi: 2.12506652 zkl:  200.212 cd:  -35.922 pos_prob:   21.838 prob_neg:   57.760 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    15 rec:   40.491 mi: 2.16789341 zkl:  201.686 cd:  -38.125 pos_prob:   21.175 prob_neg:   59.299 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    15 rec:   59.136 mi: 2.06272340 zkl:  202.458 cd:  -36.087 pos_prob:   21.054 prob_neg:   57.141 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    15 rec:   50.145 mi: 1.99727976 zkl:  202.051 cd:  -37.688 pos_prob:   20.082 prob_neg:   57.770 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-254.176
Langevin prior   6/ 40: energy=-909.501
Langevin prior  11/ 40: energy=-1374.619
Langevin prior  16/ 40: energy=-1518.674
Langevin prior  21/ 40: energy=-1647.863
Langevin prior  26/ 40: energy=-1688.009
Langevin prior  31/ 40: energy=-1761.959
Langevin prior  36/ 40: energy=-1753.482
Langevin prior  40/ 40: energy=-1698.052
batch/max_batch/ep:  1100/  1402/    15 rec:   46.064 mi: 2.00043392 zkl:  202.996 cd:  -40.172 pos_prob:   20.024 prob_neg:   60.196 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    15 rec:   49.718 mi: 2.12181020 zkl:  201.722 cd:  -39.292 pos_prob:   19.058 prob_neg:   58.350 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    15 rec:   42.545 mi: 2.01858187 zkl:  201.242 cd:  -38.486 pos_prob:   20.518 prob_neg:   59.005 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    15 rec:   58.838 mi: 2.19802856 zkl:  201.446 cd:  -35.561 pos_prob:   20.454 prob_neg:   56.015 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-015-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.97, 44.6/14.4/6.8/4.0 (BP=0.954, ratio=0.955, hyp_len=73699, ref_len=77177)
--- bleu: BLEU = 10.97, 44.6/14.4/6.8/4.0 (BP=0.954, ratio=0.955, hyp_len=73699, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    16 rec:   54.747 mi: 2.32253289 zkl:  135.378 cd:  -26.895 pos_prob:   37.781 prob_neg:   64.675 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    16 rec:   52.077 mi: 2.21393895 zkl:  115.581 cd:  -28.077 pos_prob:   44.335 prob_neg:   72.412 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    16 rec:   55.753 mi: 1.98986936 zkl:  122.372 cd:  -17.815 pos_prob:   54.516 prob_neg:   72.332 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    16 rec:   53.701 mi: 2.20995975 zkl:  110.138 cd:  -14.557 pos_prob:   54.893 prob_neg:   69.450 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    16 rec:   55.355 mi: 2.27246094 zkl:  113.154 cd:   -8.445 pos_prob:   60.581 prob_neg:   69.025 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-325.738
Langevin prior   6/ 40: energy=-1200.455
Langevin prior  11/ 40: energy=-1639.837
Langevin prior  16/ 40: energy=-1909.380
Langevin prior  21/ 40: energy=-2077.152
Langevin prior  26/ 40: energy=-2143.326
Langevin prior  31/ 40: energy=-2145.798
Langevin prior  36/ 40: energy=-2108.929
Langevin prior  40/ 40: energy=-2147.841
batch/max_batch/ep:   600/  1402/    16 rec:   49.975 mi: 2.22234797 zkl:  109.903 cd:  -10.329 pos_prob:   57.994 prob_neg:   68.323 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    16 rec:   40.769 mi: 2.23428655 zkl:   99.992 cd:   -5.348 pos_prob:   64.343 prob_neg:   69.692 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    16 rec:   50.438 mi: 2.24397898 zkl:  106.204 cd:  -10.882 pos_prob:   60.707 prob_neg:   71.588 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    16 rec:   53.020 mi: 2.22070551 zkl:  104.694 cd:   -8.487 pos_prob:   62.436 prob_neg:   70.923 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    16 rec:   55.275 mi: 2.12753296 zkl:  104.579 cd:   -3.956 pos_prob:   67.252 prob_neg:   71.207 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-312.471
Langevin prior   6/ 40: energy=-1125.887
Langevin prior  11/ 40: energy=-1779.582
Langevin prior  16/ 40: energy=-1950.181
Langevin prior  21/ 40: energy=-1979.076
Langevin prior  26/ 40: energy=-2031.098
Langevin prior  31/ 40: energy=-2144.447
Langevin prior  36/ 40: energy=-2167.531
Langevin prior  40/ 40: energy=-2223.224
batch/max_batch/ep:  1100/  1402/    16 rec:   43.894 mi: 2.10341239 zkl:   83.286 cd:  -13.898 pos_prob:   57.620 prob_neg:   71.519 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    16 rec:   54.205 mi: 2.40229917 zkl:   94.025 cd:   -3.664 pos_prob:   63.123 prob_neg:   66.787 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    16 rec:   66.605 mi: 2.31761312 zkl:   93.694 cd:   -0.027 pos_prob:   66.333 prob_neg:   66.360 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    16 rec:   45.566 mi: 2.39917207 zkl:   79.118 cd:  -10.485 pos_prob:   58.010 prob_neg:   68.495 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-016-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.24, 42.9/13.7/6.2/3.5 (BP=0.961, ratio=0.962, hyp_len=74208, ref_len=77177)
--- bleu: BLEU = 10.24, 42.9/13.7/6.2/3.5 (BP=0.961, ratio=0.962, hyp_len=74208, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    17 rec:   53.629 mi: 2.41196799 zkl:   88.609 cd:   -3.615 pos_prob:   64.118 prob_neg:   67.734 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    17 rec:   54.973 mi: 2.20644784 zkl:   89.769 cd:   -3.983 pos_prob:   66.348 prob_neg:   70.331 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    17 rec:   50.174 mi: 2.15700078 zkl:   80.875 cd:   -9.290 pos_prob:   65.001 prob_neg:   74.291 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    17 rec:   53.945 mi: 2.41188502 zkl:   82.055 cd:  -10.492 pos_prob:   62.111 prob_neg:   72.603 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    17 rec:   61.158 mi: 2.31032610 zkl:   72.702 cd:   -5.822 pos_prob:   61.161 prob_neg:   66.983 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-296.217
Langevin prior   6/ 40: energy=-1085.082
Langevin prior  11/ 40: energy=-1670.375
Langevin prior  16/ 40: energy=-1866.041
Langevin prior  21/ 40: energy=-1999.272
Langevin prior  26/ 40: energy=-2051.940
Langevin prior  31/ 40: energy=-2038.984
Langevin prior  36/ 40: energy=-2040.438
Langevin prior  40/ 40: energy=-2080.218
batch/max_batch/ep:   600/  1402/    17 rec:   62.845 mi: 2.17059875 zkl:   75.429 cd:   -4.375 pos_prob:   64.882 prob_neg:   69.257 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    17 rec:   67.872 mi: 2.29135704 zkl:   70.349 cd:   -8.653 pos_prob:   60.194 prob_neg:   68.847 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    17 rec:   63.056 mi: 2.31962967 zkl:   83.475 cd:    1.295 pos_prob:   69.160 prob_neg:   67.865 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    17 rec:   53.046 mi: 2.43082881 zkl:   77.812 cd:   -3.534 pos_prob:   65.660 prob_neg:   69.194 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    17 rec:   73.223 mi: 2.36360240 zkl:   79.694 cd:   -4.557 pos_prob:   64.124 prob_neg:   68.681 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-273.233
Langevin prior   6/ 40: energy=-1108.309
Langevin prior  11/ 40: energy=-1616.580
Langevin prior  16/ 40: energy=-1846.916
Langevin prior  21/ 40: energy=-1990.692
Langevin prior  26/ 40: energy=-2074.546
Langevin prior  31/ 40: energy=-2065.844
Langevin prior  36/ 40: energy=-2044.405
Langevin prior  40/ 40: energy=-2039.624
batch/max_batch/ep:  1100/  1402/    17 rec:   55.269 mi: 2.45383358 zkl:   69.252 cd:   -4.763 pos_prob:   62.455 prob_neg:   67.218 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    17 rec:   55.567 mi: 2.31028843 zkl:   75.514 cd:    1.675 pos_prob:   66.118 prob_neg:   64.443 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    17 rec:   71.650 mi: 2.25928092 zkl:   72.844 cd:   -7.405 pos_prob:   61.714 prob_neg:   69.119 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    17 rec:   60.117 mi: 2.30847955 zkl:   73.244 cd:   -5.348 pos_prob:   63.350 prob_neg:   68.698 kl_weight:    0.500 do_ae_train: False
200 done. -75.27253630577161
400 done. -80.76335789537457
600 done. -81.49309294840889
800 done. -81.63686717719
1000 done. -82.8432396937991
1200 done. -84.06237081593801
1400 done. -85.15094246760758
1600 done. -84.56095692067746
1800 done. -82.88410022923786
2000 done. -80.51632371605122
2200 done. -79.74047180020283
2400 done. -78.95490435111974
2600 done. -79.2362850871578
2800 done. -79.19845206466404
3000 done. -79.46336607276464
3200 done. -79.93005084417446
3400 done. -80.12351798335845
3600 done. -80.75380004428901
Negative Log-likehood -81.294468
log-likelihood:    -81.294
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-017-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-017-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.60, 43.3/13.5/6.1/3.4 (BP=0.913, ratio=0.917, hyp_len=70751, ref_len=77177)
--- bleu: BLEU = 9.60, 43.3/13.5/6.1/3.4 (BP=0.913, ratio=0.917, hyp_len=70751, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    18 rec:   58.468 mi: 2.36343861 zkl:   77.310 cd:   -6.629 pos_prob:   59.486 prob_neg:   66.115 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    18 rec:   66.169 mi: 2.19357586 zkl:   66.514 cd:  -11.286 pos_prob:   56.830 prob_neg:   68.116 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    18 rec:   53.750 mi: 2.43156528 zkl:   70.737 cd:    2.246 pos_prob:   66.262 prob_neg:   64.016 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    18 rec:   63.344 mi: 2.36808062 zkl:   73.971 cd:   -4.873 pos_prob:   62.817 prob_neg:   67.690 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    18 rec:   60.320 mi: 2.23761654 zkl:   65.790 cd:   -5.977 pos_prob:   64.029 prob_neg:   70.006 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-323.217
Langevin prior   6/ 40: energy=-1099.649
Langevin prior  11/ 40: energy=-1643.534
Langevin prior  16/ 40: energy=-1856.345
Langevin prior  21/ 40: energy=-1960.472
Langevin prior  26/ 40: energy=-1933.236
Langevin prior  31/ 40: energy=-2022.615
Langevin prior  36/ 40: energy=-1983.500
Langevin prior  40/ 40: energy=-2042.988
batch/max_batch/ep:   600/  1402/    18 rec:   65.879 mi: 2.40773892 zkl:   68.855 cd:   -6.470 pos_prob:   64.009 prob_neg:   70.479 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    18 rec:   60.028 mi: 2.35679317 zkl:   69.993 cd:    1.289 pos_prob:   67.757 prob_neg:   66.468 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    18 rec:   49.451 mi: 2.34830070 zkl:   65.940 cd:   -6.175 pos_prob:   60.807 prob_neg:   66.982 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    18 rec:   66.059 mi: 2.33701253 zkl:   71.688 cd:  -10.363 pos_prob:   59.417 prob_neg:   69.780 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    18 rec:   56.281 mi: 2.29454088 zkl:   68.007 cd:  -11.363 pos_prob:   59.529 prob_neg:   70.892 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-300.408
Langevin prior   6/ 40: energy=-1088.019
Langevin prior  11/ 40: energy=-1538.558
Langevin prior  16/ 40: energy=-1797.877
Langevin prior  21/ 40: energy=-1929.266
Langevin prior  26/ 40: energy=-1932.531
Langevin prior  31/ 40: energy=-1983.901
Langevin prior  36/ 40: energy=-2030.100
Langevin prior  40/ 40: energy=-2095.047
batch/max_batch/ep:  1100/  1402/    18 rec:   58.267 mi: 2.35095787 zkl:   72.580 cd:   -4.537 pos_prob:   65.350 prob_neg:   69.887 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    18 rec:   57.614 mi: 2.27594757 zkl:   74.736 cd:   -0.891 pos_prob:   68.824 prob_neg:   69.715 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    18 rec:   67.833 mi: 2.27897334 zkl:   71.586 cd:   -2.263 pos_prob:   66.078 prob_neg:   68.341 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    18 rec:   50.369 mi: 2.20732403 zkl:   59.028 cd:   -5.466 pos_prob:   60.706 prob_neg:   66.172 kl_weight:    0.500 do_ae_train: False
200 done. -74.95166641140594
400 done. -80.47116612801439
600 done. -81.52864821221158
800 done. -81.75434108186886
1000 done. -83.05992943745174
1200 done. -84.22915601134517
1400 done. -85.29845180667148
1600 done. -84.6836448090833
1800 done. -83.02585521359777
2000 done. -80.64748106936128
2200 done. -79.7864471546428
2400 done. -78.97701795825917
2600 done. -79.22000757767316
2800 done. -79.1678782455088
3000 done. -79.42488699721125
3200 done. -79.87894754375048
3400 done. -80.08638502992771
3600 done. -80.74131016872032
Negative Log-likehood -81.301438
log-likelihood:    -81.301
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-018-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-018-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.39, 42.4/13.1/5.7/3.1 (BP=0.940, ratio=0.942, hyp_len=72684, ref_len=77177)
--- bleu: BLEU = 9.39, 42.4/13.1/5.7/3.1 (BP=0.940, ratio=0.942, hyp_len=72684, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    19 rec:   56.937 mi: 2.28795552 zkl:  162.910 cd:  -18.519 pos_prob:   52.770 prob_neg:   71.289 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    19 rec:   40.992 mi: 2.32984543 zkl:  179.015 cd:  -15.182 pos_prob:   50.551 prob_neg:   65.733 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    19 rec:   35.117 mi: 2.33053327 zkl:  179.296 cd:  -26.993 pos_prob:   41.298 prob_neg:   68.290 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    19 rec:   59.593 mi: 2.31449580 zkl:  182.488 cd:  -26.978 pos_prob:   38.225 prob_neg:   65.204 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    19 rec:   47.700 mi: 2.37316751 zkl:  183.719 cd:  -34.148 pos_prob:   32.952 prob_neg:   67.099 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-270.988
Langevin prior   6/ 40: energy=-1021.560
Langevin prior  11/ 40: energy=-1582.602
Langevin prior  16/ 40: energy=-1846.728
Langevin prior  21/ 40: energy=-1925.585
Langevin prior  26/ 40: energy=-1991.409
Langevin prior  31/ 40: energy=-2040.665
Langevin prior  36/ 40: energy=-1950.181
Langevin prior  40/ 40: energy=-2007.960
batch/max_batch/ep:   600/  1402/    19 rec:   56.415 mi: 2.26354957 zkl:  183.025 cd:  -34.803 pos_prob:   33.093 prob_neg:   67.896 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    19 rec:   55.513 mi: 2.30023885 zkl:  186.940 cd:  -27.462 pos_prob:   37.968 prob_neg:   65.430 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    19 rec:   59.137 mi: 2.21448302 zkl:  188.305 cd:  -31.206 pos_prob:   37.740 prob_neg:   68.946 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    19 rec:   39.880 mi: 2.16493917 zkl:  186.733 cd:  -33.955 pos_prob:   32.490 prob_neg:   66.444 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    19 rec:   50.694 mi: 2.28662634 zkl:  188.774 cd:  -34.161 pos_prob:   33.324 prob_neg:   67.485 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-348.674
Langevin prior   6/ 40: energy=-1114.229
Langevin prior  11/ 40: energy=-1540.748
Langevin prior  16/ 40: energy=-1844.314
Langevin prior  21/ 40: energy=-1868.447
Langevin prior  26/ 40: energy=-1924.021
Langevin prior  31/ 40: energy=-1946.496
Langevin prior  36/ 40: energy=-1913.402
Langevin prior  40/ 40: energy=-1953.339
batch/max_batch/ep:  1100/  1402/    19 rec:   53.623 mi: 2.39108539 zkl:  190.124 cd:  -34.877 pos_prob:   31.880 prob_neg:   66.757 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    19 rec:   55.768 mi: 2.29102135 zkl:  190.222 cd:  -33.995 pos_prob:   31.781 prob_neg:   65.775 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    19 rec:   51.351 mi: 2.27936149 zkl:  191.549 cd:  -36.469 pos_prob:   31.175 prob_neg:   67.644 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    19 rec:   43.456 mi: 2.35854340 zkl:  192.056 cd:  -36.385 pos_prob:   29.952 prob_neg:   66.337 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-019-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.78, 44.1/14.1/6.5/3.8 (BP=0.967, ratio=0.968, hyp_len=74675, ref_len=77177)
--- bleu: BLEU = 10.78, 44.1/14.1/6.5/3.8 (BP=0.967, ratio=0.968, hyp_len=74675, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    20 rec:   54.134 mi: 2.36233830 zkl:  192.731 cd:  -37.013 pos_prob:   29.729 prob_neg:   66.742 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    20 rec:   33.444 mi: 2.15630150 zkl:  191.443 cd:  -41.672 pos_prob:   26.342 prob_neg:   68.014 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    20 rec:   46.085 mi: 2.38806438 zkl:  195.059 cd:  -34.153 pos_prob:   30.127 prob_neg:   64.280 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    20 rec:   40.798 mi: 2.19794083 zkl:  195.197 cd:  -41.715 pos_prob:   27.166 prob_neg:   68.880 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    20 rec:   46.261 mi: 2.20421791 zkl:  195.867 cd:  -38.362 pos_prob:   30.374 prob_neg:   68.736 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-313.822
Langevin prior   6/ 40: energy=-1108.590
Langevin prior  11/ 40: energy=-1527.425
Langevin prior  16/ 40: energy=-1752.403
Langevin prior  21/ 40: energy=-1915.827
Langevin prior  26/ 40: energy=-1964.192
Langevin prior  31/ 40: energy=-1986.860
Langevin prior  36/ 40: energy=-2021.321
Langevin prior  40/ 40: energy=-1958.827
batch/max_batch/ep:   600/  1402/    20 rec:   48.390 mi: 2.15111494 zkl:  196.151 cd:  -35.314 pos_prob:   27.646 prob_neg:   62.960 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    20 rec:   60.196 mi: 2.14256334 zkl:  198.738 cd:  -44.008 pos_prob:   23.430 prob_neg:   67.439 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    20 rec:   55.291 mi: 2.12484241 zkl:  198.669 cd:  -39.279 pos_prob:   26.391 prob_neg:   65.670 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    20 rec:   50.861 mi: 2.20714593 zkl:  198.629 cd:  -42.128 pos_prob:   26.193 prob_neg:   68.321 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    20 rec:   55.884 mi: 2.22022247 zkl:  203.392 cd:  -36.171 pos_prob:   29.504 prob_neg:   65.674 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-266.713
Langevin prior   6/ 40: energy=-1055.286
Langevin prior  11/ 40: energy=-1477.671
Langevin prior  16/ 40: energy=-1719.916
Langevin prior  21/ 40: energy=-1898.438
Langevin prior  26/ 40: energy=-1968.032
Langevin prior  31/ 40: energy=-1983.687
Langevin prior  36/ 40: energy=-1932.260
Langevin prior  40/ 40: energy=-1929.413
batch/max_batch/ep:  1100/  1402/    20 rec:   49.567 mi: 2.14865327 zkl:  197.820 cd:  -43.010 pos_prob:   24.045 prob_neg:   67.055 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    20 rec:   43.616 mi: 2.12179685 zkl:  198.730 cd:  -44.266 pos_prob:   24.251 prob_neg:   68.516 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    20 rec:   47.713 mi: 2.27591968 zkl:  200.590 cd:  -38.936 pos_prob:   25.634 prob_neg:   64.571 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    20 rec:   39.100 mi: 2.21474791 zkl:  198.936 cd:  -41.966 pos_prob:   25.158 prob_neg:   67.124 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-020-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.63, 44.4/14.2/6.7/3.9 (BP=0.939, ratio=0.941, hyp_len=72637, ref_len=77177)
--- bleu: BLEU = 10.63, 44.4/14.2/6.7/3.9 (BP=0.939, ratio=0.941, hyp_len=72637, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    21 rec:   35.638 mi: 2.12556458 zkl:  198.027 cd:  -45.614 pos_prob:   21.215 prob_neg:   66.829 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    21 rec:   43.309 mi: 2.00565052 zkl:  203.597 cd:  -41.361 pos_prob:   25.848 prob_neg:   67.208 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    21 rec:   34.365 mi: 1.96757913 zkl:  200.136 cd:  -43.006 pos_prob:   25.181 prob_neg:   68.187 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    21 rec:   48.091 mi: 2.07953119 zkl:  203.149 cd:  -40.342 pos_prob:   25.796 prob_neg:   66.138 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    21 rec:   47.806 mi: 2.16496181 zkl:  201.890 cd:  -42.333 pos_prob:   23.263 prob_neg:   65.596 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-283.120
Langevin prior   6/ 40: energy=-1079.853
Langevin prior  11/ 40: energy=-1572.294
Langevin prior  16/ 40: energy=-1841.631
Langevin prior  21/ 40: energy=-1949.135
Langevin prior  26/ 40: energy=-1978.891
Langevin prior  31/ 40: energy=-2015.943
Langevin prior  36/ 40: energy=-1983.862
Langevin prior  40/ 40: energy=-2007.270
batch/max_batch/ep:   600/  1402/    21 rec:   38.159 mi: 2.22894311 zkl:  202.105 cd:  -46.135 pos_prob:   22.524 prob_neg:   68.659 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    21 rec:   37.164 mi: 2.11482716 zkl:  202.703 cd:  -42.406 pos_prob:   22.700 prob_neg:   65.105 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    21 rec:   49.080 mi: 2.21511126 zkl:  206.144 cd:  -44.792 pos_prob:   25.000 prob_neg:   69.792 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    21 rec:   45.429 mi: 2.04359651 zkl:  205.552 cd:  -47.667 pos_prob:   21.070 prob_neg:   68.737 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    21 rec:   47.678 mi: 2.22689080 zkl:  206.240 cd:  -39.000 pos_prob:   26.608 prob_neg:   65.608 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-280.571
Langevin prior   6/ 40: energy=-1034.712
Langevin prior  11/ 40: energy=-1496.168
Langevin prior  16/ 40: energy=-1787.665
Langevin prior  21/ 40: energy=-1919.212
Langevin prior  26/ 40: energy=-1972.969
Langevin prior  31/ 40: energy=-1963.478
Langevin prior  36/ 40: energy=-1954.141
Langevin prior  40/ 40: energy=-1963.670
batch/max_batch/ep:  1100/  1402/    21 rec:   39.132 mi: 2.11871004 zkl:  205.014 cd:  -44.603 pos_prob:   23.326 prob_neg:   67.929 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    21 rec:   42.398 mi: 2.04732108 zkl:  203.885 cd:  -44.322 pos_prob:   22.947 prob_neg:   67.269 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    21 rec:   40.614 mi: 2.27534175 zkl:  206.475 cd:  -41.212 pos_prob:   24.501 prob_neg:   65.713 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    21 rec:   46.091 mi: 2.21491075 zkl:  209.395 cd:  -40.238 pos_prob:   25.168 prob_neg:   65.407 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-021-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.92, 43.8/13.9/6.5/3.8 (BP=0.982, ratio=0.983, hyp_len=75828, ref_len=77177)
--- bleu: BLEU = 10.92, 43.8/13.9/6.5/3.8 (BP=0.982, ratio=0.983, hyp_len=75828, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    22 rec:   40.671 mi: 2.02017331 zkl:  143.131 cd:  -39.665 pos_prob:   40.276 prob_neg:   79.941 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    22 rec:   46.227 mi: 2.14339542 zkl:  122.837 cd:  -29.647 pos_prob:   50.464 prob_neg:   80.112 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    22 rec:   51.559 mi: 2.12738681 zkl:  118.321 cd:  -24.023 pos_prob:   58.860 prob_neg:   82.883 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    22 rec:   44.050 mi: 1.99027598 zkl:  114.293 cd:  -11.767 pos_prob:   65.240 prob_neg:   77.008 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    22 rec:   43.239 mi: 2.42068672 zkl:  114.353 cd:  -18.358 pos_prob:   62.754 prob_neg:   81.112 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-358.355
Langevin prior   6/ 40: energy=-1349.772
Langevin prior  11/ 40: energy=-1873.404
Langevin prior  16/ 40: energy=-2201.907
Langevin prior  21/ 40: energy=-2260.495
Langevin prior  26/ 40: energy=-2365.268
Langevin prior  31/ 40: energy=-2359.359
Langevin prior  36/ 40: energy=-2379.697
Langevin prior  40/ 40: energy=-2328.511
batch/max_batch/ep:   600/  1402/    22 rec:   50.069 mi: 2.48669696 zkl:  107.766 cd:  -15.111 pos_prob:   69.980 prob_neg:   85.091 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    22 rec:   49.724 mi: 2.40986371 zkl:  115.153 cd:   -9.682 pos_prob:   76.273 prob_neg:   85.954 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    22 rec:   55.488 mi: 2.54509044 zkl:  108.087 cd:  -14.757 pos_prob:   71.175 prob_neg:   85.932 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    22 rec:   45.612 mi: 2.40832162 zkl:  103.583 cd:   -7.080 pos_prob:   75.092 prob_neg:   82.172 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    22 rec:   45.969 mi: 2.34788895 zkl:   96.448 cd:  -13.366 pos_prob:   71.678 prob_neg:   85.044 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-358.707
Langevin prior   6/ 40: energy=-1234.855
Langevin prior  11/ 40: energy=-2013.672
Langevin prior  16/ 40: energy=-2291.201
Langevin prior  21/ 40: energy=-2415.337
Langevin prior  26/ 40: energy=-2473.272
Langevin prior  31/ 40: energy=-2496.236
Langevin prior  36/ 40: energy=-2473.839
Langevin prior  40/ 40: energy=-2509.565
batch/max_batch/ep:  1100/  1402/    22 rec:   46.208 mi: 2.48962259 zkl:   98.931 cd:   -5.433 pos_prob:   80.084 prob_neg:   85.517 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    22 rec:   54.609 mi: 2.48626161 zkl:  107.814 cd:    1.600 pos_prob:   84.819 prob_neg:   83.220 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    22 rec:   55.635 mi: 2.37703609 zkl:  107.065 cd:   -2.991 pos_prob:   81.773 prob_neg:   84.765 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    22 rec:   57.163 mi: 2.43007350 zkl:   93.401 cd:  -12.986 pos_prob:   70.080 prob_neg:   83.066 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-022-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.11, 43.8/13.9/6.4/3.7 (BP=0.925, ratio=0.928, hyp_len=71582, ref_len=77177)
--- bleu: BLEU = 10.11, 43.8/13.9/6.4/3.7 (BP=0.925, ratio=0.928, hyp_len=71582, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    23 rec:   45.456 mi: 2.28241372 zkl:  105.345 cd:   15.293 pos_prob:   92.485 prob_neg:   77.191 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    23 rec:   53.449 mi: 2.38308477 zkl:   88.763 cd:   -2.707 pos_prob:   81.337 prob_neg:   84.044 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    23 rec:   56.755 mi: 2.39932823 zkl:   86.841 cd:   -6.083 pos_prob:   79.946 prob_neg:   86.029 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    23 rec:   44.272 mi: 2.22189188 zkl:   84.189 cd:   -6.494 pos_prob:   79.806 prob_neg:   86.300 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    23 rec:   58.943 mi: 2.40411139 zkl:   89.034 cd:   -6.587 pos_prob:   78.547 prob_neg:   85.134 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-353.489
Langevin prior   6/ 40: energy=-1354.467
Langevin prior  11/ 40: energy=-1985.219
Langevin prior  16/ 40: energy=-2246.352
Langevin prior  21/ 40: energy=-2404.176
Langevin prior  26/ 40: energy=-2525.298
Langevin prior  31/ 40: energy=-2564.752
Langevin prior  36/ 40: energy=-2565.054
Langevin prior  40/ 40: energy=-2565.855
batch/max_batch/ep:   600/  1402/    23 rec:   60.339 mi: 2.36544466 zkl:   86.513 cd:   -8.850 pos_prob:   74.813 prob_neg:   83.663 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    23 rec:   53.559 mi: 2.67682076 zkl:   80.076 cd:   -2.763 pos_prob:   79.404 prob_neg:   82.167 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    23 rec:   49.501 mi: 2.46858644 zkl:   80.204 cd:   -2.584 pos_prob:   79.996 prob_neg:   82.580 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    23 rec:   46.239 mi: 2.35077882 zkl:   76.295 cd:   -7.929 pos_prob:   72.924 prob_neg:   80.853 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    23 rec:   59.887 mi: 2.29969597 zkl:   89.329 cd:   11.101 pos_prob:   89.494 prob_neg:   78.393 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-288.588
Langevin prior   6/ 40: energy=-1149.275
Langevin prior  11/ 40: energy=-1771.982
Langevin prior  16/ 40: energy=-2072.552
Langevin prior  21/ 40: energy=-2278.872
Langevin prior  26/ 40: energy=-2377.367
Langevin prior  31/ 40: energy=-2402.800
Langevin prior  36/ 40: energy=-2510.617
Langevin prior  40/ 40: energy=-2546.965
batch/max_batch/ep:  1100/  1402/    23 rec:   58.122 mi: 2.20917559 zkl:   83.236 cd:   -0.798 pos_prob:   78.066 prob_neg:   78.864 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    23 rec:   50.900 mi: 2.47773051 zkl:   78.712 cd:   -2.755 pos_prob:   76.892 prob_neg:   79.647 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    23 rec:   54.268 mi: 2.39801574 zkl:   76.175 cd:   -8.811 pos_prob:   76.761 prob_neg:   85.572 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    23 rec:   68.003 mi: 2.43577862 zkl:   80.743 cd:   -6.243 pos_prob:   73.281 prob_neg:   79.524 kl_weight:    0.500 do_ae_train: False
200 done. -74.34762242492552
400 done. -80.1636477474017
600 done. -81.27637190632352
800 done. -81.5204769083768
1000 done. -82.99616207094962
1200 done. -84.3228642274707
1400 done. -85.43711569522847
1600 done. -84.86515344747038
1800 done. -83.14834932586955
2000 done. -80.7119081995888
2200 done. -79.8454785975506
2400 done. -79.00802016825656
2600 done. -79.27567439148744
2800 done. -79.24874102448219
3000 done. -79.53158066933823
3200 done. -79.98454278145134
3400 done. -80.17425506800585
3600 done. -80.81521795368656
Negative Log-likehood -81.398424
log-likelihood:    -81.398
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-023-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-023-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.66, 42.6/13.4/5.9/3.2 (BP=0.948, ratio=0.950, hyp_len=73291, ref_len=77177)
--- bleu: BLEU = 9.66, 42.6/13.4/5.9/3.2 (BP=0.948, ratio=0.950, hyp_len=73291, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    24 rec:   52.071 mi: 2.35053873 zkl:   83.701 cd:    1.429 pos_prob:   81.177 prob_neg:   79.748 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    24 rec:   58.271 mi: 2.39798307 zkl:   73.246 cd:   -7.435 pos_prob:   69.300 prob_neg:   76.736 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    24 rec:   65.931 mi: 2.22938323 zkl:   86.750 cd:   -3.681 pos_prob:   71.777 prob_neg:   75.459 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    24 rec:   41.265 mi: 2.32563400 zkl:   77.186 cd:    2.236 pos_prob:   77.390 prob_neg:   75.154 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    24 rec:   62.968 mi: 2.26921296 zkl:   75.340 cd:   -7.098 pos_prob:   70.736 prob_neg:   77.835 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-371.781
Langevin prior   6/ 40: energy=-1330.322
Langevin prior  11/ 40: energy=-1882.378
Langevin prior  16/ 40: energy=-2091.267
Langevin prior  21/ 40: energy=-2324.402
Langevin prior  26/ 40: energy=-2361.824
Langevin prior  31/ 40: energy=-2380.817
Langevin prior  36/ 40: energy=-2418.796
Langevin prior  40/ 40: energy=-2459.732
batch/max_batch/ep:   600/  1402/    24 rec:   61.213 mi: 2.31147313 zkl:   71.167 cd:  -13.448 pos_prob:   67.914 prob_neg:   81.363 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    24 rec:   54.472 mi: 2.43120766 zkl:   77.094 cd:   -5.174 pos_prob:   75.318 prob_neg:   80.491 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    24 rec:   57.033 mi: 2.31102371 zkl:   75.127 cd:  -12.151 pos_prob:   71.420 prob_neg:   83.571 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    24 rec:   53.582 mi: 2.39517903 zkl:   77.030 cd:   -3.535 pos_prob:   76.133 prob_neg:   79.668 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    24 rec:   50.312 mi: 2.47888923 zkl:   84.033 cd:    0.243 pos_prob:   81.563 prob_neg:   81.319 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-403.009
Langevin prior   6/ 40: energy=-1415.842
Langevin prior  11/ 40: energy=-1911.386
Langevin prior  16/ 40: energy=-2257.595
Langevin prior  21/ 40: energy=-2383.872
Langevin prior  26/ 40: energy=-2418.208
Langevin prior  31/ 40: energy=-2402.175
Langevin prior  36/ 40: energy=-2309.987
Langevin prior  40/ 40: energy=-2357.302
batch/max_batch/ep:  1100/  1402/    24 rec:   64.198 mi: 2.42358708 zkl:   81.701 cd:   -8.480 pos_prob:   73.299 prob_neg:   81.779 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    24 rec:   61.719 mi: 2.55066252 zkl:   74.087 cd:   -5.240 pos_prob:   72.788 prob_neg:   78.028 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    24 rec:   62.319 mi: 2.55481482 zkl:   73.246 cd:  -10.048 pos_prob:   71.338 prob_neg:   81.387 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    24 rec:   63.949 mi: 2.55863333 zkl:   73.825 cd:   -8.609 pos_prob:   67.428 prob_neg:   76.037 kl_weight:    0.500 do_ae_train: False
200 done. -78.37612980834314
400 done. -83.51681597901819
600 done. -84.57600639845526
800 done. -84.71155533581938
1000 done. -86.17800749184353
1200 done. -87.54250046037747
1400 done. -88.62051197852158
1600 done. -88.02721835279284
1800 done. -86.27097891993863
2000 done. -83.85146411336636
2200 done. -82.98161250573692
2400 done. -82.14588639380096
2600 done. -82.3981564028515
2800 done. -82.38031904527692
3000 done. -82.67263560655482
3200 done. -83.13340864032685
3400 done. -83.33273820324239
3600 done. -84.0085601830968
Negative Log-likehood -84.561616
log-likelihood:    -84.562
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-024-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-024-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.54, 42.0/13.1/5.7/3.2 (BP=0.956, ratio=0.957, hyp_len=73832, ref_len=77177)
--- bleu: BLEU = 9.54, 42.0/13.1/5.7/3.2 (BP=0.956, ratio=0.957, hyp_len=73832, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    25 rec:   47.065 mi: 2.54819894 zkl:  190.541 cd:   -9.490 pos_prob:   66.511 prob_neg:   76.001 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    25 rec:   48.649 mi: 2.46804929 zkl:  185.843 cd:  -27.027 pos_prob:   53.889 prob_neg:   80.917 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    25 rec:   53.619 mi: 2.42811298 zkl:  183.929 cd:  -23.678 pos_prob:   52.681 prob_neg:   76.359 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    25 rec:   39.336 mi: 2.48831534 zkl:  182.782 cd:  -28.490 pos_prob:   49.666 prob_neg:   78.156 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    25 rec:   44.083 mi: 2.41029787 zkl:  187.692 cd:  -26.071 pos_prob:   48.662 prob_neg:   74.733 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-323.510
Langevin prior   6/ 40: energy=-1252.293
Langevin prior  11/ 40: energy=-1802.786
Langevin prior  16/ 40: energy=-2095.397
Langevin prior  21/ 40: energy=-2220.714
Langevin prior  26/ 40: energy=-2194.042
Langevin prior  31/ 40: energy=-2242.316
Langevin prior  36/ 40: energy=-2289.251
Langevin prior  40/ 40: energy=-2271.016
batch/max_batch/ep:   600/  1402/    25 rec:   56.352 mi: 2.41503119 zkl:  189.491 cd:  -32.217 pos_prob:   47.990 prob_neg:   80.208 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    25 rec:   47.114 mi: 2.46481442 zkl:  186.834 cd:  -38.243 pos_prob:   42.661 prob_neg:   80.904 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    25 rec:   49.994 mi: 2.17679405 zkl:  188.178 cd:  -34.285 pos_prob:   44.276 prob_neg:   78.561 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    25 rec:   41.624 mi: 2.17121172 zkl:  184.960 cd:  -41.022 pos_prob:   39.308 prob_neg:   80.329 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    25 rec:   43.332 mi: 2.41337466 zkl:  185.115 cd:  -38.693 pos_prob:   35.409 prob_neg:   74.102 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-299.550
Langevin prior   6/ 40: energy=-1233.891
Langevin prior  11/ 40: energy=-1829.368
Langevin prior  16/ 40: energy=-2096.204
Langevin prior  21/ 40: energy=-2166.535
Langevin prior  26/ 40: energy=-2149.080
Langevin prior  31/ 40: energy=-2243.817
Langevin prior  36/ 40: energy=-2292.379
Langevin prior  40/ 40: energy=-2315.882
batch/max_batch/ep:  1100/  1402/    25 rec:   45.700 mi: 2.41555119 zkl:  187.441 cd:  -40.403 pos_prob:   36.138 prob_neg:   76.541 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    25 rec:   37.140 mi: 2.43868017 zkl:  186.982 cd:  -35.065 pos_prob:   37.528 prob_neg:   72.594 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    25 rec:   39.473 mi: 2.20129871 zkl:  188.187 cd:  -43.129 pos_prob:   39.153 prob_neg:   82.282 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    25 rec:   53.248 mi: 2.54472613 zkl:  188.727 cd:  -41.806 pos_prob:   34.729 prob_neg:   76.535 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-025-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.82, 44.5/14.2/6.7/3.9 (BP=0.955, ratio=0.956, hyp_len=73798, ref_len=77177)
--- bleu: BLEU = 10.82, 44.5/14.2/6.7/3.9 (BP=0.955, ratio=0.956, hyp_len=73798, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    26 rec:   41.671 mi: 2.53378510 zkl:  188.017 cd:  -42.925 pos_prob:   35.910 prob_neg:   78.835 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    26 rec:   42.496 mi: 2.37133336 zkl:  190.353 cd:  -43.344 pos_prob:   33.491 prob_neg:   76.835 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    26 rec:   43.207 mi: 2.44537973 zkl:  191.292 cd:  -45.749 pos_prob:   34.419 prob_neg:   80.169 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    26 rec:   41.602 mi: 2.39972496 zkl:  190.758 cd:  -44.038 pos_prob:   33.311 prob_neg:   77.348 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    26 rec:   40.721 mi: 2.37266564 zkl:  192.663 cd:  -37.830 pos_prob:   33.760 prob_neg:   71.590 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-328.252
Langevin prior   6/ 40: energy=-1326.784
Langevin prior  11/ 40: energy=-1918.770
Langevin prior  16/ 40: energy=-2216.699
Langevin prior  21/ 40: energy=-2298.385
Langevin prior  26/ 40: energy=-2426.940
Langevin prior  31/ 40: energy=-2426.474
Langevin prior  36/ 40: energy=-2473.455
Langevin prior  40/ 40: energy=-2493.109
batch/max_batch/ep:   600/  1402/    26 rec:   40.369 mi: 2.26357388 zkl:  193.360 cd:  -44.640 pos_prob:   34.229 prob_neg:   78.869 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    26 rec:   46.681 mi: 2.61715269 zkl:  192.975 cd:  -45.587 pos_prob:   34.072 prob_neg:   79.659 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    26 rec:   52.230 mi: 2.26141977 zkl:  194.479 cd:  -45.822 pos_prob:   30.230 prob_neg:   76.052 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    26 rec:   44.368 mi: 2.29044032 zkl:  193.879 cd:  -44.239 pos_prob:   32.063 prob_neg:   76.302 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    26 rec:   40.281 mi: 2.18681383 zkl:  193.954 cd:  -48.966 pos_prob:   30.209 prob_neg:   79.175 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-335.903
Langevin prior   6/ 40: energy=-1310.948
Langevin prior  11/ 40: energy=-1871.292
Langevin prior  16/ 40: energy=-2104.135
Langevin prior  21/ 40: energy=-2185.070
Langevin prior  26/ 40: energy=-2194.439
Langevin prior  31/ 40: energy=-2314.940
Langevin prior  36/ 40: energy=-2368.383
Langevin prior  40/ 40: energy=-2384.245
batch/max_batch/ep:  1100/  1402/    26 rec:   37.501 mi: 2.30353069 zkl:  195.675 cd:  -47.169 pos_prob:   33.554 prob_neg:   80.723 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    26 rec:   47.802 mi: 2.38028622 zkl:  194.983 cd:  -46.733 pos_prob:   30.732 prob_neg:   77.465 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    26 rec:   33.478 mi: 2.42363024 zkl:  194.969 cd:  -47.923 pos_prob:   30.913 prob_neg:   78.837 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    26 rec:   44.572 mi: 2.33800650 zkl:  195.967 cd:  -50.001 pos_prob:   28.328 prob_neg:   78.330 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-026-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.95, 43.5/14.1/6.6/3.9 (BP=0.978, ratio=0.978, hyp_len=75481, ref_len=77177)
--- bleu: BLEU = 10.95, 43.5/14.1/6.6/3.9 (BP=0.978, ratio=0.978, hyp_len=75481, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    27 rec:   39.692 mi: 2.22832537 zkl:  198.081 cd:  -48.707 pos_prob:   28.413 prob_neg:   77.121 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    27 rec:   40.260 mi: 2.37491035 zkl:  198.109 cd:  -45.112 pos_prob:   32.876 prob_neg:   77.988 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    27 rec:   46.711 mi: 2.50427771 zkl:  200.688 cd:  -43.622 pos_prob:   30.292 prob_neg:   73.914 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    27 rec:   38.109 mi: 2.15334702 zkl:  199.893 cd:  -49.628 pos_prob:   27.913 prob_neg:   77.540 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    27 rec:   42.787 mi: 2.36338353 zkl:  201.090 cd:  -49.833 pos_prob:   26.843 prob_neg:   76.676 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-408.984
Langevin prior   6/ 40: energy=-1323.040
Langevin prior  11/ 40: energy=-1792.236
Langevin prior  16/ 40: energy=-1969.010
Langevin prior  21/ 40: energy=-2148.571
Langevin prior  26/ 40: energy=-2189.535
Langevin prior  31/ 40: energy=-2246.352
Langevin prior  36/ 40: energy=-2270.617
Langevin prior  40/ 40: energy=-2230.396
batch/max_batch/ep:   600/  1402/    27 rec:   35.706 mi: 2.35050726 zkl:  200.586 cd:  -48.743 pos_prob:   31.406 prob_neg:   80.149 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    27 rec:   36.686 mi: 2.17184711 zkl:  200.799 cd:  -50.203 pos_prob:   27.560 prob_neg:   77.763 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    27 rec:   34.001 mi: 2.24681234 zkl:  201.980 cd:  -50.882 pos_prob:   26.026 prob_neg:   76.908 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    27 rec:   44.123 mi: 2.37753582 zkl:  200.719 cd:  -51.015 pos_prob:   26.837 prob_neg:   77.853 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    27 rec:   44.302 mi: 2.34459758 zkl:  203.966 cd:  -51.046 pos_prob:   26.534 prob_neg:   77.580 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-396.527
Langevin prior   6/ 40: energy=-1319.511
Langevin prior  11/ 40: energy=-1824.111
Langevin prior  16/ 40: energy=-2135.645
Langevin prior  21/ 40: energy=-2294.086
Langevin prior  26/ 40: energy=-2371.307
Langevin prior  31/ 40: energy=-2384.058
Langevin prior  36/ 40: energy=-2339.841
Langevin prior  40/ 40: energy=-2396.085
batch/max_batch/ep:  1100/  1402/    27 rec:   40.712 mi: 2.41500521 zkl:  203.440 cd:  -44.596 pos_prob:   30.423 prob_neg:   75.018 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    27 rec:   44.673 mi: 2.36040974 zkl:  204.873 cd:  -45.757 pos_prob:   29.242 prob_neg:   74.999 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    27 rec:   40.791 mi: 2.42657709 zkl:  206.018 cd:  -51.291 pos_prob:   28.049 prob_neg:   79.340 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    27 rec:   42.812 mi: 2.38925552 zkl:  205.297 cd:  -51.142 pos_prob:   28.501 prob_neg:   79.643 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-027-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.13, 44.2/14.2/6.8/4.0 (BP=0.971, ratio=0.971, hyp_len=74957, ref_len=77177)
--- bleu: BLEU = 11.13, 44.2/14.2/6.8/4.0 (BP=0.971, ratio=0.971, hyp_len=74957, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    28 rec:   44.528 mi: 2.38490033 zkl:  148.101 cd:  -40.769 pos_prob:   51.149 prob_neg:   91.917 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    28 rec:   51.533 mi: 2.43661118 zkl:  123.529 cd:  -41.914 pos_prob:   51.748 prob_neg:   93.662 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    28 rec:   29.304 mi: 2.59735203 zkl:  112.058 cd:  -31.009 pos_prob:   63.559 prob_neg:   94.568 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    28 rec:   39.851 mi: 2.26907253 zkl:  111.711 cd:  -28.901 pos_prob:   60.631 prob_neg:   89.532 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    28 rec:   33.425 mi: 2.53889799 zkl:  105.606 cd:  -26.622 pos_prob:   71.371 prob_neg:   97.993 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-311.228
Langevin prior   6/ 40: energy=-1508.884
Langevin prior  11/ 40: energy=-2125.033
Langevin prior  16/ 40: energy=-2430.424
Langevin prior  21/ 40: energy=-2600.100
Langevin prior  26/ 40: energy=-2715.753
Langevin prior  31/ 40: energy=-2662.166
Langevin prior  36/ 40: energy=-2690.423
Langevin prior  40/ 40: energy=-2653.142
batch/max_batch/ep:   600/  1402/    28 rec:   52.652 mi: 2.63209128 zkl:  109.272 cd:  -21.792 pos_prob:   71.126 prob_neg:   92.918 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    28 rec:   50.571 mi: 2.74258757 zkl:  101.259 cd:  -26.781 pos_prob:   71.560 prob_neg:   98.341 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    28 rec:   36.174 mi: 2.24325371 zkl:  110.802 cd:  -10.838 pos_prob:   80.503 prob_neg:   91.341 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    28 rec:   44.617 mi: 2.51835799 zkl:  102.720 cd:  -14.409 pos_prob:   76.777 prob_neg:   91.187 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    28 rec:   42.366 mi: 2.29644179 zkl:  107.310 cd:   -9.234 pos_prob:   85.036 prob_neg:   94.269 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-365.063
Langevin prior   6/ 40: energy=-1469.123
Langevin prior  11/ 40: energy=-2176.129
Langevin prior  16/ 40: energy=-2578.144
Langevin prior  21/ 40: energy=-2661.173
Langevin prior  26/ 40: energy=-2773.122
Langevin prior  31/ 40: energy=-2836.257
Langevin prior  36/ 40: energy=-2845.879
Langevin prior  40/ 40: energy=-2864.024
batch/max_batch/ep:  1100/  1402/    28 rec:   58.406 mi: 2.25759768 zkl:  103.241 cd:  -13.240 pos_prob:   84.614 prob_neg:   97.854 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    28 rec:   46.203 mi: 2.31332183 zkl:  102.196 cd:   -4.623 pos_prob:   85.279 prob_neg:   89.902 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    28 rec:   59.584 mi: 2.38673735 zkl:   97.238 cd:   -9.181 pos_prob:   78.078 prob_neg:   87.259 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    28 rec:   58.131 mi: 2.36812949 zkl:   94.323 cd:  -10.565 pos_prob:   79.676 prob_neg:   90.241 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-028-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.92, 43.0/13.5/6.1/3.4 (BP=0.946, ratio=0.947, hyp_len=73100, ref_len=77177)
--- bleu: BLEU = 9.92, 43.0/13.5/6.1/3.4 (BP=0.946, ratio=0.947, hyp_len=73100, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    29 rec:   55.941 mi: 2.48503184 zkl:   93.805 cd:   -7.466 pos_prob:   85.203 prob_neg:   92.669 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    29 rec:   47.897 mi: 2.50502181 zkl:   87.956 cd:   -7.894 pos_prob:   81.770 prob_neg:   89.663 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    29 rec:   56.167 mi: 2.62237930 zkl:   90.161 cd:  -11.230 pos_prob:   79.630 prob_neg:   90.860 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    29 rec:   43.104 mi: 2.50258327 zkl:   86.423 cd:   -0.249 pos_prob:   86.289 prob_neg:   86.538 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    29 rec:   53.990 mi: 2.65084815 zkl:   95.523 cd:    2.337 pos_prob:   89.345 prob_neg:   87.009 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-357.165
Langevin prior   6/ 40: energy=-1485.644
Langevin prior  11/ 40: energy=-2189.406
Langevin prior  16/ 40: energy=-2481.969
Langevin prior  21/ 40: energy=-2641.738
Langevin prior  26/ 40: energy=-2651.953
Langevin prior  31/ 40: energy=-2709.154
Langevin prior  36/ 40: energy=-2639.240
Langevin prior  40/ 40: energy=-2682.038
batch/max_batch/ep:   600/  1402/    29 rec:   58.783 mi: 2.54672003 zkl:   77.219 cd:  -12.295 pos_prob:   79.511 prob_neg:   91.805 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    29 rec:   51.707 mi: 2.55881262 zkl:   78.799 cd:  -15.012 pos_prob:   74.191 prob_neg:   89.203 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    29 rec:   62.598 mi: 2.60132909 zkl:   90.655 cd:   -0.427 pos_prob:   86.935 prob_neg:   87.362 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    29 rec:   47.724 mi: 2.57650971 zkl:   84.967 cd:   -0.981 pos_prob:   86.007 prob_neg:   86.989 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    29 rec:   66.746 mi: 2.49958348 zkl:   83.030 cd:   -6.233 pos_prob:   79.012 prob_neg:   85.245 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-334.543
Langevin prior   6/ 40: energy=-1332.906
Langevin prior  11/ 40: energy=-1992.748
Langevin prior  16/ 40: energy=-2319.948
Langevin prior  21/ 40: energy=-2468.386
Langevin prior  26/ 40: energy=-2533.080
Langevin prior  31/ 40: energy=-2606.482
Langevin prior  36/ 40: energy=-2629.122
Langevin prior  40/ 40: energy=-2640.051
batch/max_batch/ep:  1100/  1402/    29 rec:   60.725 mi: 2.48687267 zkl:   84.179 cd:    0.304 pos_prob:   81.358 prob_neg:   81.054 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    29 rec:   61.431 mi: 2.57238936 zkl:   80.092 cd:   -4.154 pos_prob:   79.876 prob_neg:   84.030 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    29 rec:   65.496 mi: 2.54447627 zkl:   80.542 cd:   -4.734 pos_prob:   79.834 prob_neg:   84.568 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    29 rec:   46.219 mi: 2.68584275 zkl:   81.469 cd:   -6.624 pos_prob:   78.009 prob_neg:   84.633 kl_weight:    0.500 do_ae_train: False
200 done. -75.74809680710528
400 done. -81.65478605163199
600 done. -82.9260493341444
800 done. -83.26591980428066
1000 done. -84.71708450382032
1200 done. -86.07516331358994
1400 done. -87.26664628729878
1600 done. -86.64550190025084
1800 done. -84.90904028835985
2000 done. -82.47343355713186
2200 done. -81.5715825885817
2400 done. -80.76660205744707
2600 done. -81.00511316798386
2800 done. -80.97993141721513
3000 done. -81.2498644078612
3200 done. -81.68118802950367
3400 done. -81.88301060614944
3600 done. -82.54720744174216
Negative Log-likehood -83.133383
log-likelihood:    -83.133
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-029-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-029-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.67, 43.2/13.7/6.1/3.4 (BP=0.918, ratio=0.921, hyp_len=71111, ref_len=77177)
--- bleu: BLEU = 9.67, 43.2/13.7/6.1/3.4 (BP=0.918, ratio=0.921, hyp_len=71111, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    30 rec:   67.146 mi: 2.48547554 zkl:   81.513 cd:   -3.412 pos_prob:   83.457 prob_neg:   86.869 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    30 rec:   54.055 mi: 2.46327186 zkl:   82.870 cd:   -7.165 pos_prob:   79.659 prob_neg:   86.824 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    30 rec:   57.840 mi: 2.54244995 zkl:   74.487 cd:   -8.830 pos_prob:   76.664 prob_neg:   85.494 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    30 rec:   58.718 mi: 2.56298733 zkl:   78.019 cd:   -8.031 pos_prob:   82.068 prob_neg:   90.100 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    30 rec:   58.224 mi: 2.51348090 zkl:   91.221 cd:   -0.682 pos_prob:   83.769 prob_neg:   84.451 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-385.732
Langevin prior   6/ 40: energy=-1441.490
Langevin prior  11/ 40: energy=-2016.945
Langevin prior  16/ 40: energy=-2306.724
Langevin prior  21/ 40: energy=-2423.643
Langevin prior  26/ 40: energy=-2523.108
Langevin prior  31/ 40: energy=-2562.921
Langevin prior  36/ 40: energy=-2595.512
Langevin prior  40/ 40: energy=-2602.268
batch/max_batch/ep:   600/  1402/    30 rec:   60.302 mi: 2.56650925 zkl:   79.407 cd:   -6.754 pos_prob:   77.100 prob_neg:   83.855 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    30 rec:   50.958 mi: 2.51898789 zkl:   82.301 cd:   -4.353 pos_prob:   79.757 prob_neg:   84.110 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    30 rec:   60.135 mi: 2.58472610 zkl:   80.646 cd:    3.846 pos_prob:   85.470 prob_neg:   81.623 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    30 rec:   49.519 mi: 2.56692386 zkl:   77.229 cd:   -6.224 pos_prob:   79.440 prob_neg:   85.664 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    30 rec:   59.354 mi: 2.66922235 zkl:   76.384 cd:   -2.119 pos_prob:   80.161 prob_neg:   82.280 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-361.088
Langevin prior   6/ 40: energy=-1311.651
Langevin prior  11/ 40: energy=-1928.486
Langevin prior  16/ 40: energy=-2163.914
Langevin prior  21/ 40: energy=-2277.629
Langevin prior  26/ 40: energy=-2335.326
Langevin prior  31/ 40: energy=-2521.775
Langevin prior  36/ 40: energy=-2516.720
Langevin prior  40/ 40: energy=-2441.779
batch/max_batch/ep:  1100/  1402/    30 rec:   46.339 mi: 2.43071413 zkl:   81.425 cd:    0.874 pos_prob:   83.949 prob_neg:   83.075 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    30 rec:   64.193 mi: 2.63819289 zkl:   84.119 cd:   -6.878 pos_prob:   79.610 prob_neg:   86.487 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    30 rec:   67.228 mi: 2.59258938 zkl:   81.476 cd:   -8.517 pos_prob:   78.157 prob_neg:   86.674 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    30 rec:   50.536 mi: 2.59268999 zkl:   77.093 cd:   -6.655 pos_prob:   81.046 prob_neg:   87.700 kl_weight:    0.500 do_ae_train: False
200 done. -76.68539341127595
400 done. -82.93247565568619
600 done. -83.97030179702294
800 done. -84.18399335416262
1000 done. -85.6692286650193
1200 done. -86.95132102373115
1400 done. -88.05945708995262
1600 done. -87.43710021283242
1800 done. -85.70436442807504
2000 done. -83.18733684678762
2200 done. -82.28784194999415
2400 done. -81.4563285008049
2600 done. -81.68582894557983
2800 done. -81.65200526956487
3000 done. -81.92110968625913
3200 done. -82.38275507853243
3400 done. -82.57488651249551
3600 done. -83.24408893391826
Negative Log-likehood -83.827746
log-likelihood:    -83.828
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-030-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-030-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.39, 43.4/13.5/6.0/3.3 (BP=0.905, ratio=0.909, hyp_len=70170, ref_len=77177)
--- bleu: BLEU = 9.39, 43.4/13.5/6.0/3.3 (BP=0.905, ratio=0.909, hyp_len=70170, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    31 rec:   66.247 mi: 2.55774641 zkl:  184.907 cd:  -18.747 pos_prob:   68.598 prob_neg:   87.345 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    31 rec:   46.367 mi: 2.55663323 zkl:  185.647 cd:  -23.328 pos_prob:   60.378 prob_neg:   83.706 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    31 rec:   47.769 mi: 2.46469498 zkl:  187.549 cd:  -25.717 pos_prob:   58.479 prob_neg:   84.196 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    31 rec:   45.016 mi: 2.41926026 zkl:  188.676 cd:  -30.648 pos_prob:   53.840 prob_neg:   84.488 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    31 rec:   60.269 mi: 2.56019187 zkl:  187.525 cd:  -39.454 pos_prob:   48.464 prob_neg:   87.918 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-311.430
Langevin prior   6/ 40: energy=-1407.371
Langevin prior  11/ 40: energy=-2016.108
Langevin prior  16/ 40: energy=-2385.123
Langevin prior  21/ 40: energy=-2479.251
Langevin prior  26/ 40: energy=-2664.166
Langevin prior  31/ 40: energy=-2598.139
Langevin prior  36/ 40: energy=-2608.101
Langevin prior  40/ 40: energy=-2537.208
batch/max_batch/ep:   600/  1402/    31 rec:   35.627 mi: 2.48419333 zkl:  185.990 cd:  -35.766 pos_prob:   47.064 prob_neg:   82.830 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    31 rec:   47.670 mi: 2.27835417 zkl:  192.308 cd:  -36.108 pos_prob:   49.472 prob_neg:   85.580 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    31 rec:   47.508 mi: 2.35822654 zkl:  189.726 cd:  -39.741 pos_prob:   44.464 prob_neg:   84.205 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    31 rec:   44.963 mi: 2.53490162 zkl:  190.518 cd:  -46.737 pos_prob:   39.935 prob_neg:   86.672 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    31 rec:   47.702 mi: 2.31010914 zkl:  189.373 cd:  -53.607 pos_prob:   39.021 prob_neg:   92.627 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-437.007
Langevin prior   6/ 40: energy=-1571.631
Langevin prior  11/ 40: energy=-2125.125
Langevin prior  16/ 40: energy=-2359.673
Langevin prior  21/ 40: energy=-2436.189
Langevin prior  26/ 40: energy=-2598.600
Langevin prior  31/ 40: energy=-2617.058
Langevin prior  36/ 40: energy=-2598.730
Langevin prior  40/ 40: energy=-2622.489
batch/max_batch/ep:  1100/  1402/    31 rec:   45.717 mi: 2.73369527 zkl:  191.005 cd:  -45.440 pos_prob:   42.037 prob_neg:   87.478 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    31 rec:   39.423 mi: 2.28666067 zkl:  187.844 cd:  -51.319 pos_prob:   37.964 prob_neg:   89.283 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    31 rec:   34.691 mi: 2.45004964 zkl:  188.348 cd:  -47.861 pos_prob:   39.811 prob_neg:   87.672 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    31 rec:   51.228 mi: 2.33677816 zkl:  191.207 cd:  -45.086 pos_prob:   41.246 prob_neg:   86.332 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-031-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.81, 43.9/14.2/6.6/3.8 (BP=0.968, ratio=0.968, hyp_len=74735, ref_len=77177)
--- bleu: BLEU = 10.81, 43.9/14.2/6.6/3.8 (BP=0.968, ratio=0.968, hyp_len=74735, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    32 rec:   45.052 mi: 2.32483387 zkl:  191.420 cd:  -51.677 pos_prob:   37.016 prob_neg:   88.694 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    32 rec:   40.585 mi: 2.53867340 zkl:  192.215 cd:  -47.528 pos_prob:   36.736 prob_neg:   84.263 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    32 rec:   37.295 mi: 2.04247594 zkl:  191.071 cd:  -47.688 pos_prob:   37.474 prob_neg:   85.163 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    32 rec:   36.315 mi: 2.44623947 zkl:  191.530 cd:  -48.287 pos_prob:   34.834 prob_neg:   83.120 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    32 rec:   28.079 mi: 2.42599082 zkl:  192.567 cd:  -49.929 pos_prob:   37.886 prob_neg:   87.814 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-348.108
Langevin prior   6/ 40: energy=-1429.414
Langevin prior  11/ 40: energy=-1983.630
Langevin prior  16/ 40: energy=-2335.094
Langevin prior  21/ 40: energy=-2422.246
Langevin prior  26/ 40: energy=-2574.730
Langevin prior  31/ 40: energy=-2600.288
Langevin prior  36/ 40: energy=-2633.817
Langevin prior  40/ 40: energy=-2641.111
batch/max_batch/ep:   600/  1402/    32 rec:   38.409 mi: 2.46152735 zkl:  195.848 cd:  -49.599 pos_prob:   35.649 prob_neg:   85.248 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    32 rec:   35.649 mi: 2.26848006 zkl:  192.519 cd:  -51.450 pos_prob:   30.800 prob_neg:   82.250 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    32 rec:   39.614 mi: 2.26614022 zkl:  194.147 cd:  -54.468 pos_prob:   30.467 prob_neg:   84.935 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    32 rec:   46.446 mi: 2.40197062 zkl:  196.034 cd:  -55.530 pos_prob:   33.805 prob_neg:   89.336 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    32 rec:   33.123 mi: 2.42625356 zkl:  195.846 cd:  -56.359 pos_prob:   34.551 prob_neg:   90.910 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-353.206
Langevin prior   6/ 40: energy=-1404.187
Langevin prior  11/ 40: energy=-2004.077
Langevin prior  16/ 40: energy=-2367.407
Langevin prior  21/ 40: energy=-2528.552
Langevin prior  26/ 40: energy=-2646.475
Langevin prior  31/ 40: energy=-2568.793
Langevin prior  36/ 40: energy=-2498.306
Langevin prior  40/ 40: energy=-2519.614
batch/max_batch/ep:  1100/  1402/    32 rec:   37.502 mi: 2.30269027 zkl:  197.089 cd:  -46.878 pos_prob:   38.204 prob_neg:   85.082 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    32 rec:   29.484 mi: 2.22487044 zkl:  193.150 cd:  -51.489 pos_prob:   31.580 prob_neg:   83.069 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    32 rec:   35.801 mi: 2.30503750 zkl:  196.613 cd:  -52.317 pos_prob:   35.161 prob_neg:   87.479 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    32 rec:   48.768 mi: 2.33532333 zkl:  197.650 cd:  -49.575 pos_prob:   31.028 prob_neg:   80.603 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-032-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.02, 44.1/14.2/6.8/3.9 (BP=0.968, ratio=0.968, hyp_len=74726, ref_len=77177)
--- bleu: BLEU = 11.02, 44.1/14.2/6.8/3.9 (BP=0.968, ratio=0.968, hyp_len=74726, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    33 rec:   40.677 mi: 2.33976054 zkl:  200.225 cd:  -51.475 pos_prob:   32.447 prob_neg:   83.922 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    33 rec:   31.261 mi: 2.20293450 zkl:  197.640 cd:  -49.861 pos_prob:   34.799 prob_neg:   84.660 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    33 rec:   42.931 mi: 2.37070537 zkl:  200.329 cd:  -56.678 pos_prob:   30.595 prob_neg:   87.272 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    33 rec:   43.220 mi: 2.23747134 zkl:  201.634 cd:  -53.602 pos_prob:   33.605 prob_neg:   87.207 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    33 rec:   29.561 mi: 2.41927528 zkl:  200.325 cd:  -53.924 pos_prob:   33.532 prob_neg:   87.456 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-382.628
Langevin prior   6/ 40: energy=-1467.289
Langevin prior  11/ 40: energy=-2012.949
Langevin prior  16/ 40: energy=-2320.175
Langevin prior  21/ 40: energy=-2459.603
Langevin prior  26/ 40: energy=-2486.889
Langevin prior  31/ 40: energy=-2495.069
Langevin prior  36/ 40: energy=-2487.226
Langevin prior  40/ 40: energy=-2509.647
batch/max_batch/ep:   600/  1402/    33 rec:   36.436 mi: 2.21867847 zkl:  201.438 cd:  -50.686 pos_prob:   28.786 prob_neg:   79.472 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    33 rec:   33.668 mi: 2.28319907 zkl:  201.426 cd:  -52.899 pos_prob:   30.568 prob_neg:   83.467 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    33 rec:   52.715 mi: 2.30318737 zkl:  206.268 cd:  -55.146 pos_prob:   31.286 prob_neg:   86.432 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    33 rec:   45.587 mi: 2.34481049 zkl:  204.143 cd:  -54.732 pos_prob:   33.384 prob_neg:   88.116 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    33 rec:   42.653 mi: 2.51916552 zkl:  204.223 cd:  -50.602 pos_prob:   33.388 prob_neg:   83.990 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-384.513
Langevin prior   6/ 40: energy=-1475.103
Langevin prior  11/ 40: energy=-2042.620
Langevin prior  16/ 40: energy=-2313.831
Langevin prior  21/ 40: energy=-2423.124
Langevin prior  26/ 40: energy=-2411.823
Langevin prior  31/ 40: energy=-2514.495
Langevin prior  36/ 40: energy=-2467.190
Langevin prior  40/ 40: energy=-2572.629
batch/max_batch/ep:  1100/  1402/    33 rec:   37.600 mi: 2.38502336 zkl:  203.601 cd:  -51.699 pos_prob:   30.284 prob_neg:   81.983 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    33 rec:   42.498 mi: 2.28470516 zkl:  205.187 cd:  -49.859 pos_prob:   30.661 prob_neg:   80.520 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    33 rec:   39.495 mi: 2.41602874 zkl:  205.444 cd:  -60.628 pos_prob:   28.233 prob_neg:   88.861 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    33 rec:   46.834 mi: 2.56116533 zkl:  208.235 cd:  -51.556 pos_prob:   31.901 prob_neg:   83.457 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-033-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.06, 43.9/14.2/6.8/4.1 (BP=0.965, ratio=0.966, hyp_len=74534, ref_len=77177)
--- bleu: BLEU = 11.06, 43.9/14.2/6.8/4.1 (BP=0.965, ratio=0.966, hyp_len=74534, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    34 rec:   34.358 mi: 2.40933132 zkl:  144.736 cd:  -43.698 pos_prob:   55.744 prob_neg:   99.443 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    34 rec:   45.204 mi: 2.65435290 zkl:  122.264 cd:  -53.896 pos_prob:   51.418 prob_neg:  105.314 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    34 rec:   55.616 mi: 2.61487889 zkl:  114.526 cd:  -43.524 pos_prob:   62.791 prob_neg:  106.315 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    34 rec:   40.174 mi: 2.39044881 zkl:  108.648 cd:  -29.731 pos_prob:   68.313 prob_neg:   98.044 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    34 rec:   43.764 mi: 2.67639184 zkl:  110.331 cd:  -20.679 pos_prob:   78.415 prob_neg:   99.095 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-419.161
Langevin prior   6/ 40: energy=-1709.340
Langevin prior  11/ 40: energy=-2362.971
Langevin prior  16/ 40: energy=-2735.003
Langevin prior  21/ 40: energy=-2820.061
Langevin prior  26/ 40: energy=-2900.566
Langevin prior  31/ 40: energy=-2891.424
Langevin prior  36/ 40: energy=-3017.956
Langevin prior  40/ 40: energy=-3000.023
batch/max_batch/ep:   600/  1402/    34 rec:   44.701 mi: 2.50188470 zkl:  107.763 cd:  -22.423 pos_prob:   73.789 prob_neg:   96.212 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    34 rec:   40.786 mi: 2.47811604 zkl:  114.173 cd:  -10.454 pos_prob:   89.005 prob_neg:   99.459 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    34 rec:   50.370 mi: 2.42795181 zkl:  108.194 cd:  -10.334 pos_prob:   81.666 prob_neg:   92.000 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    34 rec:   39.492 mi: 2.43835998 zkl:  101.542 cd:  -19.274 pos_prob:   78.020 prob_neg:   97.294 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    34 rec:   51.106 mi: 2.49639678 zkl:  105.066 cd:  -12.365 pos_prob:   77.926 prob_neg:   90.291 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-376.133
Langevin prior   6/ 40: energy=-1630.182
Langevin prior  11/ 40: energy=-2292.556
Langevin prior  16/ 40: energy=-2551.755
Langevin prior  21/ 40: energy=-2776.952
Langevin prior  26/ 40: energy=-2932.736
Langevin prior  31/ 40: energy=-2985.682
Langevin prior  36/ 40: energy=-2937.687
Langevin prior  40/ 40: energy=-2846.793
batch/max_batch/ep:  1100/  1402/    34 rec:   47.374 mi: 2.54978108 zkl:   89.017 cd:  -14.629 pos_prob:   74.779 prob_neg:   89.408 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    34 rec:   60.884 mi: 2.53920841 zkl:  103.077 cd:   -7.586 pos_prob:   80.135 prob_neg:   87.721 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    34 rec:   46.080 mi: 2.72855735 zkl:   89.042 cd:  -10.298 pos_prob:   75.544 prob_neg:   85.842 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    34 rec:   53.464 mi: 2.52159572 zkl:   97.693 cd:    1.883 pos_prob:   87.533 prob_neg:   85.649 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-034-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.04, 41.7/13.1/6.0/3.4 (BP=0.981, ratio=0.982, hyp_len=75753, ref_len=77177)
--- bleu: BLEU = 10.04, 41.7/13.1/6.0/3.4 (BP=0.981, ratio=0.982, hyp_len=75753, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    35 rec:   48.739 mi: 2.45550823 zkl:   90.894 cd:   -9.995 pos_prob:   79.900 prob_neg:   89.895 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    35 rec:   55.153 mi: 2.46130133 zkl:   87.390 cd:  -16.286 pos_prob:   74.312 prob_neg:   90.598 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    35 rec:   53.842 mi: 2.61716390 zkl:   84.930 cd:  -12.355 pos_prob:   75.272 prob_neg:   87.626 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    35 rec:   67.775 mi: 2.63342428 zkl:   90.685 cd:  -10.008 pos_prob:   75.194 prob_neg:   85.201 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    35 rec:   60.081 mi: 2.54188442 zkl:   88.468 cd:   -8.663 pos_prob:   80.498 prob_neg:   89.161 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-386.523
Langevin prior   6/ 40: energy=-1491.113
Langevin prior  11/ 40: energy=-2143.671
Langevin prior  16/ 40: energy=-2391.838
Langevin prior  21/ 40: energy=-2516.602
Langevin prior  26/ 40: energy=-2516.675
Langevin prior  31/ 40: energy=-2605.215
Langevin prior  36/ 40: energy=-2642.140
Langevin prior  40/ 40: energy=-2651.798
batch/max_batch/ep:   600/  1402/    35 rec:   60.962 mi: 2.60711241 zkl:   80.805 cd:   -5.733 pos_prob:   77.666 prob_neg:   83.399 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    35 rec:   56.163 mi: 2.63550043 zkl:   81.546 cd:   -9.974 pos_prob:   71.364 prob_neg:   81.338 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    35 rec:   54.875 mi: 2.37500048 zkl:   90.656 cd:    0.963 pos_prob:   80.779 prob_neg:   79.816 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    35 rec:   56.496 mi: 2.31599641 zkl:   84.650 cd:    5.646 pos_prob:   84.539 prob_neg:   78.893 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    35 rec:   54.229 mi: 2.63389325 zkl:   84.757 cd:   -1.411 pos_prob:   80.582 prob_neg:   81.993 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-412.842
Langevin prior   6/ 40: energy=-1470.726
Langevin prior  11/ 40: energy=-1965.514
Langevin prior  16/ 40: energy=-2249.860
Langevin prior  21/ 40: energy=-2359.792
Langevin prior  26/ 40: energy=-2441.914
Langevin prior  31/ 40: energy=-2497.511
Langevin prior  36/ 40: energy=-2466.309
Langevin prior  40/ 40: energy=-2409.934
batch/max_batch/ep:  1100/  1402/    35 rec:   55.238 mi: 2.51382422 zkl:   89.077 cd:   -4.889 pos_prob:   77.580 prob_neg:   82.469 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    35 rec:   43.320 mi: 2.38955307 zkl:   79.013 cd:   -0.744 pos_prob:   78.292 prob_neg:   79.037 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    35 rec:   39.582 mi: 2.70097804 zkl:   68.349 cd:  -14.536 pos_prob:   69.310 prob_neg:   83.846 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    35 rec:   58.795 mi: 2.51627207 zkl:   87.394 cd:   -0.577 pos_prob:   79.017 prob_neg:   79.594 kl_weight:    0.500 do_ae_train: False
200 done. -75.50995197169931
400 done. -81.95480400144211
600 done. -82.93090826735475
800 done. -83.13093806700667
1000 done. -84.53621561370396
1200 done. -85.80551901587714
1400 done. -86.92563789948672
1600 done. -86.42303159275592
1800 done. -84.73057971665173
2000 done. -82.26739585350401
2200 done. -81.30568143015724
2400 done. -80.46532608299947
2600 done. -80.71203392744141
2800 done. -80.68479711262157
3000 done. -80.99190086495722
3200 done. -81.42621654740397
3400 done. -81.65838086951739
3600 done. -82.35498608345176
Negative Log-likehood -82.947842
log-likelihood:    -82.948
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-035-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-035-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.89, 43.0/13.7/6.1/3.4 (BP=0.937, ratio=0.939, hyp_len=72435, ref_len=77177)
--- bleu: BLEU = 9.89, 43.0/13.7/6.1/3.4 (BP=0.937, ratio=0.939, hyp_len=72435, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    36 rec:   51.638 mi: 2.58039832 zkl:   76.979 cd:   -7.294 pos_prob:   75.995 prob_neg:   83.290 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    36 rec:   50.700 mi: 2.66827893 zkl:   85.338 cd:   -1.506 pos_prob:   82.746 prob_neg:   84.253 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    36 rec:   55.608 mi: 2.75619388 zkl:   80.968 cd:   -4.750 pos_prob:   80.100 prob_neg:   84.851 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    36 rec:   46.582 mi: 2.51188993 zkl:   81.597 cd:  -11.004 pos_prob:   77.563 prob_neg:   88.566 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    36 rec:   48.697 mi: 2.56208730 zkl:   75.809 cd:   -3.945 pos_prob:   74.831 prob_neg:   78.776 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-401.343
Langevin prior   6/ 40: energy=-1499.499
Langevin prior  11/ 40: energy=-1999.468
Langevin prior  16/ 40: energy=-2367.990
Langevin prior  21/ 40: energy=-2492.112
Langevin prior  26/ 40: energy=-2584.812
Langevin prior  31/ 40: energy=-2582.283
Langevin prior  36/ 40: energy=-2527.628
Langevin prior  40/ 40: energy=-2487.472
batch/max_batch/ep:   600/  1402/    36 rec:   58.459 mi: 2.56645656 zkl:   78.983 cd:   -3.734 pos_prob:   79.134 prob_neg:   82.868 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    36 rec:   59.740 mi: 2.64173412 zkl:   81.780 cd:   -7.086 pos_prob:   76.843 prob_neg:   83.929 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    36 rec:   62.761 mi: 2.52331614 zkl:   74.962 cd:  -11.324 pos_prob:   72.387 prob_neg:   83.712 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    36 rec:   49.285 mi: 2.43847060 zkl:   77.757 cd:   -2.726 pos_prob:   78.317 prob_neg:   81.043 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    36 rec:   45.710 mi: 2.55184269 zkl:   72.459 cd:   -5.921 pos_prob:   73.242 prob_neg:   79.163 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-399.929
Langevin prior   6/ 40: energy=-1429.995
Langevin prior  11/ 40: energy=-1984.034
Langevin prior  16/ 40: energy=-2184.854
Langevin prior  21/ 40: energy=-2329.955
Langevin prior  26/ 40: energy=-2462.270
Langevin prior  31/ 40: energy=-2454.756
Langevin prior  36/ 40: energy=-2476.042
Langevin prior  40/ 40: energy=-2525.641
batch/max_batch/ep:  1100/  1402/    36 rec:   59.143 mi: 2.43138409 zkl:   79.710 cd:   -5.778 pos_prob:   78.449 prob_neg:   84.227 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    36 rec:   55.461 mi: 2.55738568 zkl:   82.026 cd:   -2.657 pos_prob:   78.358 prob_neg:   81.015 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    36 rec:   57.254 mi: 2.22122312 zkl:   70.858 cd:   -9.344 pos_prob:   68.593 prob_neg:   77.937 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    36 rec:   55.869 mi: 2.50145388 zkl:   71.823 cd:  -14.727 pos_prob:   68.714 prob_neg:   83.440 kl_weight:    0.500 do_ae_train: False
200 done. -76.47972868858487
400 done. -82.62151328322072
600 done. -83.52118469978069
800 done. -83.53938599752081
1000 done. -85.10541693058676
1200 done. -86.38682023207411
1400 done. -87.48033601334285
1600 done. -86.95015069055665
1800 done. -85.2680948879462
2000 done. -82.75810394365172
2200 done. -81.77786846920205
2400 done. -80.91687178585117
2600 done. -81.11860189809886
2800 done. -81.11639290674032
3000 done. -81.41073845620923
3200 done. -81.85264871515406
3400 done. -82.05600213583904
3600 done. -82.71058777056668
Negative Log-likehood -83.303002
log-likelihood:    -83.303
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-036-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-036-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.84, 43.2/13.7/6.1/3.4 (BP=0.936, ratio=0.938, hyp_len=72415, ref_len=77177)
--- bleu: BLEU = 9.84, 43.2/13.7/6.1/3.4 (BP=0.936, ratio=0.938, hyp_len=72415, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    37 rec:   49.472 mi: 2.70994616 zkl:  186.366 cd:  -15.591 pos_prob:   62.767 prob_neg:   78.359 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    37 rec:   46.125 mi: 2.59888601 zkl:  184.332 cd:  -25.259 pos_prob:   55.931 prob_neg:   81.190 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    37 rec:   47.327 mi: 2.62074542 zkl:  189.070 cd:  -25.322 pos_prob:   55.635 prob_neg:   80.957 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    37 rec:   53.689 mi: 2.53395176 zkl:  187.179 cd:  -33.562 pos_prob:   44.344 prob_neg:   77.906 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    37 rec:   45.772 mi: 2.54408002 zkl:  191.748 cd:  -27.508 pos_prob:   50.838 prob_neg:   78.347 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-360.814
Langevin prior   6/ 40: energy=-1425.611
Langevin prior  11/ 40: energy=-1908.286
Langevin prior  16/ 40: energy=-2156.673
Langevin prior  21/ 40: energy=-2293.444
Langevin prior  26/ 40: energy=-2308.291
Langevin prior  31/ 40: energy=-2282.729
Langevin prior  36/ 40: energy=-2282.740
Langevin prior  40/ 40: energy=-2364.506
batch/max_batch/ep:   600/  1402/    37 rec:   38.906 mi: 2.50432444 zkl:  187.916 cd:  -38.287 pos_prob:   42.112 prob_neg:   80.399 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    37 rec:   45.048 mi: 2.45027661 zkl:  193.685 cd:  -28.319 pos_prob:   50.273 prob_neg:   78.592 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    37 rec:   46.037 mi: 2.60634708 zkl:  192.201 cd:  -35.578 pos_prob:   43.921 prob_neg:   79.499 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    37 rec:   43.918 mi: 2.64399076 zkl:  191.053 cd:  -37.487 pos_prob:   42.981 prob_neg:   80.468 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    37 rec:   48.718 mi: 2.52559137 zkl:  193.395 cd:  -34.859 pos_prob:   43.901 prob_neg:   78.759 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-387.383
Langevin prior   6/ 40: energy=-1389.991
Langevin prior  11/ 40: energy=-1861.526
Langevin prior  16/ 40: energy=-2192.806
Langevin prior  21/ 40: energy=-2381.324
Langevin prior  26/ 40: energy=-2422.946
Langevin prior  31/ 40: energy=-2513.047
Langevin prior  36/ 40: energy=-2517.055
Langevin prior  40/ 40: energy=-2467.313
batch/max_batch/ep:  1100/  1402/    37 rec:   42.504 mi: 2.71249175 zkl:  193.076 cd:  -41.536 pos_prob:   40.548 prob_neg:   82.084 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    37 rec:   39.466 mi: 2.56247663 zkl:  191.689 cd:  -36.572 pos_prob:   40.989 prob_neg:   77.561 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    37 rec:   47.527 mi: 2.22032285 zkl:  193.896 cd:  -46.139 pos_prob:   37.518 prob_neg:   83.657 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    37 rec:   49.496 mi: 2.54641151 zkl:  193.781 cd:  -36.371 pos_prob:   39.157 prob_neg:   75.527 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-037-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.90, 44.6/14.5/6.8/3.9 (BP=0.951, ratio=0.952, hyp_len=73467, ref_len=77177)
--- bleu: BLEU = 10.90, 44.6/14.5/6.8/3.9 (BP=0.951, ratio=0.952, hyp_len=73467, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    38 rec:   35.977 mi: 2.39627266 zkl:  194.224 cd:  -39.679 pos_prob:   41.851 prob_neg:   81.530 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    38 rec:   32.644 mi: 2.51639628 zkl:  194.317 cd:  -44.768 pos_prob:   39.130 prob_neg:   83.898 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    38 rec:   38.996 mi: 2.41489553 zkl:  194.660 cd:  -39.938 pos_prob:   39.619 prob_neg:   79.557 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    38 rec:   32.920 mi: 2.46096444 zkl:  194.880 cd:  -40.335 pos_prob:   38.788 prob_neg:   79.123 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    38 rec:   40.054 mi: 2.50191951 zkl:  196.122 cd:  -41.944 pos_prob:   39.024 prob_neg:   80.968 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-281.628
Langevin prior   6/ 40: energy=-1313.758
Langevin prior  11/ 40: energy=-1824.548
Langevin prior  16/ 40: energy=-2112.863
Langevin prior  21/ 40: energy=-2305.610
Langevin prior  26/ 40: energy=-2399.952
Langevin prior  31/ 40: energy=-2394.518
Langevin prior  36/ 40: energy=-2377.005
Langevin prior  40/ 40: energy=-2342.941
batch/max_batch/ep:   600/  1402/    38 rec:   37.808 mi: 2.44089532 zkl:  194.992 cd:  -47.912 pos_prob:   33.572 prob_neg:   81.484 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    38 rec:   31.714 mi: 2.29824018 zkl:  194.320 cd:  -45.587 pos_prob:   35.709 prob_neg:   81.296 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    38 rec:   41.553 mi: 2.34106851 zkl:  193.755 cd:  -48.040 pos_prob:   31.339 prob_neg:   79.379 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    38 rec:   46.848 mi: 2.47281218 zkl:  195.434 cd:  -45.851 pos_prob:   32.746 prob_neg:   78.597 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    38 rec:   33.147 mi: 2.46028256 zkl:  191.596 cd:  -47.767 pos_prob:   31.698 prob_neg:   79.464 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-334.162
Langevin prior   6/ 40: energy=-1336.885
Langevin prior  11/ 40: energy=-1931.407
Langevin prior  16/ 40: energy=-2188.903
Langevin prior  21/ 40: energy=-2272.090
Langevin prior  26/ 40: energy=-2382.177
Langevin prior  31/ 40: energy=-2396.058
Langevin prior  36/ 40: energy=-2503.825
Langevin prior  40/ 40: energy=-2481.483
batch/max_batch/ep:  1100/  1402/    38 rec:   32.064 mi: 2.42891288 zkl:  194.996 cd:  -47.526 pos_prob:   35.329 prob_neg:   82.855 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    38 rec:   36.955 mi: 2.48414683 zkl:  194.838 cd:  -48.885 pos_prob:   33.191 prob_neg:   82.077 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    38 rec:   40.841 mi: 2.54347253 zkl:  196.867 cd:  -47.768 pos_prob:   34.107 prob_neg:   81.875 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    38 rec:   44.408 mi: 2.34345007 zkl:  198.579 cd:  -47.704 pos_prob:   31.787 prob_neg:   79.492 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-038-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.90, 43.5/13.9/6.6/3.8 (BP=0.982, ratio=0.982, hyp_len=75776, ref_len=77177)
--- bleu: BLEU = 10.90, 43.5/13.9/6.6/3.8 (BP=0.982, ratio=0.982, hyp_len=75776, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    39 rec:   32.256 mi: 2.44808507 zkl:  198.519 cd:  -46.871 pos_prob:   34.350 prob_neg:   81.221 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    39 rec:   48.814 mi: 2.37811804 zkl:  201.426 cd:  -45.104 pos_prob:   32.543 prob_neg:   77.647 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    39 rec:   37.764 mi: 2.52502608 zkl:  199.360 cd:  -47.749 pos_prob:   28.974 prob_neg:   76.722 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    39 rec:   42.624 mi: 2.45913196 zkl:  199.288 cd:  -55.362 pos_prob:   30.726 prob_neg:   86.088 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    39 rec:   49.682 mi: 2.46974993 zkl:  202.549 cd:  -52.471 pos_prob:   29.886 prob_neg:   82.358 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-378.927
Langevin prior   6/ 40: energy=-1373.782
Langevin prior  11/ 40: energy=-1834.384
Langevin prior  16/ 40: energy=-2144.189
Langevin prior  21/ 40: energy=-2323.412
Langevin prior  26/ 40: energy=-2331.312
Langevin prior  31/ 40: energy=-2319.852
Langevin prior  36/ 40: energy=-2360.102
Langevin prior  40/ 40: energy=-2444.998
batch/max_batch/ep:   600/  1402/    39 rec:   50.002 mi: 2.49537492 zkl:  204.690 cd:  -48.078 pos_prob:   30.001 prob_neg:   78.079 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    39 rec:   28.632 mi: 2.40495420 zkl:  200.990 cd:  -48.465 pos_prob:   32.768 prob_neg:   81.234 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    39 rec:   41.742 mi: 2.40168047 zkl:  204.035 cd:  -46.745 pos_prob:   31.251 prob_neg:   77.997 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    39 rec:   46.363 mi: 2.48276138 zkl:  203.055 cd:  -48.524 pos_prob:   30.704 prob_neg:   79.228 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    39 rec:   44.321 mi: 2.56188583 zkl:  206.064 cd:  -42.884 pos_prob:   33.121 prob_neg:   76.005 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-383.998
Langevin prior   6/ 40: energy=-1322.009
Langevin prior  11/ 40: energy=-1757.835
Langevin prior  16/ 40: energy=-2072.324
Langevin prior  21/ 40: energy=-2203.498
Langevin prior  26/ 40: energy=-2200.515
Langevin prior  31/ 40: energy=-2205.426
Langevin prior  36/ 40: energy=-2189.679
Langevin prior  40/ 40: energy=-2279.325
batch/max_batch/ep:  1100/  1402/    39 rec:   38.138 mi: 2.48662782 zkl:  202.846 cd:  -47.583 pos_prob:   29.406 prob_neg:   76.989 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    39 rec:   43.714 mi: 2.24645805 zkl:  205.538 cd:  -52.265 pos_prob:   27.854 prob_neg:   80.119 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    39 rec:   40.793 mi: 2.29514527 zkl:  205.832 cd:  -53.231 pos_prob:   29.716 prob_neg:   82.947 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    39 rec:   38.578 mi: 2.36085463 zkl:  206.654 cd:  -51.727 pos_prob:   29.354 prob_neg:   81.081 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-039-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.32, 43.9/14.3/6.8/4.1 (BP=0.984, ratio=0.984, hyp_len=75965, ref_len=77177)
--- bleu: BLEU = 11.32, 43.9/14.3/6.8/4.1 (BP=0.984, ratio=0.984, hyp_len=75965, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    40 rec:   35.905 mi: 2.31903315 zkl:  143.132 cd:  -38.590 pos_prob:   50.608 prob_neg:   89.198 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    40 rec:   40.079 mi: 2.35123420 zkl:  123.730 cd:  -42.058 pos_prob:   49.859 prob_neg:   91.917 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    40 rec:   42.782 mi: 2.49070144 zkl:  112.802 cd:  -37.595 pos_prob:   55.587 prob_neg:   93.182 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    40 rec:   45.907 mi: 2.43652248 zkl:  113.649 cd:  -33.018 pos_prob:   62.107 prob_neg:   95.125 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    40 rec:   46.317 mi: 2.56575274 zkl:  102.065 cd:  -27.843 pos_prob:   63.759 prob_neg:   91.601 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-391.891
Langevin prior   6/ 40: energy=-1535.521
Langevin prior  11/ 40: energy=-2066.844
Langevin prior  16/ 40: energy=-2385.099
Langevin prior  21/ 40: energy=-2552.896
Langevin prior  26/ 40: energy=-2577.208
Langevin prior  31/ 40: energy=-2572.678
Langevin prior  36/ 40: energy=-2654.968
Langevin prior  40/ 40: energy=-2673.299
batch/max_batch/ep:   600/  1402/    40 rec:   37.789 mi: 2.42001653 zkl:   99.960 cd:  -33.926 pos_prob:   57.565 prob_neg:   91.491 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    40 rec:   36.334 mi: 2.67129779 zkl:  105.033 cd:  -22.671 pos_prob:   65.662 prob_neg:   88.333 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    40 rec:   54.641 mi: 2.47672391 zkl:  112.833 cd:  -11.220 pos_prob:   79.890 prob_neg:   91.110 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    40 rec:   55.388 mi: 2.53570032 zkl:  100.738 cd:  -21.086 pos_prob:   66.899 prob_neg:   87.984 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    40 rec:   54.651 mi: 2.37962365 zkl:  106.280 cd:  -11.479 pos_prob:   78.004 prob_neg:   89.483 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-388.475
Langevin prior   6/ 40: energy=-1545.540
Langevin prior  11/ 40: energy=-2121.447
Langevin prior  16/ 40: energy=-2374.164
Langevin prior  21/ 40: energy=-2530.576
Langevin prior  26/ 40: energy=-2575.076
Langevin prior  31/ 40: energy=-2573.918
Langevin prior  36/ 40: energy=-2584.080
Langevin prior  40/ 40: energy=-2618.874
batch/max_batch/ep:  1100/  1402/    40 rec:   58.951 mi: 2.41758609 zkl:   97.056 cd:  -11.190 pos_prob:   72.632 prob_neg:   83.822 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    40 rec:   45.070 mi: 2.64878845 zkl:   97.354 cd:   -2.567 pos_prob:   82.181 prob_neg:   84.748 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    40 rec:   48.241 mi: 2.66803074 zkl:   98.056 cd:   -5.356 pos_prob:   80.871 prob_neg:   86.228 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    40 rec:   44.309 mi: 2.57711482 zkl:   98.942 cd:    2.120 pos_prob:   83.117 prob_neg:   80.997 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-040-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.30, 43.4/13.5/6.1/3.6 (BP=0.969, ratio=0.969, hyp_len=74802, ref_len=77177)
--- bleu: BLEU = 10.30, 43.4/13.5/6.1/3.6 (BP=0.969, ratio=0.969, hyp_len=74802, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    41 rec:   47.027 mi: 2.76410723 zkl:   86.809 cd:  -15.897 pos_prob:   73.084 prob_neg:   88.982 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    41 rec:   45.065 mi: 2.49587226 zkl:   93.026 cd:   -2.858 pos_prob:   78.244 prob_neg:   81.102 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    41 rec:   48.445 mi: 2.56424713 zkl:   91.140 cd:   -6.264 pos_prob:   76.828 prob_neg:   83.092 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    41 rec:   44.937 mi: 2.49614096 zkl:   78.757 cd:  -12.639 pos_prob:   70.771 prob_neg:   83.410 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    41 rec:   57.993 mi: 2.53675628 zkl:   87.558 cd:   -4.080 pos_prob:   73.778 prob_neg:   77.857 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-433.109
Langevin prior   6/ 40: energy=-1494.878
Langevin prior  11/ 40: energy=-1981.842
Langevin prior  16/ 40: energy=-2153.881
Langevin prior  21/ 40: energy=-2349.425
Langevin prior  26/ 40: energy=-2399.268
Langevin prior  31/ 40: energy=-2387.814
Langevin prior  36/ 40: energy=-2458.898
Langevin prior  40/ 40: energy=-2487.911
batch/max_batch/ep:   600/  1402/    41 rec:   43.059 mi: 2.70096612 zkl:   84.459 cd:   -0.135 pos_prob:   73.908 prob_neg:   74.043 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    41 rec:   62.824 mi: 2.61360908 zkl:   78.689 cd:   -9.260 pos_prob:   72.660 prob_neg:   81.920 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    41 rec:   52.917 mi: 2.67282581 zkl:   80.776 cd:   -1.478 pos_prob:   74.711 prob_neg:   76.189 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    41 rec:   45.601 mi: 2.72641945 zkl:   72.117 cd:   -9.343 pos_prob:   73.522 prob_neg:   82.866 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    41 rec:   58.502 mi: 2.51248550 zkl:   78.376 cd:   -7.995 pos_prob:   72.292 prob_neg:   80.287 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-380.660
Langevin prior   6/ 40: energy=-1419.834
Langevin prior  11/ 40: energy=-1899.252
Langevin prior  16/ 40: energy=-2118.072
Langevin prior  21/ 40: energy=-2211.210
Langevin prior  26/ 40: energy=-2207.910
Langevin prior  31/ 40: energy=-2313.875
Langevin prior  36/ 40: energy=-2256.187
Langevin prior  40/ 40: energy=-2337.857
batch/max_batch/ep:  1100/  1402/    41 rec:   58.458 mi: 2.51507640 zkl:   82.193 cd:  -12.140 pos_prob:   71.956 prob_neg:   84.097 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    41 rec:   60.355 mi: 2.44978428 zkl:   75.468 cd:   -7.430 pos_prob:   74.975 prob_neg:   82.405 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    41 rec:   48.866 mi: 2.57158875 zkl:   75.419 cd:   -4.895 pos_prob:   71.357 prob_neg:   76.251 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    41 rec:   55.853 mi: 2.58176684 zkl:   73.626 cd:   -6.685 pos_prob:   67.709 prob_neg:   74.394 kl_weight:    0.500 do_ae_train: False
200 done. -75.70170816070927
400 done. -81.95507367954318
600 done. -82.78841030321612
800 done. -83.00958175423564
1000 done. -84.61292006161032
1200 done. -85.97456870679233
1400 done. -87.10368737876517
1600 done. -86.50019879747144
1800 done. -84.77718578285192
2000 done. -82.28689854043213
2200 done. -81.29149333291335
2400 done. -80.41246200886954
2600 done. -80.64675898637303
2800 done. -80.63628354372295
3000 done. -80.90060857676268
3200 done. -81.30879072691644
3400 done. -81.52442338097612
3600 done. -82.15369852636775
Negative Log-likehood -82.738328
log-likelihood:    -82.738
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-041-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-041-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.78, 41.9/13.0/5.8/3.2 (BP=0.972, ratio=0.973, hyp_len=75055, ref_len=77177)
--- bleu: BLEU = 9.78, 41.9/13.0/5.8/3.2 (BP=0.972, ratio=0.973, hyp_len=75055, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    42 rec:   52.400 mi: 2.34631562 zkl:   80.448 cd:   -1.551 pos_prob:   72.646 prob_neg:   74.197 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    42 rec:   48.850 mi: 2.61025524 zkl:   79.974 cd:    2.166 pos_prob:   75.657 prob_neg:   73.491 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    42 rec:   55.815 mi: 2.61848974 zkl:   76.742 cd:   -4.725 pos_prob:   71.533 prob_neg:   76.257 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    42 rec:   60.683 mi: 2.50293851 zkl:   74.181 cd:   -0.279 pos_prob:   71.098 prob_neg:   71.377 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    42 rec:   46.873 mi: 2.53217053 zkl:   78.294 cd:   -4.068 pos_prob:   71.233 prob_neg:   75.301 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-394.016
Langevin prior   6/ 40: energy=-1300.020
Langevin prior  11/ 40: energy=-1784.182
Langevin prior  16/ 40: energy=-2021.825
Langevin prior  21/ 40: energy=-2167.248
Langevin prior  26/ 40: energy=-2232.185
Langevin prior  31/ 40: energy=-2228.641
Langevin prior  36/ 40: energy=-2301.868
Langevin prior  40/ 40: energy=-2412.862
batch/max_batch/ep:   600/  1402/    42 rec:   67.024 mi: 2.34514570 zkl:   83.502 cd:    0.019 pos_prob:   74.168 prob_neg:   74.149 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    42 rec:   57.990 mi: 2.33645463 zkl:   83.282 cd:    4.077 pos_prob:   74.933 prob_neg:   70.856 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    42 rec:   51.768 mi: 2.39709401 zkl:   74.253 cd:   -8.860 pos_prob:   65.250 prob_neg:   74.110 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    42 rec:   52.377 mi: 2.58055329 zkl:   72.913 cd:   -5.358 pos_prob:   70.388 prob_neg:   75.747 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    42 rec:   50.947 mi: 2.55549455 zkl:   71.387 cd:   -4.810 pos_prob:   69.409 prob_neg:   74.219 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-404.060
Langevin prior   6/ 40: energy=-1266.975
Langevin prior  11/ 40: energy=-1787.860
Langevin prior  16/ 40: energy=-2064.831
Langevin prior  21/ 40: energy=-2240.912
Langevin prior  26/ 40: energy=-2272.719
Langevin prior  31/ 40: energy=-2326.582
Langevin prior  36/ 40: energy=-2387.358
Langevin prior  40/ 40: energy=-2436.235
batch/max_batch/ep:  1100/  1402/    42 rec:   46.227 mi: 2.49368501 zkl:   74.718 cd:   -0.238 pos_prob:   73.917 prob_neg:   74.156 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    42 rec:   49.588 mi: 2.54455853 zkl:   72.762 cd:   -3.724 pos_prob:   71.394 prob_neg:   75.118 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    42 rec:   54.283 mi: 2.44139242 zkl:   76.872 cd:    0.700 pos_prob:   72.048 prob_neg:   71.348 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    42 rec:   57.951 mi: 2.63837719 zkl:   72.933 cd:  -12.006 pos_prob:   64.325 prob_neg:   76.331 kl_weight:    0.500 do_ae_train: False
200 done. -75.16578597980453
400 done. -81.38516211660802
600 done. -82.24481474992656
800 done. -82.55618649924705
1000 done. -84.26658741800934
1200 done. -85.53864951331819
1400 done. -86.6718245804705
1600 done. -86.06921421399045
1800 done. -84.36125995848181
2000 done. -81.88266674668549
2200 done. -80.8889505375668
2400 done. -80.01772612244014
2600 done. -80.20313645393108
2800 done. -80.17964661991013
3000 done. -80.45530844720845
3200 done. -80.88414829249608
3400 done. -81.09814309505624
3600 done. -81.73693272255505
Negative Log-likehood -82.308907
log-likelihood:    -82.309
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-042-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-042-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.87, 43.0/13.5/6.1/3.4 (BP=0.944, ratio=0.945, hyp_len=72941, ref_len=77177)
--- bleu: BLEU = 9.87, 43.0/13.5/6.1/3.4 (BP=0.944, ratio=0.945, hyp_len=72941, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    43 rec:   38.339 mi: 2.64647079 zkl:  187.452 cd:  -13.904 pos_prob:   61.186 prob_neg:   75.090 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    43 rec:   36.710 mi: 2.69696665 zkl:  189.370 cd:  -14.226 pos_prob:   59.450 prob_neg:   73.677 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    43 rec:   40.319 mi: 2.60847068 zkl:  187.074 cd:  -27.590 pos_prob:   49.941 prob_neg:   77.531 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    43 rec:   43.803 mi: 2.50014853 zkl:  190.578 cd:  -23.682 pos_prob:   49.878 prob_neg:   73.560 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    43 rec:   38.425 mi: 2.38474965 zkl:  189.566 cd:  -30.854 pos_prob:   44.789 prob_neg:   75.643 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-400.465
Langevin prior   6/ 40: energy=-1258.516
Langevin prior  11/ 40: energy=-1752.228
Langevin prior  16/ 40: energy=-1941.563
Langevin prior  21/ 40: energy=-2062.425
Langevin prior  26/ 40: energy=-2208.459
Langevin prior  31/ 40: energy=-2150.125
Langevin prior  36/ 40: energy=-2193.128
Langevin prior  40/ 40: energy=-2235.561
batch/max_batch/ep:   600/  1402/    43 rec:   45.113 mi: 2.43871617 zkl:  188.999 cd:  -38.988 pos_prob:   42.695 prob_neg:   81.683 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    43 rec:   46.745 mi: 2.58812547 zkl:  188.756 cd:  -27.063 pos_prob:   44.116 prob_neg:   71.178 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    43 rec:   42.237 mi: 2.33003163 zkl:  187.895 cd:  -33.483 pos_prob:   39.171 prob_neg:   72.654 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    43 rec:   51.753 mi: 2.48960543 zkl:  191.615 cd:  -29.648 pos_prob:   42.567 prob_neg:   72.216 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    43 rec:   40.809 mi: 2.43793011 zkl:  189.721 cd:  -41.472 pos_prob:   36.828 prob_neg:   78.300 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-365.002
Langevin prior   6/ 40: energy=-1294.794
Langevin prior  11/ 40: energy=-1721.461
Langevin prior  16/ 40: energy=-1915.344
Langevin prior  21/ 40: energy=-2103.027
Langevin prior  26/ 40: energy=-2204.117
Langevin prior  31/ 40: energy=-2249.527
Langevin prior  36/ 40: energy=-2277.335
Langevin prior  40/ 40: energy=-2250.820
batch/max_batch/ep:  1100/  1402/    43 rec:   37.162 mi: 2.44616461 zkl:  191.866 cd:  -29.705 pos_prob:   42.120 prob_neg:   71.825 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    43 rec:   47.687 mi: 2.51330400 zkl:  191.434 cd:  -41.960 pos_prob:   38.009 prob_neg:   79.969 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    43 rec:   39.012 mi: 2.52881551 zkl:  189.305 cd:  -35.640 pos_prob:   37.566 prob_neg:   73.206 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    43 rec:   45.057 mi: 2.44357800 zkl:  192.301 cd:  -36.274 pos_prob:   37.789 prob_neg:   74.062 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-043-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.90, 42.8/13.5/6.4/3.8 (BP=1.000, ratio=1.010, hyp_len=77924, ref_len=77177)
--- bleu: BLEU = 10.90, 42.8/13.5/6.4/3.8 (BP=1.000, ratio=1.010, hyp_len=77924, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    44 rec:   38.713 mi: 2.55191970 zkl:  194.426 cd:  -38.280 pos_prob:   37.382 prob_neg:   75.663 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    44 rec:   35.895 mi: 2.34112453 zkl:  194.254 cd:  -37.249 pos_prob:   37.186 prob_neg:   74.435 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    44 rec:   33.825 mi: 2.57703424 zkl:  193.404 cd:  -39.634 pos_prob:   36.260 prob_neg:   75.894 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    44 rec:   33.177 mi: 2.50764489 zkl:  193.921 cd:  -38.431 pos_prob:   36.067 prob_neg:   74.498 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    44 rec:   34.472 mi: 2.47524190 zkl:  195.322 cd:  -38.258 pos_prob:   36.393 prob_neg:   74.651 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-364.384
Langevin prior   6/ 40: energy=-1274.119
Langevin prior  11/ 40: energy=-1739.601
Langevin prior  16/ 40: energy=-1934.958
Langevin prior  21/ 40: energy=-1977.009
Langevin prior  26/ 40: energy=-2017.133
Langevin prior  31/ 40: energy=-2108.318
Langevin prior  36/ 40: energy=-2095.584
Langevin prior  40/ 40: energy=-2102.222
batch/max_batch/ep:   600/  1402/    44 rec:   37.623 mi: 2.59752035 zkl:  196.321 cd:  -41.109 pos_prob:   32.836 prob_neg:   73.946 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    44 rec:   50.526 mi: 2.24987841 zkl:  197.816 cd:  -42.450 pos_prob:   31.840 prob_neg:   74.290 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    44 rec:   49.363 mi: 2.44568777 zkl:  196.690 cd:  -43.850 pos_prob:   31.541 prob_neg:   75.391 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    44 rec:   40.203 mi: 2.40589046 zkl:  194.941 cd:  -43.828 pos_prob:   31.026 prob_neg:   74.854 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    44 rec:   39.663 mi: 2.39262104 zkl:  197.573 cd:  -41.299 pos_prob:   32.081 prob_neg:   73.380 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-421.252
Langevin prior   6/ 40: energy=-1233.411
Langevin prior  11/ 40: energy=-1743.688
Langevin prior  16/ 40: energy=-1978.683
Langevin prior  21/ 40: energy=-2097.773
Langevin prior  26/ 40: energy=-2195.744
Langevin prior  31/ 40: energy=-2206.454
Langevin prior  36/ 40: energy=-2163.590
Langevin prior  40/ 40: energy=-2249.725
batch/max_batch/ep:  1100/  1402/    44 rec:   39.580 mi: 2.41534877 zkl:  197.586 cd:  -48.190 pos_prob:   28.279 prob_neg:   76.469 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    44 rec:   36.820 mi: 2.03117919 zkl:  199.215 cd:  -38.022 pos_prob:   34.429 prob_neg:   72.451 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    44 rec:   43.041 mi: 2.41998458 zkl:  199.920 cd:  -41.327 pos_prob:   31.768 prob_neg:   73.095 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    44 rec:   45.185 mi: 2.46697330 zkl:  200.356 cd:  -45.290 pos_prob:   28.323 prob_neg:   73.613 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-044-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.23, 43.1/13.9/6.7/4.0 (BP=1.000, ratio=1.001, hyp_len=77251, ref_len=77177)
--- bleu: BLEU = 11.23, 43.1/13.9/6.7/4.0 (BP=1.000, ratio=1.001, hyp_len=77251, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    45 rec:   33.089 mi: 2.47223496 zkl:  201.181 cd:  -42.369 pos_prob:   33.441 prob_neg:   75.810 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    45 rec:   27.560 mi: 2.65795851 zkl:  199.445 cd:  -42.412 pos_prob:   31.629 prob_neg:   74.041 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    45 rec:   31.389 mi: 2.45622110 zkl:  200.557 cd:  -45.613 pos_prob:   29.243 prob_neg:   74.856 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    45 rec:   42.716 mi: 2.45978069 zkl:  204.635 cd:  -39.683 pos_prob:   31.517 prob_neg:   71.201 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    45 rec:   42.255 mi: 2.57689381 zkl:  203.843 cd:  -45.058 pos_prob:   29.399 prob_neg:   74.457 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-324.261
Langevin prior   6/ 40: energy=-1252.744
Langevin prior  11/ 40: energy=-1762.346
Langevin prior  16/ 40: energy=-2030.392
Langevin prior  21/ 40: energy=-2149.030
Langevin prior  26/ 40: energy=-2141.190
Langevin prior  31/ 40: energy=-2206.271
Langevin prior  36/ 40: energy=-2203.239
Langevin prior  40/ 40: energy=-2223.264
batch/max_batch/ep:   600/  1402/    45 rec:   31.731 mi: 2.51986027 zkl:  201.993 cd:  -45.820 pos_prob:   29.986 prob_neg:   75.807 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    45 rec:   27.097 mi: 2.38739228 zkl:  198.257 cd:  -44.050 pos_prob:   29.227 prob_neg:   73.277 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    45 rec:   39.631 mi: 2.39857411 zkl:  205.044 cd:  -43.310 pos_prob:   31.887 prob_neg:   75.197 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    45 rec:   32.159 mi: 2.24212742 zkl:  200.354 cd:  -42.645 pos_prob:   30.533 prob_neg:   73.177 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    45 rec:   36.900 mi: 2.48035145 zkl:  204.467 cd:  -44.543 pos_prob:   30.693 prob_neg:   75.237 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-402.580
Langevin prior   6/ 40: energy=-1253.672
Langevin prior  11/ 40: energy=-1711.529
Langevin prior  16/ 40: energy=-1932.732
Langevin prior  21/ 40: energy=-2062.271
Langevin prior  26/ 40: energy=-2234.147
Langevin prior  31/ 40: energy=-2256.345
Langevin prior  36/ 40: energy=-2309.149
Langevin prior  40/ 40: energy=-2374.959
batch/max_batch/ep:  1100/  1402/    45 rec:   36.525 mi: 2.39850211 zkl:  204.313 cd:  -44.962 pos_prob:   30.790 prob_neg:   75.753 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    45 rec:   39.587 mi: 2.48530889 zkl:  205.082 cd:  -45.761 pos_prob:   26.755 prob_neg:   72.516 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    45 rec:   41.358 mi: 2.49099994 zkl:  207.320 cd:  -44.120 pos_prob:   29.517 prob_neg:   73.636 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    45 rec:   35.924 mi: 2.51022530 zkl:  205.939 cd:  -48.584 pos_prob:   29.171 prob_neg:   77.755 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-045-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.19, 43.3/14.0/6.7/4.0 (BP=0.991, ratio=0.991, hyp_len=76488, ref_len=77177)
--- bleu: BLEU = 11.19, 43.3/14.0/6.7/4.0 (BP=0.991, ratio=0.991, hyp_len=76488, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    46 rec:   43.952 mi: 2.37855792 zkl:  171.127 cd:  -42.803 pos_prob:   43.376 prob_neg:   86.180 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    46 rec:   45.158 mi: 2.67044830 zkl:  118.313 cd:  -40.317 pos_prob:   51.051 prob_neg:   91.369 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    46 rec:   43.121 mi: 2.40525198 zkl:  108.215 cd:  -35.717 pos_prob:   49.279 prob_neg:   84.996 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    46 rec:   43.116 mi: 2.42212534 zkl:  102.321 cd:  -31.220 pos_prob:   56.870 prob_neg:   88.090 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    46 rec:   34.131 mi: 2.46298623 zkl:  103.956 cd:  -23.854 pos_prob:   60.631 prob_neg:   84.484 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-359.200
Langevin prior   6/ 40: energy=-1464.589
Langevin prior  11/ 40: energy=-2103.168
Langevin prior  16/ 40: energy=-2372.002
Langevin prior  21/ 40: energy=-2565.476
Langevin prior  26/ 40: energy=-2569.790
Langevin prior  31/ 40: energy=-2490.768
Langevin prior  36/ 40: energy=-2584.915
Langevin prior  40/ 40: energy=-2512.682
batch/max_batch/ep:   600/  1402/    46 rec:   37.269 mi: 2.50768495 zkl:   95.980 cd:  -20.718 pos_prob:   60.469 prob_neg:   81.187 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    46 rec:   44.135 mi: 2.57253432 zkl:   98.502 cd:  -15.491 pos_prob:   62.099 prob_neg:   77.590 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    46 rec:   48.493 mi: 2.40954995 zkl:  101.555 cd:  -18.438 pos_prob:   63.498 prob_neg:   81.935 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    46 rec:   40.915 mi: 2.57070446 zkl:   92.782 cd:  -18.001 pos_prob:   62.429 prob_neg:   80.430 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    46 rec:   44.856 mi: 2.44862127 zkl:  107.255 cd:   -0.012 pos_prob:   74.985 prob_neg:   74.997 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-390.385
Langevin prior   6/ 40: energy=-1434.115
Langevin prior  11/ 40: energy=-1980.045
Langevin prior  16/ 40: energy=-2164.369
Langevin prior  21/ 40: energy=-2329.645
Langevin prior  26/ 40: energy=-2398.755
Langevin prior  31/ 40: energy=-2443.203
Langevin prior  36/ 40: energy=-2415.181
Langevin prior  40/ 40: energy=-2381.603
batch/max_batch/ep:  1100/  1402/    46 rec:   53.923 mi: 2.40805840 zkl:   95.952 cd:  -12.194 pos_prob:   65.350 prob_neg:   77.544 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    46 rec:   52.929 mi: 2.45880818 zkl:   92.883 cd:  -12.307 pos_prob:   64.460 prob_neg:   76.767 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    46 rec:   52.917 mi: 2.64994931 zkl:   90.841 cd:   -8.904 pos_prob:   66.881 prob_neg:   75.784 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    46 rec:   59.051 mi: 2.47316456 zkl:   90.241 cd:   -8.590 pos_prob:   63.741 prob_neg:   72.331 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-046-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.45, 42.7/13.4/6.1/3.5 (BP=0.994, ratio=0.994, hyp_len=76712, ref_len=77177)
--- bleu: BLEU = 10.45, 42.7/13.4/6.1/3.5 (BP=0.994, ratio=0.994, hyp_len=76712, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    47 rec:   53.889 mi: 2.67628002 zkl:   90.642 cd:   -4.853 pos_prob:   67.819 prob_neg:   72.673 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    47 rec:   42.413 mi: 2.28837895 zkl:   76.601 cd:  -13.382 pos_prob:   58.541 prob_neg:   71.923 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    47 rec:   60.339 mi: 2.43244314 zkl:   87.388 cd:   -9.840 pos_prob:   65.654 prob_neg:   75.494 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    47 rec:   50.538 mi: 2.83344913 zkl:   78.643 cd:   -2.389 pos_prob:   65.666 prob_neg:   68.055 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    47 rec:   53.523 mi: 2.40662193 zkl:   83.281 cd:   -1.943 pos_prob:   66.888 prob_neg:   68.830 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-408.442
Langevin prior   6/ 40: energy=-1299.676
Langevin prior  11/ 40: energy=-1742.887
Langevin prior  16/ 40: energy=-1924.186
Langevin prior  21/ 40: energy=-2021.014
Langevin prior  26/ 40: energy=-2068.937
Langevin prior  31/ 40: energy=-2076.446
Langevin prior  36/ 40: energy=-2043.288
Langevin prior  40/ 40: energy=-2106.151
batch/max_batch/ep:   600/  1402/    47 rec:   50.454 mi: 2.60610533 zkl:   75.450 cd:   -5.177 pos_prob:   61.900 prob_neg:   67.077 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    47 rec:   52.269 mi: 2.51189470 zkl:   77.160 cd:   -6.228 pos_prob:   66.146 prob_neg:   72.374 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    47 rec:   52.335 mi: 2.54890490 zkl:   69.772 cd:   -8.951 pos_prob:   58.486 prob_neg:   67.437 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    47 rec:   44.050 mi: 2.42955375 zkl:   73.515 cd:   -7.185 pos_prob:   63.678 prob_neg:   70.863 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    47 rec:   58.308 mi: 2.63248324 zkl:   78.883 cd:   -4.214 pos_prob:   65.415 prob_neg:   69.629 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-361.932
Langevin prior   6/ 40: energy=-1153.513
Langevin prior  11/ 40: energy=-1553.074
Langevin prior  16/ 40: energy=-1731.698
Langevin prior  21/ 40: energy=-1918.382
Langevin prior  26/ 40: energy=-2019.239
Langevin prior  31/ 40: energy=-2053.130
Langevin prior  36/ 40: energy=-2108.240
Langevin prior  40/ 40: energy=-2138.857
batch/max_batch/ep:  1100/  1402/    47 rec:   49.734 mi: 2.42459059 zkl:   72.459 cd:   -6.128 pos_prob:   60.404 prob_neg:   66.532 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    47 rec:   58.160 mi: 2.51396275 zkl:   76.696 cd:   -3.686 pos_prob:   65.041 prob_neg:   68.727 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    47 rec:   48.385 mi: 2.57011437 zkl:   75.550 cd:   -0.597 pos_prob:   67.592 prob_neg:   68.189 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    47 rec:   55.249 mi: 2.65434408 zkl:   72.565 cd:   -3.589 pos_prob:   63.362 prob_neg:   66.951 kl_weight:    0.500 do_ae_train: False
200 done. -76.71310174649534
400 done. -82.94816804297294
600 done. -83.94519920536077
800 done. -84.15404558774907
1000 done. -85.84325524859017
1200 done. -87.11646614224942
1400 done. -88.18021516804447
1600 done. -87.66352010058272
1800 done. -86.02601185258062
2000 done. -83.60119363547685
2200 done. -82.61710675471424
2400 done. -81.72309527921911
2600 done. -81.90192975892714
2800 done. -81.90848549714546
3000 done. -82.16265296113595
3200 done. -82.5673682929028
3400 done. -82.79440072779717
3600 done. -83.43767261471059
Negative Log-likehood -84.047661
log-likelihood:    -84.048
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-047-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-047-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.82, 43.1/13.4/6.1/3.4 (BP=0.941, ratio=0.942, hyp_len=72725, ref_len=77177)
--- bleu: BLEU = 9.82, 43.1/13.4/6.1/3.4 (BP=0.941, ratio=0.942, hyp_len=72725, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    48 rec:   57.713 mi: 2.61725092 zkl:   79.827 cd:   -0.227 pos_prob:   66.423 prob_neg:   66.650 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    48 rec:   45.462 mi: 2.53736997 zkl:   74.422 cd:   -3.612 pos_prob:   65.183 prob_neg:   68.795 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    48 rec:   56.014 mi: 2.55759454 zkl:   69.847 cd:   -8.196 pos_prob:   61.424 prob_neg:   69.619 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    48 rec:   51.039 mi: 2.68142819 zkl:   72.402 cd:   -0.300 pos_prob:   66.580 prob_neg:   66.881 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    48 rec:   47.355 mi: 2.46382785 zkl:   72.049 cd:   -4.092 pos_prob:   61.069 prob_neg:   65.160 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-352.735
Langevin prior   6/ 40: energy=-1314.315
Langevin prior  11/ 40: energy=-1718.303
Langevin prior  16/ 40: energy=-1938.940
Langevin prior  21/ 40: energy=-1974.108
Langevin prior  26/ 40: energy=-2056.313
Langevin prior  31/ 40: energy=-2126.740
Langevin prior  36/ 40: energy=-2126.560
Langevin prior  40/ 40: energy=-2089.605
batch/max_batch/ep:   600/  1402/    48 rec:   39.884 mi: 2.52978635 zkl:   69.860 cd:   -5.261 pos_prob:   60.837 prob_neg:   66.098 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    48 rec:   54.267 mi: 2.48519182 zkl:   71.597 cd:   -3.837 pos_prob:   58.367 prob_neg:   62.204 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    48 rec:   52.047 mi: 2.64074111 zkl:   79.666 cd:    6.167 pos_prob:   68.339 prob_neg:   62.172 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    48 rec:   54.281 mi: 2.44439721 zkl:   75.513 cd:    1.343 pos_prob:   66.433 prob_neg:   65.090 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    48 rec:   50.618 mi: 2.46703029 zkl:   64.506 cd:   -7.388 pos_prob:   57.147 prob_neg:   64.534 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-376.653
Langevin prior   6/ 40: energy=-1231.620
Langevin prior  11/ 40: energy=-1715.578
Langevin prior  16/ 40: energy=-1883.266
Langevin prior  21/ 40: energy=-1995.152
Langevin prior  26/ 40: energy=-1990.661
Langevin prior  31/ 40: energy=-2060.136
Langevin prior  36/ 40: energy=-2081.250
Langevin prior  40/ 40: energy=-2124.444
batch/max_batch/ep:  1100/  1402/    48 rec:   66.922 mi: 2.47432446 zkl:   79.679 cd:    3.672 pos_prob:   67.652 prob_neg:   63.981 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    48 rec:   40.786 mi: 2.60193658 zkl:   71.292 cd:   -2.198 pos_prob:   62.703 prob_neg:   64.902 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    48 rec:   52.923 mi: 2.46568704 zkl:   67.086 cd:    0.323 pos_prob:   61.105 prob_neg:   60.782 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    48 rec:   48.431 mi: 2.58887529 zkl:   63.711 cd:   -8.165 pos_prob:   56.443 prob_neg:   64.608 kl_weight:    0.500 do_ae_train: False
200 done. -78.68592175182441
400 done. -85.04397114611974
600 done. -85.97288413846675
800 done. -86.01879863372481
1000 done. -87.75068782452283
1200 done. -89.05089923515409
1400 done. -90.18008894454061
1600 done. -89.64995163861234
1800 done. -87.964041510886
2000 done. -85.49795978698096
2200 done. -84.45392295301158
2400 done. -83.60352597044856
2600 done. -83.77620003527123
2800 done. -83.76048874061486
3000 done. -84.05146115281832
3200 done. -84.47942655506459
3400 done. -84.69646387571969
3600 done. -85.3512920545134
Negative Log-likehood -85.953044
log-likelihood:    -85.953
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-048-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-048-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.04, 43.3/13.7/6.2/3.5 (BP=0.942, ratio=0.944, hyp_len=72848, ref_len=77177)
--- bleu: BLEU = 10.04, 43.3/13.7/6.2/3.5 (BP=0.942, ratio=0.944, hyp_len=72848, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    49 rec:   39.938 mi: 2.49767494 zkl:  177.615 cd:   -9.226 pos_prob:   50.669 prob_neg:   59.895 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    49 rec:   44.670 mi: 2.73007894 zkl:  186.582 cd:  -10.658 pos_prob:   54.047 prob_neg:   64.705 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    49 rec:   51.680 mi: 2.42371607 zkl:  183.495 cd:  -24.350 pos_prob:   44.710 prob_neg:   69.061 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    49 rec:   34.469 mi: 2.42760634 zkl:  184.266 cd:  -15.362 pos_prob:   49.070 prob_neg:   64.432 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    49 rec:   40.645 mi: 2.64369106 zkl:  186.125 cd:  -18.210 pos_prob:   44.058 prob_neg:   62.268 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-441.223
Langevin prior   6/ 40: energy=-1227.953
Langevin prior  11/ 40: energy=-1632.922
Langevin prior  16/ 40: energy=-1793.033
Langevin prior  21/ 40: energy=-1907.328
Langevin prior  26/ 40: energy=-1995.613
Langevin prior  31/ 40: energy=-1981.534
Langevin prior  36/ 40: energy=-1955.800
Langevin prior  40/ 40: energy=-2003.141
batch/max_batch/ep:   600/  1402/    49 rec:   36.673 mi: 2.58358192 zkl:  188.292 cd:  -18.053 pos_prob:   45.769 prob_neg:   63.823 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    49 rec:   32.772 mi: 2.25715780 zkl:  186.296 cd:  -22.802 pos_prob:   39.923 prob_neg:   62.725 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    49 rec:   39.754 mi: 2.58318090 zkl:  190.513 cd:  -21.876 pos_prob:   41.542 prob_neg:   63.418 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    49 rec:   44.029 mi: 2.45452833 zkl:  190.518 cd:  -31.341 pos_prob:   34.650 prob_neg:   65.991 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    49 rec:   35.236 mi: 2.55633593 zkl:  187.410 cd:  -30.469 pos_prob:   36.629 prob_neg:   67.098 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-338.525
Langevin prior   6/ 40: energy=-1144.146
Langevin prior  11/ 40: energy=-1546.870
Langevin prior  16/ 40: energy=-1728.054
Langevin prior  21/ 40: energy=-1856.730
Langevin prior  26/ 40: energy=-1987.007
Langevin prior  31/ 40: energy=-2028.101
Langevin prior  36/ 40: energy=-2054.786
Langevin prior  40/ 40: energy=-2070.964
batch/max_batch/ep:  1100/  1402/    49 rec:   47.570 mi: 2.55909681 zkl:  190.172 cd:  -32.257 pos_prob:   34.343 prob_neg:   66.600 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    49 rec:   44.772 mi: 2.46545148 zkl:  190.964 cd:  -30.135 pos_prob:   33.647 prob_neg:   63.782 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    49 rec:   47.836 mi: 2.52457428 zkl:  189.405 cd:  -36.303 pos_prob:   32.263 prob_neg:   68.566 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    49 rec:   34.521 mi: 2.55339336 zkl:  191.967 cd:  -27.818 pos_prob:   37.895 prob_neg:   65.714 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-049-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.77, 43.5/13.8/6.5/3.8 (BP=0.980, ratio=0.981, hyp_len=75682, ref_len=77177)
--- bleu: BLEU = 10.77, 43.5/13.8/6.5/3.8 (BP=0.980, ratio=0.981, hyp_len=75682, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    50 rec:   45.268 mi: 2.42862940 zkl:  193.854 cd:  -29.409 pos_prob:   35.529 prob_neg:   64.938 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    50 rec:   40.476 mi: 2.51657867 zkl:  191.931 cd:  -33.866 pos_prob:   31.963 prob_neg:   65.829 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    50 rec:   30.799 mi: 2.39817762 zkl:  195.944 cd:  -28.251 pos_prob:   34.164 prob_neg:   62.415 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    50 rec:   30.669 mi: 2.69998074 zkl:  191.822 cd:  -29.660 pos_prob:   31.764 prob_neg:   61.424 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    50 rec:   35.634 mi: 2.55494475 zkl:  192.551 cd:  -34.579 pos_prob:   30.938 prob_neg:   65.516 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-321.662
Langevin prior   6/ 40: energy=-1123.356
Langevin prior  11/ 40: energy=-1561.324
Langevin prior  16/ 40: energy=-1661.462
Langevin prior  21/ 40: energy=-1790.235
Langevin prior  26/ 40: energy=-1909.791
Langevin prior  31/ 40: energy=-1840.968
Langevin prior  36/ 40: energy=-1825.227
Langevin prior  40/ 40: energy=-1824.755
batch/max_batch/ep:   600/  1402/    50 rec:   40.077 mi: 2.38964105 zkl:  196.092 cd:  -27.902 pos_prob:   37.688 prob_neg:   65.589 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    50 rec:   40.758 mi: 2.47251725 zkl:  195.266 cd:  -37.395 pos_prob:   30.737 prob_neg:   68.132 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    50 rec:   36.371 mi: 2.42336655 zkl:  194.928 cd:  -32.455 pos_prob:   30.321 prob_neg:   62.776 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    50 rec:   37.624 mi: 2.43110132 zkl:  195.938 cd:  -26.697 pos_prob:   35.652 prob_neg:   62.349 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    50 rec:   32.086 mi: 2.46074414 zkl:  197.438 cd:  -31.834 pos_prob:   35.023 prob_neg:   66.857 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-314.109
Langevin prior   6/ 40: energy=-1166.267
Langevin prior  11/ 40: energy=-1593.039
Langevin prior  16/ 40: energy=-1798.496
Langevin prior  21/ 40: energy=-1869.638
Langevin prior  26/ 40: energy=-2035.354
Langevin prior  31/ 40: energy=-2149.992
Langevin prior  36/ 40: energy=-2141.706
Langevin prior  40/ 40: energy=-2058.161
batch/max_batch/ep:  1100/  1402/    50 rec:   37.431 mi: 2.53428006 zkl:  198.336 cd:  -32.226 pos_prob:   30.154 prob_neg:   62.381 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    50 rec:   35.980 mi: 2.40459347 zkl:  196.608 cd:  -37.868 pos_prob:   27.768 prob_neg:   65.636 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    50 rec:   42.660 mi: 2.49047494 zkl:  201.460 cd:  -30.029 pos_prob:   33.581 prob_neg:   63.611 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    50 rec:   43.255 mi: 2.39456129 zkl:  200.654 cd:  -32.724 pos_prob:   30.138 prob_neg:   62.862 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-050-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.22, 44.2/14.4/6.9/4.1 (BP=0.971, ratio=0.971, hyp_len=74946, ref_len=77177)
--- bleu: BLEU = 11.22, 44.2/14.4/6.9/4.1 (BP=0.971, ratio=0.971, hyp_len=74946, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    51 rec:   30.460 mi: 2.60836148 zkl:  199.222 cd:  -38.304 pos_prob:   29.680 prob_neg:   67.983 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    51 rec:   38.958 mi: 2.53316569 zkl:  199.656 cd:  -37.619 pos_prob:   29.038 prob_neg:   66.657 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    51 rec:   34.111 mi: 2.60475922 zkl:  198.862 cd:  -41.633 pos_prob:   27.542 prob_neg:   69.175 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    51 rec:   48.221 mi: 2.37948394 zkl:  201.850 cd:  -41.803 pos_prob:   27.068 prob_neg:   68.872 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    51 rec:   33.668 mi: 2.39347363 zkl:  200.297 cd:  -35.452 pos_prob:   31.310 prob_neg:   66.762 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-346.167
Langevin prior   6/ 40: energy=-1137.960
Langevin prior  11/ 40: energy=-1565.420
Langevin prior  16/ 40: energy=-1734.530
Langevin prior  21/ 40: energy=-1803.659
Langevin prior  26/ 40: energy=-1869.323
Langevin prior  31/ 40: energy=-1863.693
Langevin prior  36/ 40: energy=-1881.073
Langevin prior  40/ 40: energy=-1894.948
batch/max_batch/ep:   600/  1402/    51 rec:   44.208 mi: 2.58117294 zkl:  203.523 cd:  -37.513 pos_prob:   30.536 prob_neg:   68.049 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    51 rec:   33.508 mi: 2.46314692 zkl:  201.708 cd:  -41.086 pos_prob:   26.872 prob_neg:   67.957 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    51 rec:   29.936 mi: 2.52605963 zkl:  199.891 cd:  -33.833 pos_prob:   27.812 prob_neg:   61.645 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    51 rec:   42.720 mi: 2.66522217 zkl:  205.052 cd:  -35.177 pos_prob:   29.388 prob_neg:   64.565 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    51 rec:   33.308 mi: 2.48616195 zkl:  205.681 cd:  -40.274 pos_prob:   28.145 prob_neg:   68.420 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-441.726
Langevin prior   6/ 40: energy=-1145.399
Langevin prior  11/ 40: energy=-1580.550
Langevin prior  16/ 40: energy=-1746.106
Langevin prior  21/ 40: energy=-1837.522
Langevin prior  26/ 40: energy=-1834.748
Langevin prior  31/ 40: energy=-1831.978
Langevin prior  36/ 40: energy=-1883.000
Langevin prior  40/ 40: energy=-1922.180
batch/max_batch/ep:  1100/  1402/    51 rec:   42.457 mi: 2.34865451 zkl:  206.850 cd:  -38.940 pos_prob:   27.657 prob_neg:   66.597 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    51 rec:   40.430 mi: 2.45918941 zkl:  205.092 cd:  -36.244 pos_prob:   26.506 prob_neg:   62.750 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    51 rec:   40.593 mi: 2.31341410 zkl:  206.579 cd:  -34.744 pos_prob:   25.949 prob_neg:   60.693 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    51 rec:   46.662 mi: 2.34775972 zkl:  206.747 cd:  -40.506 pos_prob:   25.153 prob_neg:   65.659 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-051-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.41, 44.2/14.5/7.1/4.3 (BP=0.968, ratio=0.969, hyp_len=74759, ref_len=77177)
--- bleu: BLEU = 11.41, 44.2/14.5/7.1/4.3 (BP=0.968, ratio=0.969, hyp_len=74759, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    52 rec:   47.983 mi: 2.48902893 zkl:  182.814 cd:  -36.001 pos_prob:   39.007 prob_neg:   75.008 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    52 rec:   49.353 mi: 2.64412236 zkl:  105.946 cd:  -38.016 pos_prob:   42.340 prob_neg:   80.355 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    52 rec:   42.674 mi: 2.24778938 zkl:  112.911 cd:  -28.694 pos_prob:   47.839 prob_neg:   76.533 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    52 rec:   52.136 mi: 2.30585957 zkl:  105.406 cd:  -28.595 pos_prob:   45.952 prob_neg:   74.547 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    52 rec:   37.158 mi: 2.49507356 zkl:  103.111 cd:  -18.112 pos_prob:   55.507 prob_neg:   73.619 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-382.375
Langevin prior   6/ 40: energy=-1286.230
Langevin prior  11/ 40: energy=-1722.859
Langevin prior  16/ 40: energy=-1886.697
Langevin prior  21/ 40: energy=-2030.818
Langevin prior  26/ 40: energy=-2108.288
Langevin prior  31/ 40: energy=-2093.839
Langevin prior  36/ 40: energy=-2083.463
Langevin prior  40/ 40: energy=-2098.555
batch/max_batch/ep:   600/  1402/    52 rec:   50.645 mi: 2.46709633 zkl:  105.459 cd:  -17.953 pos_prob:   57.220 prob_neg:   75.173 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    52 rec:   39.612 mi: 2.74255896 zkl:   98.534 cd:  -14.466 pos_prob:   60.727 prob_neg:   75.193 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    52 rec:   42.328 mi: 2.46111250 zkl:   98.422 cd:  -14.195 pos_prob:   57.354 prob_neg:   71.549 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    52 rec:   49.323 mi: 2.41183329 zkl:   96.666 cd:  -10.890 pos_prob:   57.104 prob_neg:   67.994 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    52 rec:   42.494 mi: 2.34809566 zkl:   80.505 cd:  -20.873 pos_prob:   52.869 prob_neg:   73.742 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-382.804
Langevin prior   6/ 40: energy=-1255.109
Langevin prior  11/ 40: energy=-1687.920
Langevin prior  16/ 40: energy=-1898.054
Langevin prior  21/ 40: energy=-1993.636
Langevin prior  26/ 40: energy=-1960.081
Langevin prior  31/ 40: energy=-2087.521
Langevin prior  36/ 40: energy=-2093.234
Langevin prior  40/ 40: energy=-2123.256
batch/max_batch/ep:  1100/  1402/    52 rec:   41.514 mi: 2.61629152 zkl:   87.920 cd:  -12.239 pos_prob:   57.758 prob_neg:   69.997 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    52 rec:   49.877 mi: 2.53189993 zkl:   87.387 cd:   -2.711 pos_prob:   62.299 prob_neg:   65.010 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    52 rec:   62.553 mi: 2.25782442 zkl:   85.885 cd:   -9.243 pos_prob:   58.103 prob_neg:   67.345 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    52 rec:   42.380 mi: 2.58167982 zkl:   82.665 cd:   -8.318 pos_prob:   58.337 prob_neg:   66.656 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-052-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.51, 44.2/14.2/6.7/3.8 (BP=0.931, ratio=0.933, hyp_len=72042, ref_len=77177)
--- bleu: BLEU = 10.51, 44.2/14.2/6.7/3.8 (BP=0.931, ratio=0.933, hyp_len=72042, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    53 rec:   41.165 mi: 2.52605033 zkl:   74.224 cd:  -14.439 pos_prob:   52.454 prob_neg:   66.894 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    53 rec:   51.022 mi: 2.63715243 zkl:   83.331 cd:   -1.536 pos_prob:   58.996 prob_neg:   60.532 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    53 rec:   51.003 mi: 2.43495846 zkl:   84.001 cd:   -4.177 pos_prob:   56.509 prob_neg:   60.686 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    53 rec:   40.524 mi: 2.53133106 zkl:   79.125 cd:   -4.845 pos_prob:   58.439 prob_neg:   63.284 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    53 rec:   46.997 mi: 2.61123967 zkl:   74.560 cd:   -7.328 pos_prob:   54.393 prob_neg:   61.721 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-380.405
Langevin prior   6/ 40: energy=-1181.130
Langevin prior  11/ 40: energy=-1496.528
Langevin prior  16/ 40: energy=-1661.585
Langevin prior  21/ 40: energy=-1748.400
Langevin prior  26/ 40: energy=-1774.298
Langevin prior  31/ 40: energy=-1812.981
Langevin prior  36/ 40: energy=-1865.859
Langevin prior  40/ 40: energy=-1867.162
batch/max_batch/ep:   600/  1402/    53 rec:   51.626 mi: 2.64396453 zkl:   73.597 cd:   -2.269 pos_prob:   58.485 prob_neg:   60.753 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    53 rec:   46.857 mi: 2.57388449 zkl:   69.207 cd:   -7.762 pos_prob:   56.290 prob_neg:   64.053 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    53 rec:   59.548 mi: 2.43526626 zkl:   73.331 cd:   -2.250 pos_prob:   57.272 prob_neg:   59.522 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    53 rec:   60.616 mi: 2.65213156 zkl:   73.579 cd:   -6.773 pos_prob:   58.461 prob_neg:   65.234 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    53 rec:   49.566 mi: 2.58320189 zkl:   67.893 cd:   -7.999 pos_prob:   52.551 prob_neg:   60.550 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-359.185
Langevin prior   6/ 40: energy=-1047.563
Langevin prior  11/ 40: energy=-1411.267
Langevin prior  16/ 40: energy=-1558.091
Langevin prior  21/ 40: energy=-1683.903
Langevin prior  26/ 40: energy=-1729.978
Langevin prior  31/ 40: energy=-1755.449
Langevin prior  36/ 40: energy=-1742.925
Langevin prior  40/ 40: energy=-1690.210
batch/max_batch/ep:  1100/  1402/    53 rec:   59.682 mi: 2.50770044 zkl:   74.755 cd:   -4.893 pos_prob:   58.499 prob_neg:   63.393 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    53 rec:   45.984 mi: 2.67051363 zkl:   71.379 cd:   -5.272 pos_prob:   57.406 prob_neg:   62.678 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    53 rec:   56.621 mi: 2.64520383 zkl:   76.762 cd:    0.685 pos_prob:   61.230 prob_neg:   60.545 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    53 rec:   53.133 mi: 2.48342466 zkl:   68.848 cd:   -1.940 pos_prob:   56.061 prob_neg:   58.002 kl_weight:    0.500 do_ae_train: False
200 done. -78.75714108284185
400 done. -85.0347155617345
600 done. -85.96188406671878
800 done. -86.07514199282598
1000 done. -87.78644117085388
1200 done. -89.0391398873117
1400 done. -90.10044020186146
1600 done. -89.54933015722212
1800 done. -87.86462929411064
2000 done. -85.39766773182282
2200 done. -84.40358765655765
2400 done. -83.52292227278588
2600 done. -83.71910357908286
2800 done. -83.73904392092312
3000 done. -83.98043447217954
3200 done. -84.41114060429376
3400 done. -84.62809727584482
3600 done. -85.30898359976096
Negative Log-likehood -85.925381
log-likelihood:    -85.925
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-053-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-053-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.91, 43.0/13.4/6.0/3.4 (BP=0.954, ratio=0.955, hyp_len=73710, ref_len=77177)
--- bleu: BLEU = 9.91, 43.0/13.4/6.0/3.4 (BP=0.954, ratio=0.955, hyp_len=73710, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    54 rec:   47.939 mi: 2.68075657 zkl:   70.193 cd:   -5.373 pos_prob:   56.525 prob_neg:   61.898 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    54 rec:   49.896 mi: 2.19945979 zkl:   73.475 cd:   -2.602 pos_prob:   58.409 prob_neg:   61.012 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    54 rec:   48.976 mi: 2.65577412 zkl:   69.909 cd:    2.057 pos_prob:   60.241 prob_neg:   58.184 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    54 rec:   52.777 mi: 2.50527668 zkl:   68.148 cd:   -7.399 pos_prob:   52.017 prob_neg:   59.416 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    54 rec:   48.037 mi: 2.63205290 zkl:   67.656 cd:   -2.080 pos_prob:   54.723 prob_neg:   56.803 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-400.422
Langevin prior   6/ 40: energy=-1119.932
Langevin prior  11/ 40: energy=-1404.261
Langevin prior  16/ 40: energy=-1559.970
Langevin prior  21/ 40: energy=-1694.867
Langevin prior  26/ 40: energy=-1747.455
Langevin prior  31/ 40: energy=-1754.992
Langevin prior  36/ 40: energy=-1781.989
Langevin prior  40/ 40: energy=-1815.225
batch/max_batch/ep:   600/  1402/    54 rec:   64.785 mi: 2.73867035 zkl:   72.176 cd:   -1.633 pos_prob:   55.050 prob_neg:   56.683 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    54 rec:   44.474 mi: 2.48778868 zkl:   72.055 cd:    3.069 pos_prob:   58.703 prob_neg:   55.635 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    54 rec:   52.772 mi: 2.60737848 zkl:   73.149 cd:   -1.558 pos_prob:   56.849 prob_neg:   58.406 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    54 rec:   55.557 mi: 2.68546963 zkl:   70.652 cd:    2.258 pos_prob:   58.565 prob_neg:   56.307 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    54 rec:   60.360 mi: 2.50202632 zkl:   71.278 cd:   -2.672 pos_prob:   55.998 prob_neg:   58.670 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-371.645
Langevin prior   6/ 40: energy=-1065.528
Langevin prior  11/ 40: energy=-1480.625
Langevin prior  16/ 40: energy=-1557.374
Langevin prior  21/ 40: energy=-1656.625
Langevin prior  26/ 40: energy=-1660.405
Langevin prior  31/ 40: energy=-1716.131
Langevin prior  36/ 40: energy=-1743.379
Langevin prior  40/ 40: energy=-1723.031
batch/max_batch/ep:  1100/  1402/    54 rec:   62.445 mi: 2.49028921 zkl:   67.854 cd:   -8.229 pos_prob:   51.791 prob_neg:   60.020 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    54 rec:   62.997 mi: 2.70799375 zkl:   73.654 cd:   -0.094 pos_prob:   58.306 prob_neg:   58.400 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    54 rec:   58.323 mi: 2.59750319 zkl:   68.913 cd:   -1.162 pos_prob:   56.850 prob_neg:   58.013 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    54 rec:   48.603 mi: 2.49126720 zkl:   58.951 cd:  -10.812 pos_prob:   50.016 prob_neg:   60.827 kl_weight:    0.500 do_ae_train: False
200 done. -78.43882198448208
400 done. -84.74529973384371
600 done. -85.51171265521398
800 done. -85.57023867574806
1000 done. -87.35108812244353
1200 done. -88.63440027587644
1400 done. -89.70669271867243
1600 done. -89.26665875651597
1800 done. -87.60979988168076
2000 done. -85.06999771918835
2200 done. -84.05201553978821
2400 done. -83.20470843384098
2600 done. -83.4170084429395
2800 done. -83.41783180574163
3000 done. -83.67177030729282
3200 done. -84.0888618806097
3400 done. -84.27691877156307
3600 done. -84.98053500783091
Negative Log-likehood -85.607860
log-likelihood:    -85.608
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-054-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-054-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.89, 41.7/13.1/5.9/3.3 (BP=0.972, ratio=0.972, hyp_len=75042, ref_len=77177)
--- bleu: BLEU = 9.89, 41.7/13.1/5.9/3.3 (BP=0.972, ratio=0.972, hyp_len=75042, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    55 rec:   45.237 mi: 2.53545785 zkl:  177.336 cd:  -11.631 pos_prob:   48.724 prob_neg:   60.355 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    55 rec:   43.786 mi: 2.57757711 zkl:  181.330 cd:  -11.426 pos_prob:   47.804 prob_neg:   59.229 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    55 rec:   46.684 mi: 2.58598590 zkl:  181.264 cd:  -13.386 pos_prob:   43.821 prob_neg:   57.207 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    55 rec:   53.841 mi: 2.52094197 zkl:  183.335 cd:  -14.469 pos_prob:   42.166 prob_neg:   56.635 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    55 rec:   42.849 mi: 2.53674841 zkl:  178.492 cd:  -23.936 pos_prob:   35.294 prob_neg:   59.230 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-357.110
Langevin prior   6/ 40: energy=-1095.575
Langevin prior  11/ 40: energy=-1431.107
Langevin prior  16/ 40: energy=-1557.336
Langevin prior  21/ 40: energy=-1651.020
Langevin prior  26/ 40: energy=-1632.312
Langevin prior  31/ 40: energy=-1712.206
Langevin prior  36/ 40: energy=-1750.023
Langevin prior  40/ 40: energy=-1762.220
batch/max_batch/ep:   600/  1402/    55 rec:   51.358 mi: 2.45664549 zkl:  181.627 cd:  -19.836 pos_prob:   35.863 prob_neg:   55.699 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    55 rec:   49.547 mi: 2.49673176 zkl:  183.367 cd:  -22.871 pos_prob:   36.784 prob_neg:   59.655 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    55 rec:   39.837 mi: 2.56257105 zkl:  181.748 cd:  -24.931 pos_prob:   34.239 prob_neg:   59.170 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    55 rec:   38.639 mi: 2.37753534 zkl:  181.873 cd:  -23.841 pos_prob:   34.285 prob_neg:   58.126 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    55 rec:   46.562 mi: 2.60828662 zkl:  185.174 cd:  -27.222 pos_prob:   32.841 prob_neg:   60.062 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-356.178
Langevin prior   6/ 40: energy=-1044.391
Langevin prior  11/ 40: energy=-1348.048
Langevin prior  16/ 40: energy=-1553.187
Langevin prior  21/ 40: energy=-1752.376
Langevin prior  26/ 40: energy=-1715.694
Langevin prior  31/ 40: energy=-1713.897
Langevin prior  36/ 40: energy=-1684.187
Langevin prior  40/ 40: energy=-1665.572
batch/max_batch/ep:  1100/  1402/    55 rec:   45.652 mi: 2.57507443 zkl:  185.594 cd:  -22.927 pos_prob:   32.441 prob_neg:   55.368 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    55 rec:   58.153 mi: 2.37226176 zkl:  190.415 cd:  -23.410 pos_prob:   33.839 prob_neg:   57.249 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    55 rec:   40.636 mi: 2.37838960 zkl:  186.832 cd:  -28.233 pos_prob:   31.748 prob_neg:   59.981 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    55 rec:   48.680 mi: 2.52074409 zkl:  191.470 cd:  -26.103 pos_prob:   31.027 prob_neg:   57.130 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-055-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.80, 43.6/13.9/6.6/3.9 (BP=0.969, ratio=0.969, hyp_len=74787, ref_len=77177)
--- bleu: BLEU = 10.80, 43.6/13.9/6.6/3.9 (BP=0.969, ratio=0.969, hyp_len=74787, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    56 rec:   33.786 mi: 2.55410290 zkl:  189.107 cd:  -23.634 pos_prob:   31.333 prob_neg:   54.967 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    56 rec:   31.657 mi: 2.57388854 zkl:  190.730 cd:  -26.830 pos_prob:   31.136 prob_neg:   57.965 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    56 rec:   30.805 mi: 2.50540519 zkl:  189.450 cd:  -32.017 pos_prob:   28.965 prob_neg:   60.982 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    56 rec:   44.817 mi: 2.60740924 zkl:  193.766 cd:  -25.392 pos_prob:   29.851 prob_neg:   55.243 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    56 rec:   34.030 mi: 2.49704242 zkl:  192.649 cd:  -30.163 pos_prob:   31.037 prob_neg:   61.200 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-390.333
Langevin prior   6/ 40: energy=-1080.173
Langevin prior  11/ 40: energy=-1444.823
Langevin prior  16/ 40: energy=-1601.501
Langevin prior  21/ 40: energy=-1713.338
Langevin prior  26/ 40: energy=-1711.634
Langevin prior  31/ 40: energy=-1777.397
Langevin prior  36/ 40: energy=-1827.013
Langevin prior  40/ 40: energy=-1868.172
batch/max_batch/ep:   600/  1402/    56 rec:   35.973 mi: 2.57666159 zkl:  194.281 cd:  -30.863 pos_prob:   28.780 prob_neg:   59.643 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    56 rec:   43.877 mi: 2.29317260 zkl:  196.433 cd:  -31.552 pos_prob:   25.289 prob_neg:   56.841 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    56 rec:   37.776 mi: 2.46226597 zkl:  197.207 cd:  -27.382 pos_prob:   30.111 prob_neg:   57.492 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    56 rec:   44.305 mi: 2.47568059 zkl:  195.569 cd:  -31.655 pos_prob:   25.228 prob_neg:   56.883 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    56 rec:   29.484 mi: 2.52567244 zkl:  193.845 cd:  -29.079 pos_prob:   27.063 prob_neg:   56.141 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-354.945
Langevin prior   6/ 40: energy=-1048.893
Langevin prior  11/ 40: energy=-1396.403
Langevin prior  16/ 40: energy=-1532.644
Langevin prior  21/ 40: energy=-1642.718
Langevin prior  26/ 40: energy=-1679.632
Langevin prior  31/ 40: energy=-1737.848
Langevin prior  36/ 40: energy=-1766.251
Langevin prior  40/ 40: energy=-1759.688
batch/max_batch/ep:  1100/  1402/    56 rec:   36.928 mi: 2.33240533 zkl:  196.642 cd:  -24.253 pos_prob:   30.741 prob_neg:   54.994 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    56 rec:   47.537 mi: 2.47683382 zkl:  200.972 cd:  -32.672 pos_prob:   29.233 prob_neg:   61.905 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    56 rec:   31.764 mi: 2.48291802 zkl:  199.552 cd:  -30.094 pos_prob:   30.769 prob_neg:   60.863 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    56 rec:   46.790 mi: 2.56287599 zkl:  199.752 cd:  -33.366 pos_prob:   24.788 prob_neg:   58.155 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-056-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.13, 43.8/14.1/6.8/4.0 (BP=0.976, ratio=0.976, hyp_len=75310, ref_len=77177)
--- bleu: BLEU = 11.13, 43.8/14.1/6.8/4.0 (BP=0.976, ratio=0.976, hyp_len=75310, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    57 rec:   41.510 mi: 2.42354465 zkl:  201.428 cd:  -30.305 pos_prob:   27.088 prob_neg:   57.393 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   200/  1402/    57 rec:   39.820 mi: 2.57769465 zkl:  198.940 cd:  -34.341 pos_prob:   25.683 prob_neg:   60.024 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   300/  1402/    57 rec:   34.983 mi: 2.36564255 zkl:  200.991 cd:  -33.792 pos_prob:   25.813 prob_neg:   59.604 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   400/  1402/    57 rec:   28.875 mi: 2.47680926 zkl:  203.509 cd:  -31.511 pos_prob:   30.982 prob_neg:   62.493 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   500/  1402/    57 rec:   38.410 mi: 2.55169797 zkl:  206.451 cd:  -30.622 pos_prob:   28.157 prob_neg:   58.780 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-383.186
Langevin prior   6/ 40: energy=-1135.031
Langevin prior  11/ 40: energy=-1481.556
Langevin prior  16/ 40: energy=-1651.503
Langevin prior  21/ 40: energy=-1732.773
Langevin prior  26/ 40: energy=-1820.745
Langevin prior  31/ 40: energy=-1789.353
Langevin prior  36/ 40: energy=-1760.689
Langevin prior  40/ 40: energy=-1742.625
batch/max_batch/ep:   600/  1402/    57 rec:   39.425 mi: 2.19146752 zkl:  201.902 cd:  -32.605 pos_prob:   25.830 prob_neg:   58.436 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   700/  1402/    57 rec:   36.482 mi: 2.29901075 zkl:  201.777 cd:  -32.762 pos_prob:   25.035 prob_neg:   57.797 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   800/  1402/    57 rec:   32.120 mi: 2.45737004 zkl:  203.120 cd:  -28.049 pos_prob:   27.822 prob_neg:   55.871 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:   900/  1402/    57 rec:   35.293 mi: 2.53954935 zkl:  204.464 cd:  -30.503 pos_prob:   23.667 prob_neg:   54.171 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1000/  1402/    57 rec:   41.672 mi: 2.36911869 zkl:  207.209 cd:  -33.356 pos_prob:   25.869 prob_neg:   59.225 kl_weight:    0.000 do_ae_train: True
Langevin prior   1/ 40: energy=-379.936
Langevin prior   6/ 40: energy=-1049.413
Langevin prior  11/ 40: energy=-1399.308
Langevin prior  16/ 40: energy=-1590.560
Langevin prior  21/ 40: energy=-1640.029
Langevin prior  26/ 40: energy=-1657.791
Langevin prior  31/ 40: energy=-1703.611
Langevin prior  36/ 40: energy=-1729.701
Langevin prior  40/ 40: energy=-1709.082
batch/max_batch/ep:  1100/  1402/    57 rec:   39.344 mi: 2.48373461 zkl:  206.464 cd:  -32.722 pos_prob:   25.644 prob_neg:   58.366 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1200/  1402/    57 rec:   36.957 mi: 2.44289994 zkl:  208.738 cd:  -32.786 pos_prob:   26.217 prob_neg:   59.002 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1300/  1402/    57 rec:   42.083 mi: 2.44539928 zkl:  208.541 cd:  -32.469 pos_prob:   22.814 prob_neg:   55.282 kl_weight:    0.000 do_ae_train: True
batch/max_batch/ep:  1400/  1402/    57 rec:   34.150 mi: 2.51630569 zkl:  206.721 cd:  -35.969 pos_prob:   23.548 prob_neg:   59.517 kl_weight:    0.000 do_ae_train: True
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-057-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 11.21, 45.2/14.8/7.1/4.2 (BP=0.940, ratio=0.942, hyp_len=72688, ref_len=77177)
--- bleu: BLEU = 11.21, 45.2/14.8/7.1/4.2 (BP=0.940, ratio=0.942, hyp_len=72688, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    58 rec:   38.344 mi: 2.38706183 zkl:  166.689 cd:  -33.576 pos_prob:   34.998 prob_neg:   68.574 kl_weight:    0.024 do_ae_train: False
batch/max_batch/ep:   200/  1402/    58 rec:   49.608 mi: 2.49369693 zkl:  117.199 cd:  -25.512 pos_prob:   39.463 prob_neg:   64.975 kl_weight:    0.047 do_ae_train: False
batch/max_batch/ep:   300/  1402/    58 rec:   37.973 mi: 2.57224870 zkl:  114.510 cd:  -27.914 pos_prob:   42.597 prob_neg:   70.511 kl_weight:    0.071 do_ae_train: False
batch/max_batch/ep:   400/  1402/    58 rec:   40.299 mi: 2.52809668 zkl:  107.849 cd:  -22.658 pos_prob:   43.583 prob_neg:   66.241 kl_weight:    0.095 do_ae_train: False
batch/max_batch/ep:   500/  1402/    58 rec:   45.136 mi: 2.57871246 zkl:  100.526 cd:  -14.808 pos_prob:   49.084 prob_neg:   63.892 kl_weight:    0.119 do_ae_train: False
Langevin prior   1/ 40: energy=-404.427
Langevin prior   6/ 40: energy=-1261.068
Langevin prior  11/ 40: energy=-1630.305
Langevin prior  16/ 40: energy=-1856.157
Langevin prior  21/ 40: energy=-1885.991
Langevin prior  26/ 40: energy=-1944.311
Langevin prior  31/ 40: energy=-1906.301
Langevin prior  36/ 40: energy=-1943.863
Langevin prior  40/ 40: energy=-1941.001
batch/max_batch/ep:   600/  1402/    58 rec:   49.112 mi: 2.59679842 zkl:  102.036 cd:  -15.575 pos_prob:   47.471 prob_neg:   63.045 kl_weight:    0.142 do_ae_train: False
batch/max_batch/ep:   700/  1402/    58 rec:   50.976 mi: 2.56207728 zkl:   91.274 cd:  -11.010 pos_prob:   50.758 prob_neg:   61.768 kl_weight:    0.166 do_ae_train: False
batch/max_batch/ep:   800/  1402/    58 rec:   47.738 mi: 2.68688965 zkl:   92.575 cd:  -15.356 pos_prob:   47.533 prob_neg:   62.889 kl_weight:    0.190 do_ae_train: False
batch/max_batch/ep:   900/  1402/    58 rec:   49.127 mi: 2.60485649 zkl:   87.316 cd:  -10.719 pos_prob:   51.417 prob_neg:   62.136 kl_weight:    0.214 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    58 rec:   49.365 mi: 2.29689622 zkl:   91.665 cd:   -7.000 pos_prob:   52.696 prob_neg:   59.696 kl_weight:    0.238 do_ae_train: False
Langevin prior   1/ 40: energy=-398.316
Langevin prior   6/ 40: energy=-1116.506
Langevin prior  11/ 40: energy=-1508.434
Langevin prior  16/ 40: energy=-1704.433
Langevin prior  21/ 40: energy=-1795.302
Langevin prior  26/ 40: energy=-1788.578
Langevin prior  31/ 40: energy=-1800.389
Langevin prior  36/ 40: energy=-1839.816
Langevin prior  40/ 40: energy=-1881.570
batch/max_batch/ep:  1100/  1402/    58 rec:   38.420 mi: 2.50117087 zkl:   92.272 cd:   -1.135 pos_prob:   59.596 prob_neg:   60.731 kl_weight:    0.261 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    58 rec:   45.482 mi: 2.48323298 zkl:   90.930 cd:   -7.830 pos_prob:   53.851 prob_neg:   61.680 kl_weight:    0.285 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    58 rec:   46.914 mi: 2.60598350 zkl:   85.366 cd:   -0.728 pos_prob:   54.876 prob_neg:   55.603 kl_weight:    0.309 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    58 rec:   36.009 mi: 2.58224678 zkl:   77.465 cd:   -4.735 pos_prob:   55.147 prob_neg:   59.882 kl_weight:    0.333 do_ae_train: False
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-058-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.91, 42.7/13.1/5.9/3.4 (BP=0.965, ratio=0.965, hyp_len=74511, ref_len=77177)
--- bleu: BLEU = 9.91, 42.7/13.1/5.9/3.4 (BP=0.965, ratio=0.965, hyp_len=74511, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    59 rec:   35.853 mi: 2.63012052 zkl:   76.225 cd:   -6.925 pos_prob:   52.143 prob_neg:   59.067 kl_weight:    0.357 do_ae_train: False
batch/max_batch/ep:   200/  1402/    59 rec:   36.892 mi: 2.56833100 zkl:   77.447 cd:   -0.562 pos_prob:   56.815 prob_neg:   57.376 kl_weight:    0.381 do_ae_train: False
batch/max_batch/ep:   300/  1402/    59 rec:   44.614 mi: 2.54436183 zkl:   77.913 cd:   -3.571 pos_prob:   53.928 prob_neg:   57.499 kl_weight:    0.404 do_ae_train: False
batch/max_batch/ep:   400/  1402/    59 rec:   47.013 mi: 2.24665332 zkl:   83.546 cd:    2.139 pos_prob:   61.175 prob_neg:   59.035 kl_weight:    0.428 do_ae_train: False
batch/max_batch/ep:   500/  1402/    59 rec:   55.452 mi: 2.41472936 zkl:   76.809 cd:   -3.975 pos_prob:   54.969 prob_neg:   58.944 kl_weight:    0.452 do_ae_train: False
Langevin prior   1/ 40: energy=-377.010
Langevin prior   6/ 40: energy=-1185.853
Langevin prior  11/ 40: energy=-1497.271
Langevin prior  16/ 40: energy=-1635.047
Langevin prior  21/ 40: energy=-1749.948
Langevin prior  26/ 40: energy=-1759.561
Langevin prior  31/ 40: energy=-1814.758
Langevin prior  36/ 40: energy=-1822.220
Langevin prior  40/ 40: energy=-1871.608
batch/max_batch/ep:   600/  1402/    59 rec:   47.007 mi: 2.54095578 zkl:   66.123 cd:  -10.332 pos_prob:   47.959 prob_neg:   58.291 kl_weight:    0.476 do_ae_train: False
batch/max_batch/ep:   700/  1402/    59 rec:   50.302 mi: 2.32494736 zkl:   67.666 cd:   -9.220 pos_prob:   47.087 prob_neg:   56.308 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    59 rec:   43.796 mi: 2.47639894 zkl:   73.464 cd:   -2.826 pos_prob:   56.550 prob_neg:   59.376 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    59 rec:   57.672 mi: 2.40304589 zkl:   70.251 cd:   -1.978 pos_prob:   53.284 prob_neg:   55.262 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    59 rec:   51.593 mi: 2.47526932 zkl:   71.868 cd:   -4.404 pos_prob:   54.695 prob_neg:   59.099 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-391.934
Langevin prior   6/ 40: energy=-1140.756
Langevin prior  11/ 40: energy=-1429.635
Langevin prior  16/ 40: energy=-1584.214
Langevin prior  21/ 40: energy=-1660.350
Langevin prior  26/ 40: energy=-1794.395
Langevin prior  31/ 40: energy=-1758.801
Langevin prior  36/ 40: energy=-1720.864
Langevin prior  40/ 40: energy=-1706.626
batch/max_batch/ep:  1100/  1402/    59 rec:   49.708 mi: 2.59919763 zkl:   74.733 cd:    3.786 pos_prob:   58.775 prob_neg:   54.990 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    59 rec:   55.673 mi: 2.74119258 zkl:   70.770 cd:   -4.299 pos_prob:   53.319 prob_neg:   57.618 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    59 rec:   56.317 mi: 2.57523751 zkl:   68.398 cd:   -4.119 pos_prob:   50.613 prob_neg:   54.732 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    59 rec:   48.120 mi: 2.61605406 zkl:   62.972 cd:   -7.946 pos_prob:   47.703 prob_neg:   55.649 kl_weight:    0.500 do_ae_train: False
200 done. -76.94367489906247
400 done. -83.38403827355718
600 done. -84.40776779977976
800 done. -84.53131388144928
1000 done. -86.2579960441643
1200 done. -87.5534091573735
1400 done. -88.7416622511183
1600 done. -88.2295434000223
1800 done. -86.54221333408398
2000 done. -84.05011593768297
2200 done. -83.11372275620656
2400 done. -82.2586297288404
2600 done. -82.43466341665979
2800 done. -82.45608144381993
3000 done. -82.7248316536339
3200 done. -83.14605838551304
3400 done. -83.3799492818989
3600 done. -84.0046237035156
Negative Log-likehood -84.612601
log-likelihood:    -84.613
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-059-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-059-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 9.94, 43.7/13.8/6.4/3.6 (BP=0.917, ratio=0.920, hyp_len=70998, ref_len=77177)
--- bleu: BLEU = 9.94, 43.7/13.8/6.4/3.6 (BP=0.917, ratio=0.920, hyp_len=70998, ref_len=77177)

Number of left over sample 8
Train begins with 1402 batches
batch/max_batch/ep:   100/  1402/    60 rec:   57.872 mi: 2.60644102 zkl:   66.770 cd:   -2.680 pos_prob:   49.995 prob_neg:   52.676 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   200/  1402/    60 rec:   50.814 mi: 2.42227960 zkl:   67.690 cd:   -0.618 pos_prob:   49.927 prob_neg:   50.544 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   300/  1402/    60 rec:   48.815 mi: 2.58272672 zkl:   64.826 cd:   -9.743 pos_prob:   45.798 prob_neg:   55.542 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   400/  1402/    60 rec:   56.077 mi: 2.57605362 zkl:   71.252 cd:   -5.609 pos_prob:   49.764 prob_neg:   55.374 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   500/  1402/    60 rec:   48.260 mi: 2.26620245 zkl:   63.173 cd:   -8.785 pos_prob:   45.170 prob_neg:   53.955 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-368.749
Langevin prior   6/ 40: energy=-1004.677
Langevin prior  11/ 40: energy=-1344.643
Langevin prior  16/ 40: energy=-1486.110
Langevin prior  21/ 40: energy=-1557.029
Langevin prior  26/ 40: energy=-1641.361
Langevin prior  31/ 40: energy=-1670.385
Langevin prior  36/ 40: energy=-1647.218
Langevin prior  40/ 40: energy=-1592.625
batch/max_batch/ep:   600/  1402/    60 rec:   42.248 mi: 2.26066041 zkl:   69.844 cd:    2.382 pos_prob:   58.703 prob_neg:   56.321 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   700/  1402/    60 rec:   59.333 mi: 2.46181917 zkl:   66.500 cd:   -9.284 pos_prob:   49.059 prob_neg:   58.343 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   800/  1402/    60 rec:   39.423 mi: 2.59226632 zkl:   58.976 cd:   -5.539 pos_prob:   48.755 prob_neg:   54.295 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:   900/  1402/    60 rec:   47.976 mi: 2.35732079 zkl:   65.451 cd:   -9.368 pos_prob:   47.712 prob_neg:   57.080 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1000/  1402/    60 rec:   46.747 mi: 2.47354460 zkl:   68.629 cd:    1.287 pos_prob:   56.291 prob_neg:   55.004 kl_weight:    0.500 do_ae_train: False
Langevin prior   1/ 40: energy=-334.856
Langevin prior   6/ 40: energy=-1046.782
Langevin prior  11/ 40: energy=-1301.528
Langevin prior  16/ 40: energy=-1398.107
Langevin prior  21/ 40: energy=-1510.900
Langevin prior  26/ 40: energy=-1542.567
Langevin prior  31/ 40: energy=-1569.499
Langevin prior  36/ 40: energy=-1579.334
Langevin prior  40/ 40: energy=-1533.167
batch/max_batch/ep:  1100/  1402/    60 rec:   55.117 mi: 2.43551326 zkl:   70.681 cd:   -2.013 pos_prob:   52.251 prob_neg:   54.264 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1200/  1402/    60 rec:   53.172 mi: 2.41532421 zkl:   70.165 cd:    0.692 pos_prob:   54.856 prob_neg:   54.164 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1300/  1402/    60 rec:   55.339 mi: 2.71009517 zkl:   71.335 cd:   -4.826 pos_prob:   55.456 prob_neg:   60.282 kl_weight:    0.500 do_ae_train: False
batch/max_batch/ep:  1400/  1402/    60 rec:   53.132 mi: 2.59836984 zkl:   72.390 cd:   -0.186 pos_prob:   55.280 prob_neg:   55.467 kl_weight:    0.500 do_ae_train: False
200 done. -77.1336770244981
400 done. -83.57567939463775
600 done. -84.53372559783702
800 done. -84.76181816116566
1000 done. -86.5076516370192
1200 done. -87.86321787774608
1400 done. -89.0158388420178
1600 done. -88.57094864364457
1800 done. -86.93438182523
2000 done. -84.44384828060629
2200 done. -83.48570233849972
2400 done. -82.65118123169742
2600 done. -82.86800476675445
2800 done. -82.88789511923528
3000 done. -83.14891121414121
3200 done. -83.56471290464735
3400 done. -83.76965770920205
3600 done. -84.39022392533917
Negative Log-likehood -84.958606
log-likelihood:    -84.959
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/ep-060-sampling.txt
10/1534 epochs done.
20/1534 epochs done.
30/1534 epochs done.
40/1534 epochs done.
50/1534 epochs done.
60/1534 epochs done.
70/1534 epochs done.
80/1534 epochs done.
90/1534 epochs done.
100/1534 epochs done.
110/1534 epochs done.
120/1534 epochs done.
130/1534 epochs done.
140/1534 epochs done.
150/1534 epochs done.
160/1534 epochs done.
170/1534 epochs done.
180/1534 epochs done.
190/1534 epochs done.
200/1534 epochs done.
210/1534 epochs done.
220/1534 epochs done.
230/1534 epochs done.
240/1534 epochs done.
250/1534 epochs done.
260/1534 epochs done.
270/1534 epochs done.
280/1534 epochs done.
290/1534 epochs done.
300/1534 epochs done.
310/1534 epochs done.
320/1534 epochs done.
330/1534 epochs done.
340/1534 epochs done.
350/1534 epochs done.
360/1534 epochs done.
370/1534 epochs done.
380/1534 epochs done.
390/1534 epochs done.
400/1534 epochs done.
410/1534 epochs done.
420/1534 epochs done.
430/1534 epochs done.
440/1534 epochs done.
450/1534 epochs done.
460/1534 epochs done.
Generation Done
Saving test to logs/ptb/dgmvae/2022-05-11T20-43-13-text_generation.py/epoch-060-test-greedy.txt
Generation: 125 batches
Generate report for default for 3750 samples
Generation Done
Generate report for default for 3750 samples
Runing multi-bleu.perl
multi-bleu.perl return code:  0
BLEU = 10.08, 42.8/13.6/6.2/3.5 (BP=0.949, ratio=0.950, hyp_len=73324, ref_len=77177)
--- bleu: BLEU = 10.08, 42.8/13.6/6.2/3.5 (BP=0.949, ratio=0.950, hyp_len=73324, ref_len=77177)

/home/xiaodi/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.3 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
m_layers))
